<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Go Forward • Posts by &#34;溯源取证总结&#34; tag</title>
        <link>http://chungod.github.io</link>
        <description>欢迎来到我的博客(*^﹏^*),本人为新人,你可以阅读我的学习笔记并提出独到的见解~我们将互相学习,共同进步,望大佬们勿喷</description>
        <language>zh-CN</language>
        <pubDate>Wed, 05 May 2021 15:17:48 +0800</pubDate>
        <lastBuildDate>Wed, 05 May 2021 15:17:48 +0800</lastBuildDate>
        <category>Linux反弹shell多种姿态</category>
        <category>Linux提权</category>
        <category>Windows内核提权</category>
        <category>php危险函数</category>
        <category>paramiko模块介绍</category>
        <category>内存取证</category>
        <category>meterpreter学习笔记</category>
        <category>溯源取证总结</category>
        <category>upload-labs通关记录</category>
        <item>
            <guid isPermalink="true">http://chungod.github.io/2021/05/05/%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</guid>
            <title>溯源取证总结</title>
            <link>http://chungod.github.io/2021/05/05/%E6%BA%AF%E6%BA%90%E5%8F%96%E8%AF%81%E6%80%BB%E7%BB%93/</link>
            <category>溯源取证总结</category>
            <pubDate>Wed, 05 May 2021 15:17:48 +0800</pubDate>
            <description><![CDATA[ &lt;h2 id=&#34;溯源取证总结&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#溯源取证总结&#34;&gt;#&lt;/a&gt; 溯源取证总结&lt;/h2&gt;
&lt;h4 id=&#34;类型&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#类型&#34;&gt;#&lt;/a&gt; 类型&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;web 入侵：挂马、网页篡改（博彩 / 黑帽 SEO 等）、植入 webshell，黑页，暗链等&lt;/li&gt;
&lt;li&gt;主机入侵：病毒木马、勒索软件、远控后门、系统异常、RDP 爆破、SSH 爆破、主机漏洞、数据库入侵等&lt;/li&gt;
&lt;li&gt;网络攻击：DDOS 攻击、DNS/HTTP 劫持、ARP 欺骗等&lt;/li&gt;
&lt;li&gt;路由器 / 交换机异常：内网病毒，配置错误等&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;初步信息收集&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#初步信息收集&#34;&gt;#&lt;/a&gt; 初步信息收集&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;客户属性：如名称 / 区域 / 领域等&lt;/li&gt;
&lt;li&gt;入侵范围：如主机数 / 网段等&lt;/li&gt;
&lt;li&gt;入侵现象：如 cpu 过高，勒索界面，异常网络链接，安全设备告警等&lt;/li&gt;
&lt;li&gt;客户需求：是否要求溯源，是否要求协助修复等&lt;/li&gt;
&lt;li&gt;收集信息：操作系统版本，补丁，数据库版本，中间件 / 服务器，网络拓扑，受害范围，处置情况，提取日志（主机，安全设备，数据库等）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;应急响应资源:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL3RoZUxTQS9oYWNrLWVyLXRvb2xz&#34;&gt;https://github.com/theLSA/hack-er-tools&lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&#34;分析流程image-20210505094445689&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#分析流程image-20210505094445689&#34;&gt;#&lt;/a&gt; 分析流程&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505094445689.png&#34; alt=&#34;image-20210505094445689&#34;&gt;&lt;/h4&gt;
&lt;h2 id=&#34;web应急响应&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#web应急响应&#34;&gt;#&lt;/a&gt; Web 应急响应&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;各类中间件/服务器日志默认存放位置&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;服务名&lt;/th&gt;
&lt;th&gt;服务器日志默认存放位置&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;IIS&lt;/td&gt;
&lt;td&gt;C:\WINDOWS\system32\LogFiles&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;apache&lt;/td&gt;
&lt;td&gt;Linux：/usr/local/apache/logs/&lt;br/&gt;Windows：apache/logs/&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tomcat&lt;/td&gt;
&lt;td&gt;conf/logging.properties&lt;br/&gt;logs/catalina.xx.log&lt;br/&gt;logs/host-manager.xx.log&lt;br/&gt;logs/localhost.xx.log&lt;br/&gt;logs/manager.xx.log&lt;br/&gt;主要记录系统启、关闭日志、管理日志和异常信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;weblogic&lt;/td&gt;
&lt;td&gt;domain_name/servers/server_name/logs/&lt;br/&gt;server_name.log：server 启停日志&lt;br/&gt;access.log：安装在该 server 之上的应用 http 访问日志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;jboss&lt;/td&gt;
&lt;td&gt;LOG4J 配置默认 Deploy/conf/&lt;br/&gt;如 jboss/server/default/conf/jboss-log4j.xml&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;webshell排查&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#webshell排查&#34;&gt;#&lt;/a&gt; webshell 排查&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1. 整站打包用webshell扫描工具扫&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. 利用Linux find命令查询木马&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find /var/www/ -name &lt;span class=&#34;string&#34;&gt;&amp;quot;*.php&amp;quot;&lt;/span&gt; |xargs egrep &amp;#x27;assert|phpspy|c&lt;span class=&#34;number&#34;&gt;99&lt;/span&gt;sh|milw&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;rm|eval|(&lt;span class=&#34;name&#34;&gt;gunerpress&lt;/span&gt;|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;name&#34;&gt;base64_decoolcode&lt;/span&gt;|spider_bc|shell_exec|passthru|($_\POST[|eval&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(&lt;span class=&#34;name&#34;&gt;str_rot13&lt;/span&gt;|.chr(|$&amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;_P|eval($_R|file_put_contents(.*$_|base64_decode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;grep -i –r eval($_post /app/website/*&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight clojure&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;find /app/website/ -type f|xargs grep eval($_post&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;数据库排查&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#数据库排查&#34;&gt;#&lt;/a&gt; 数据库排查&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;mysql和mssql日志&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;日志类型 (mysql)&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;错误日志&lt;/td&gt;
&lt;td&gt;默认开启，hostname.error&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;查询日志&lt;/td&gt;
&lt;td&gt;记录用户的所有操作。默认关闭，general_log_file（常见 getshell 手法）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;慢查询日志&lt;/td&gt;
&lt;td&gt;记录执行时间超过指定时间的查询语句，slow_query_log_file（慢查询 getshell）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;事务日志&lt;/td&gt;
&lt;td&gt;ib_logfile0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;二进制日志&lt;/td&gt;
&lt;td&gt;记录修改数据或有可能引起数据改变的 mysql 语句，log_bin，默认在数据目录，如&lt;br/&gt;mysql-bin.000001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;日志类型 (mssql) 版本 ****&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;默认路径&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2005&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL.&lt;em&gt;n&lt;/em&gt;\MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2008&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL10. 实例名 \MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SQL SERVER 2008 R2&lt;/td&gt;
&lt;td&gt;Program Files\Microsoft SQL Server\MSSQL10_50. 实例名 \MSSQL\LOG&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;小总结&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1. mysql\lib\plugin目录的异常文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. select * from mysql.func的异常&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3. mssql检查xp_cmdshell等存储过程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4. 异常数据库登录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5. 数据库用户弱口令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6. mysql相关命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show global variables like &amp;#x27;%log%&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show global variables like &amp;#x27;%gene%&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show master status;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemmore /mydata/data/stu18_slow.log;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showbinary logs;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showmaster logs;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;showbinlog events in &amp;#x27;mysql-bin.000011&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show processlist;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;linux应急响应&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#linux应急响应&#34;&gt;#&lt;/a&gt; Linux 应急响应&lt;/h2&gt;
&lt;h4 id=&#34;文件&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件&#34;&gt;#&lt;/a&gt; 文件&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Linux 命令&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ls -alt&lt;/td&gt;
&lt;td&gt;按时间排序以长字符串的形式显示所有文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find / -ctime 2&lt;/td&gt;
&lt;td&gt;查找 72 小时内新增的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find ./ -mtime 0 -name “*.jsp”&lt;/td&gt;
&lt;td&gt;查找 24 小时内被修改的 JSP 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ls -al /tmp |grep “Feb 27”&lt;/td&gt;
&lt;td&gt;根据确定时间去反推变更的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find / *.jsp -perm 4777&lt;/td&gt;
&lt;td&gt;查找 777 的权限的文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;strings /usr/bin/.sshd |egrep ‘&lt;span 1,3=&#34;&#34;&gt;1-9&lt;/span&gt;.&lt;span 1,3=&#34;&#34;&gt;1-9&lt;/span&gt;.’&lt;/td&gt;
&lt;td&gt;分析 sshd 文件是否包括 IP 信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find /etc/ /usr/bin/ /usr/sbin/ /bin/ /usr/local/bin/ -type f -mtime 0&lt;/td&gt;
&lt;td&gt;更改的信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;find /tmp -iname “*” -atime 1 -type f&lt;/td&gt;
&lt;td&gt;访问的信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/run/utmp 有关当前登录用户的信息记录&lt;br/&gt;~/.ssh&lt;br/&gt;/etc/passwd 用户列表&lt;/td&gt;
&lt;td&gt;文件日期、新增文件、可疑 / 异常文件、最近使用文件、浏览器下载文件&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;日志&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#日志&#34;&gt;#&lt;/a&gt; 日志&lt;/h4&gt;
&lt;p&gt;这里附上一张图片&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505103536118.png&#34; alt=&#34;image-20210505103536118&#34;&gt;&lt;/p&gt;
&lt;p&gt;补充&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/var/log/wtmp 登录进入，退出，数据交换、关机和重启纪录，即last&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/lastlog 文件记录用户最后登录的信息，即lastlog&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/secure 记录登入系统存取数据的文件，如 pop3/ssh/telnet/ftp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/cron 与定时任务相关的日志信息，记录crontab命令是否被正确的执行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/message 系统启动后的信息和错误日志,包括整体系统信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/apache2/access.log apache有关权限日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/auth.log 包含系统授权信息，包括用户登录和使用的权限机制等&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/userlog 记录所有等级用户信息的日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/xferlog(vsftpd.log)记录Linux FTP日志&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/secure 记录大多数应用输入的账号与密码，登录成功与否&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/var/log/faillog 记录登录系统不成功的账号信息&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;扩展（历史记录）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;history (cat /root/.bash_history)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mysql-history (cat /root/.mysql_history)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用正则表达式筛选条件&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;正则表达式筛选条件&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;grep ‘Failed’ /var/log/secure |awk ‘{print $11}’ |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看爆破失败的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep ‘Accepted’ /var/log/secure |awk ‘{print $11}’ |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看登录成功的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password for root” /var/log/auth.log |awk ‘{print $11}’ |sort |uniq -c |sort -nr |more&lt;/td&gt;
&lt;td&gt;定位有多少 IP 在爆破主机的 root 帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep &amp;quot;Accepted &amp;quot; /var/log/auth.log |awk ‘{print $11}’ |sort |uniq -c |sort -nr |more&lt;/td&gt;
&lt;td&gt;登录成功的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tail -400f demo.log&lt;/td&gt;
&lt;td&gt;监控最后 400 行日志文件的变化 等价与 tail -n 400 -f （-f 参数是实时）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;uniq -c demo.log&lt;/td&gt;
&lt;td&gt;标记该行重复的数量，不重复值为 1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep -c ‘ERROR’ demo.log&lt;br/&gt;cat /var/log/secure |grep &#39;Accepted password‘&lt;/td&gt;
&lt;td&gt;输出文件 demo.log 中查找所有包行 ERROR 的行的数量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep &amp;quot;Accepted &amp;quot; /var/log/secure* |awk ‘{print $1,$2,$3,$9,$11}’&lt;/td&gt;
&lt;td&gt;查看登录成功的日期、用户名及 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “refused” /var/log/secure* |awk {‘print $9’} |sort |uniq -c |sort -nr |more （开启 iptables 的情况）&lt;br/&gt;grep “Failed password” /var/log/secure* |grep -E -o “((&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;).(&lt;span 1,3=&#34;&#34;&gt;0-9&lt;/span&gt;))” |uniq -c (没开启防火墙的情况)&lt;/td&gt;
&lt;td&gt;查看试图爆破主机的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password for root” /var/log/secure |awk ‘{print $11}’ |sort&lt;/td&gt;
&lt;td&gt;查看爆破主机的 ROOT 账号的 IP&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;grep “Failed password” /var/log/secure |awk {‘print $9’} |sort |uniq -c |sort -nr&lt;/td&gt;
&lt;td&gt;查看爆破用户名字典&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td print=&#34;&#34; $1,$2,$3,$9,$11=&#34;&#34;&gt;grep -o “Failed password” /var/log/secure|uniq -c&lt;br/&gt;grep &amp;quot;Accepted &amp;quot; /var/log/secure |awk ’&lt;/td&gt;
&lt;td&gt;查看爆破用户名字典&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;用户&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#用户&#34;&gt;#&lt;/a&gt; 用户&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Linux 命令&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;last&lt;/td&gt;
&lt;td&gt;显示用户最近登录信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cat /etc/shadow&lt;/td&gt;
&lt;td&gt;查看密码登陆相关信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;uptime&lt;/td&gt;
&lt;td&gt;查看用户登陆时间&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/sudoers&lt;/td&gt;
&lt;td&gt;sudo 用户列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;awk -F: ‘($3==0){print$1}’ /etc/passwd&lt;/td&gt;
&lt;td&gt;查看 UID 为 0 的帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;awk -F: ‘($2==&amp;quot;&amp;quot;){print$1}’ /etc/shadow&lt;/td&gt;
&lt;td&gt;查看密码为空的账号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cat /etc/passwd |grep -E “/bin/bash$”&lt;/td&gt;
&lt;td&gt;查看能够登录的帐号&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lastlog&lt;/td&gt;
&lt;td&gt;系统中所有用户最近一次登录信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lastb&lt;/td&gt;
&lt;td&gt;用户错误的登录列表&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;more /etc/sudoers |grep -v “&lt;sup&gt;#|&lt;/sup&gt;$” |grep “ALL=(ALL)”&lt;/td&gt;
&lt;td&gt;查看 sudo 权限的用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;who&lt;/td&gt;
&lt;td&gt;查询 utmp 文件并报告当前登录的每个用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;w&lt;/td&gt;
&lt;td&gt;查询 utmp 文件并显示当前系统中每个用户和它所运行的进程信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;users&lt;/td&gt;
&lt;td&gt;打印当前登录的用户，每个用户名对应一个登录会话。如果一个用户不止一个登录会话，其用户名显示相同次数&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;进程&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#进程&#34;&gt;#&lt;/a&gt; 进程&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;进程命令&lt;/th&gt;
&lt;th&gt;效果&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;lsof&lt;/td&gt;
&lt;td&gt;列出当前系统打开文件的工具&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps aux |grep pid |grep –v grep&lt;/td&gt;
&lt;td&gt;查看对应的进程信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -i:1677&lt;/td&gt;
&lt;td&gt;查看指定端口对应的程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -p 1234&lt;/td&gt;
&lt;td&gt;检查 pid 号为 1234 进程调用情况&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;strace -f -p 1234&lt;/td&gt;
&lt;td&gt;跟踪分析 pid 号为 1234 的进程&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;lsof -g gid&lt;/td&gt;
&lt;td&gt;找恶意文件关联的 lib 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps -ef&lt;/td&gt;
&lt;td&gt;查看全格式的全部进程&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pstree -a&lt;/td&gt;
&lt;td&gt;以树状图的方式展现进程之间的派生关系&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ps -ef |awk ‘{print}’ |sort -n |uniq &amp;gt;1&lt;br/&gt;ls /proc |sort -n |uniq &amp;gt;2&lt;/td&gt;
&lt;td&gt;隐藏进程查看&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;diff 1 2&lt;/td&gt;
&lt;td&gt;比较文本文件的异同处&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;netstat -anptl&lt;/td&gt;
&lt;td&gt;显示网络状态，端口信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;top&lt;/td&gt;
&lt;td&gt;实时显示系统中各个进程的资源占用状况&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;自启动&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#自启动&#34;&gt;#&lt;/a&gt; 自启动&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;启动配置文件&lt;/th&gt;
&lt;th&gt;特征&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;~/.bashrc&lt;/td&gt;
&lt;td&gt;用户 HOME 家目录启动文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/rc.local&lt;/td&gt;
&lt;td&gt;开机启动程序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/init.d/ 服务&lt;/td&gt;
&lt;td&gt;服务启动关闭&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron*&lt;/td&gt;
&lt;td&gt;定时任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;chkconfig --list |grep “3:on|5:on”&lt;/td&gt;
&lt;td&gt;查看开机自启动服务&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;计划任务&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#计划任务&#34;&gt;#&lt;/a&gt; 计划任务&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;查看计划任务命令&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;crontab -l &amp;amp; cat /etc/crontab &amp;amp; ls /etc/cron.* 查看计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;crontab -e  进行修改计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;crontab -u root -l  显示 root 用户计划任务&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;配置文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/spool/cron/*    root 用户执行的就会在 /var/spool/cron/ 下面创建 root 文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron.d    cron 任务可以根据调度来执行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/cron.daily/     每日计划 *&lt;br/&gt;/etc/cron.hourly/   小时计划 *&lt;br/&gt;/etc/cron.monthly/  月计划 *&lt;br/&gt;/etc/cron.weekly/   周计划&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/etc/anacrontab   Anacrontab 的配置入口&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/var/log/cron*   日志计划程序&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;misc 杂&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stat 命令查看文件或文件系统的状态时间等属性&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $PATH 查看环境变量&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/rpm -Va &amp;gt; rpm.log 校验所有的RPM软件包，查找丢失的文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kill -9 强制杀死进程&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chattr –i 取消锁定文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setfacl / getfacl  ACL权限设置&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;chmod 000 去执行权限&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strings /usr/bin/.sshd | egrep &amp;#x27;[1-9]&amp;#123;1,3&amp;#125;.[1-9]&amp;#123;1,3&amp;#125;.&amp;#x27; ssh后门快速判断&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;windows取证&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#windows取证&#34;&gt;#&lt;/a&gt; Windows 取证&lt;/h2&gt;
&lt;p&gt;思维导图&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://gitee.com/chungod/picture/raw/master/image/image-20210505135434533.png&#34; alt=&#34;image-20210505135434533&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;文件-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#文件-2&#34;&gt;#&lt;/a&gt; 文件&lt;/h4&gt;
&lt;p&gt;分析文件路径&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;文件路径&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Documents and Settings\Administrator\Recent&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Documents and Settings\Default User\Recent&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%UserProfile%\Recent  文件日期、新增文件、可疑/异常文件、最近使用文件、浏览器下载文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;下载目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;回收站文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;程序临时文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;历史文件记录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;应用程序打开历史&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;搜索历史&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;快捷方式（LNK）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;c:\windows\temp\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Window 2003 C:\Documents and Settings&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Window 2008R2 C:\Users\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;时间排序文件&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;findstr /s /m /I “UploadFiles” *.log  查看指定时间范围包括上传文件夹的访问请求&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;findstr /s /m /I “x.js” *.asp 关键信息是x.js&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;日志-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#日志-2&#34;&gt;#&lt;/a&gt; 日志&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;日志类型&lt;/th&gt;
&lt;th&gt;命令&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;系统日志，程序日志，安全日志&lt;/td&gt;
&lt;td&gt;eventvwr.msc&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;服务器日志&lt;/td&gt;
&lt;td&gt;FTP 连接日志和 HTTPD 事务日志：% systemroot% \system32\LogFiles\ &lt;br/&gt;IIS 日志默认存放在 System32\LogFiles 目录下，使用 W3C 扩展格式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;操作系统日志&lt;/td&gt;
&lt;td&gt;登录成功的所有事件：&lt;br/&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;指定登录时间范围的事件：&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where TimeGenerated&amp;gt;’2018-&lt;br/&gt;06-19 23:32:11′ and TimeGenerated&amp;lt;’2018-06-20 23:34:00′ and EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;提取登录成功的用户名和 IP&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT EXTRACT_TOKEN(Message,13,’ ‘)as&lt;br/&gt;EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,’|’) as&lt;br/&gt;Username,EXTRACT_TOKEN(Message,38,’ ‘) as Loginip FROM c:\Security.evtx where EventID=4624″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;登录失败的所有事件&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT * FROM c:\Security.evtx where EventID=4625″&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;提取登录失败用户名进行聚合统计&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT “SELECT EXTRACT_TOKEN(Message,13,’ ‘) as &lt;br/&gt; as user,count(EXTRACT_TOKEN(Message,19,’ ‘)) as Times,EXTRACT_TOKEN(Message,39,’ ‘)   as Loginip FROM c:\Security.evtx where &lt;br/&gt; EventID=4625GROUP BY Message”&lt;br/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;系统历史开关机记录&lt;/td&gt;
&lt;td&gt;LogParser.exe -i:EVT –o:DATAGRID “SELECT TimeGenerated,EventID,Message FROM c:\System.evtx where EventID=6005 or EventID=6006″&lt;br/&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;常用事件 ID 含义&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Event ID(2000/XP/2003)&lt;/th&gt;
&lt;th&gt;Event ID(Vista/7/8/2008/2012)&lt;/th&gt;
&lt;th&gt;描述&lt;/th&gt;
&lt;th&gt;日志名称&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;528&lt;/td&gt;
&lt;td&gt;4624&lt;/td&gt;
&lt;td&gt;成功登录&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;529&lt;/td&gt;
&lt;td&gt;4625&lt;/td&gt;
&lt;td&gt;失败登录&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;680&lt;/td&gt;
&lt;td&gt;4776&lt;/td&gt;
&lt;td&gt;成功 / 失败的账户认证&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;624&lt;/td&gt;
&lt;td&gt;4720&lt;/td&gt;
&lt;td&gt;创建用户&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;636&lt;/td&gt;
&lt;td&gt;4732&lt;/td&gt;
&lt;td&gt;添加用户到启用安全性的本地组中&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;632&lt;/td&gt;
&lt;td&gt;4728&lt;/td&gt;
&lt;td&gt;添加用户到启用安全性的全局组中&lt;/td&gt;
&lt;td&gt;Security&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2934&lt;/td&gt;
&lt;td&gt;7030&lt;/td&gt;
&lt;td&gt;服务创建错误&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2944&lt;/td&gt;
&lt;td&gt;7040&lt;/td&gt;
&lt;td&gt;IPSEC 服务服务的启动类型已从禁用更改为自动启动&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2949&lt;/td&gt;
&lt;td&gt;7045&lt;/td&gt;
&lt;td&gt;服务创建&lt;/td&gt;
&lt;td&gt;System&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;登录类型 ID&lt;/p&gt;
&lt;p&gt;成功 / 失败登录事件提供的有用信息之一是用户 / 进程尝试登录（登录类型），但 Windows 将此信息显示为数字，下面是数字和对应的说明：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;录类型&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;登录类型&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;描述&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Interactive&lt;/td&gt;
&lt;td&gt;用户登录到本机&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;Network&lt;/td&gt;
&lt;td&gt;用户或计算手机从网络登录到本机，如果网络共享，或使用 net use 访问网络共享，net view 查看网络共享&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;Batch&lt;/td&gt;
&lt;td&gt;批处理登录类型，无需用户干预&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;Service&lt;/td&gt;
&lt;td&gt;服务控制管理器登录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;Unlock&lt;/td&gt;
&lt;td&gt;用户解锁主机&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;NetworkCleartext&lt;/td&gt;
&lt;td&gt;用户从网络登录到此计算机，用户密码用非哈希的形式传递&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;NewCredentials&lt;/td&gt;
&lt;td&gt;进程或线程克隆了其当前令牌，但为出站连接指定了新凭据&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;Remotelnteractive&lt;/td&gt;
&lt;td&gt;使用终端服务或远程桌面连接登录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;Cachedlnteractive&lt;/td&gt;
&lt;td&gt;用户使用本地存储在计算机上的凭据登录到计算机（域控制器可能无法验证凭据），如主机不能连接域控，以前使用域账户登录过这台主机，再登录就会产生这样日志&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;CachedRemotelnteractive&lt;/td&gt;
&lt;td&gt;与 Remotelnteractive 相同，内部用于审计目的&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;td&gt;CachedUnlock&lt;/td&gt;
&lt;td&gt;登录尝试解锁&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;账号&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#账号&#34;&gt;#&lt;/a&gt; 账号&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;新增用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;隐藏/克隆帐号&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;管理员对应键值&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lusrmgr.msc 查看账户变化&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net user 列出当前登录账户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic UserAccount get 列出当前系统所有账户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;net localgroup administrators 列出管理员组用户&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;注册表-管理员键值：HKEY_LOCAL_MACHINE/SAM/SAM/Domains/Account/Users&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;D盾查杀&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;日志-登录时间/用户名&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;进程-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#进程-2&#34;&gt;#&lt;/a&gt; 进程&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tasklist /svc | findstr pid  查看服务进行&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;netstat -ano&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic process | find &amp;quot;Proccess Id&amp;quot; &amp;gt; proc.csv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;powershell: Get-WmiObject -Class Win32_Process&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msinfo32 查看自己电脑配置详情&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight powershell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;扩展powershell命令&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get caption,commandline /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;where&lt;/span&gt; caption=”svchost.exe” get caption,commandline /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic service get name,pathname,processid,startname,status,state /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get CreationDate,name,processid,commandline,ExecutablePath /value&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic &lt;span class=&#34;keyword&#34;&gt;process&lt;/span&gt; get name,processid,executablepath| findstr &lt;span class=&#34;string&#34;&gt;&amp;quot;7766&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;端口&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#端口&#34;&gt;#&lt;/a&gt; 端口&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;netstat -ano&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;端口状态&lt;/th&gt;
&lt;th&gt;说明&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;CLOSED&lt;/td&gt;
&lt;td&gt;无连接活动或正在进行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LISTEN&lt;/td&gt;
&lt;td&gt;监听中等待连接&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SYN_RECV&lt;/td&gt;
&lt;td&gt;服务端接收了 SYN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SYN_SENT&lt;/td&gt;
&lt;td&gt;请求连接等待确认&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ESTABLISHED&lt;/td&gt;
&lt;td&gt;连接建立数据传输&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FIN_WAIT1&lt;/td&gt;
&lt;td&gt;请求中止连接，等待对方 FIN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;FIN_WAIT2&lt;/td&gt;
&lt;td&gt;同意中止，请稍候&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ITMED_WAIT&lt;/td&gt;
&lt;td&gt;等待所有分组死掉&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CLOSING&lt;/td&gt;
&lt;td&gt;两边同时尝试关闭&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TIME_WAIT&lt;/td&gt;
&lt;td&gt;另一边已初始化一个释放&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LAST_ACK&lt;/td&gt;
&lt;td&gt;等待原来的发向远程 TCP 的连接中断请求的确认&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CLOSE-WAIT&lt;/td&gt;
&lt;td&gt;等待关闭连接&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&#34;自启动-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#自启动-2&#34;&gt;#&lt;/a&gt; 自启动&lt;/h4&gt;
&lt;p&gt;注册表位置&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\policies\Explorer\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HKLM\Software\Microsoft\Windows\CurrentVersion\RunonceEx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;(ProfilePath)\Start Menu\Programs\Startup 启动项&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shell:startup  查看开机自启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;msconfig 启动选项卡&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gpedit.msc 组策略编辑器&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;开始&amp;gt;所有程序&amp;gt;启动&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wmic startup list full&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;计划任务-2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#计划任务-2&#34;&gt;#&lt;/a&gt; 计划任务&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\System32\Tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\SysWOW64\Tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C:\Windows\tasks\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;schtasks&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;taskschd.msc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;at&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;开始-设置-控制面板-任务计划&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;注册表&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#注册表&#34;&gt;#&lt;/a&gt; 注册表&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;注册表位置&lt;/th&gt;
&lt;th&gt;对应信息&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList&lt;/td&gt;
&lt;td&gt;临时配置文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HKLM\SAM\Domains\Account\&lt;/td&gt;
&lt;td&gt;用户信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\policies\system&lt;/td&gt;
&lt;td&gt;UAC 注册表位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Active Setup\Installed Components&lt;/td&gt;
&lt;td&gt;安装的组件信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\App Paths&lt;/td&gt;
&lt;td&gt;软件环境变量&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\software\microsoft\windows nt\CurrentVersion\winlogon&lt;/td&gt;
&lt;td&gt;系统启动&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\software\microsoft\security center\svc&lt;/td&gt;
&lt;td&gt;安全中心报警&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths&lt;/td&gt;
&lt;td&gt;让源管理器中的地址栏不记录文件的打开记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Windows\CurrentVersion\explorer\RunMru&lt;/td&gt;
&lt;td&gt;禁止自动保存运行记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\explorer\Startmenu&lt;/td&gt;
&lt;td&gt;软件自动启动项&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\System\CurrentControlSet\Control\Session Manager&lt;/td&gt;
&lt;td&gt;装载 Win32 子系统内核模式部分&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hkcu:\Software\Microsoft\Internet Explorer\Extensions&lt;/td&gt;
&lt;td&gt;记录最后下载软件的存储位置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\Software\Microsoft\Windows\CurrentVersion\ShellExtensions\Approved&lt;/td&gt;
&lt;td&gt;系统或者用户已注册的外壳扩展功能模块&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;hklm:\System\CurrentControlSet\Control\Session Manager\AppCertDlls&lt;/td&gt;
&lt;td&gt;后门及持久化访问&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;本文内容借鉴：应急响应实战 checklist pdf&lt;/p&gt;
&lt;p&gt;博客：&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMjUyNA==&#34;&gt;https://xz.aliyun.com/t/2524&lt;/span&gt;&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
