{
    "version": "https://jsonfeed.org/version/1",
    "title": "Go Forward • All posts by \"ch4inrulz靶机笔记\" tag",
    "description": "欢迎来到我的博客(*^﹏^*),本人为新人,你可以阅读我的学习笔记并提出独到的见解~我们将互相学习,共同进步,望大佬们勿喷",
    "home_page_url": "https://chungod.github.io",
    "items": [
        {
            "id": "https://chungod.github.io/2021/11/23/CH4INRULZ%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/",
            "url": "https://chungod.github.io/2021/11/23/CH4INRULZ%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/",
            "title": "CH4INRULZ靶机笔记",
            "date_published": "2021-11-23T07:48:35.000Z",
            "content_html": "<h2 id=\"ch4inrulz靶机笔记\"><a class=\"markdownIt-Anchor\" href=\"#ch4inrulz靶机笔记\">#</a> CH4INRULZ 靶机笔记</h2>\n<h5 id=\"信息收集\"><a class=\"markdownIt-Anchor\" href=\"#信息收集\">#</a> 信息收集</h5>\n<p>首先需要进行主机发现</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">思路: 通过arp-scan -l 进行扫描 ，找到目标主机的MAC地址为00:0c:29:ed:8a:e7</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122210612832.png\" alt=\"image-20211122210612832\"></p>\n<p>利用 nmap 进行初步探测，发现开放了 21、22、80、8011 端口</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122210727745.png\" alt=\"image-20211122210727745\"></p>\n<p>发现有两个 Web 端口，利用 dirb 进行扫描其目录</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dirb http://IP  (发现只扫描出几个目录)</span><br><span class=\"line\">dirb http://IP:8011/</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122210906429.png\" alt=\"image-20211122210906429\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122211038557.png\" alt=\"image-20211122211038557\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123191304864.png\" alt=\"image-20211123191304864\"></p>\n<h5 id=\"漏洞利用\"><a class=\"markdownIt-Anchor\" href=\"#漏洞利用\">#</a> 漏洞利用</h5>\n<p>浏览器发现登录后台</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122211409036.png\" alt=\"image-20211122211409036\"> 继续进行收集，发现 dirb 存在 <code>index.html.bak</code>  文件</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122211608812.png\" alt=\"image-20211122211608812\"></p>\n<p>将其下载下来，发现存在 frank 用户及密码（利用 john 工具破解）</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122211745050.png\" alt=\"image-20211122211745050\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122211841319.png\" alt=\"image-20211122211841319\"></p>\n<p>利用这个用户进行登录</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122212021586.png\" alt=\"image-20211122212021586\"></p>\n<p>发现存在上传点，上传反弹图片木马，进行 getshell</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122212529338.png\" alt=\"image-20211122212529338\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122212618674.png\" alt=\"image-20211122212618674\"></p>\n<p>将 gif 图片马进行上传</p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122212733758.png\" alt=\"image-20211122212733758\"></p>\n<h5 id=\"文件包含\"><a class=\"markdownIt-Anchor\" href=\"#文件包含\">#</a> 文件包含</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">成功上传后，才是重头戏，需要找到文件路径</span><br><span class=\"line\">转移目标到8081端口，发现存在一些php文件（包含）</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122213026227.png\" alt=\"image-20211122213026227\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发现可以访问files_api.php，看文件名可能为文件包含</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122213150175.png\" alt=\"image-20211122213150175\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">尝试利用GET请求进行文件包含/etc/passwd  (失败)</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122213236176.png\" alt=\"image-20211122213236176\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">转变思路：尝试使用post请求进行文件包含,成功包含passwd文件</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122213607494.png\" alt=\"image-20211122213607494\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">既然能进行任意文件读取，那么我们可以读取upload.php来获得文件上传路径，但是这里也不知道80端口文件路径。这里通过apache的配置文件/etc/apache2/sites-enabled/000-default来获得</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122214023563.png\" alt=\"image-20211122214023563\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">思路一：猜测路径，看提示说是my uploads,因为用户为Franch，成功</span><br><span class=\"line\">找到上传路径http://IP/development/uploader/FRANKuploads/</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122214123527.png\" alt=\"image-20211122214123527\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">思路二：</span><br><span class=\"line\">利用php://filter结合php伪协议读取uploader.php里面的内容包含</span><br><span class=\"line\">/var/www/development/uploader/upload.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122214627358.png\" alt=\"image-20211122214627358\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122214825668.png\" alt=\"image-20211122214825668\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将其进行base64解码，找到上传路径FRANKuploads/</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211122214936489.png\" alt=\"image-20211122214936489\"></p>\n<h5 id=\"getshell\"><a class=\"markdownIt-Anchor\" href=\"#getshell\">#</a> getshell</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">方法一：通过文件包含语句，包含已上传的gif木马，成功getshell</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123171835744.png\" alt=\"image-20211123171835744\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123172202574.png\" alt=\"image-20211123172202574\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123171904017.png\" alt=\"image-20211123171904017\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">方法二：也可以利用到kali里面自带的php-reverse-shell.php文件。路径是/usr/share/webshells/php/php-reverse-shell.php</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123172343678.png\" alt=\"image-20211123172343678\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将IP地址修改成kali的地址和kali开启的监听端口，加上GIF89a图片头改成gif后缀上传</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123172438798.png\" alt=\"image-20211123172438798\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc 进行监听端口1234</span><br><span class=\"line\">nc -lvvp 1234</span><br><span class=\"line\">同时文件包含访问我们刚刚上传的那个用来反弹shell的文件。</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123172855804.png\" alt=\"image-20211123172855804\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123172951626.png\" alt=\"image-20211123172951626\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123173002488.png\" alt=\"image-20211123173002488\"></p>\n<h5 id=\"提权\"><a class=\"markdownIt-Anchor\" href=\"#提权\">#</a> 提权</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname -a 查看内核版本为Linux ubuntu 2.6.35-19-generic</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123173135449.png\" alt=\"image-20211123173135449\"></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">搜索可利用的提权脚本</span><br><span class=\"line\">searchsploit linux 2.6.3</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">发现可以通过脏牛提权40839.c,内核提权15023.c，15285.c进行渗透</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123173828857.png\" alt=\"image-20211123173828857\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20211123174138404.png\" alt=\"image-20211123174138404\"></p>\n",
            "tags": [
                "CH4INRULZ靶机笔记"
            ]
        }
    ]
}