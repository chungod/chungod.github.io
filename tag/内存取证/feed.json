{
    "version": "https://jsonfeed.org/version/1",
    "title": "Go Forward • All posts by \"内存取证\" tag",
    "description": "欢迎来到我的博客(*^﹏^*),本人为新人,你可以阅读我的学习笔记并提出独到的见解~我们将互相学习,共同进步,望大佬们勿喷",
    "home_page_url": "https://chungod.github.io",
    "items": [
        {
            "id": "https://chungod.github.io/2021/04/09/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/",
            "url": "https://chungod.github.io/2021/04/09/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/",
            "title": "内存取证",
            "date_published": "2021-04-09T09:14:41.000Z",
            "content_html": "<h1 id=\"内存取证\"><a class=\"markdownIt-Anchor\" href=\"#内存取证\">#</a> <strong>内存取证</strong></h1>\n<h2 id=\"volatility-使用\"><a class=\"markdownIt-Anchor\" href=\"#volatility-使用\">#</a> <strong>volatility 使用：</strong></h2>\n<h3 id=\"获取内存镜像的摘要信息\"><a class=\"markdownIt-Anchor\" href=\"#获取内存镜像的摘要信息\">#</a> <strong>获取内存镜像的摘要信息</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw imageinfo</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102135222699.png\" alt=\"image-20201102135222699\"></strong></p>\n<blockquote>\n<p><strong>判断系统版本应该是 Win7SP1x64</strong></p>\n</blockquote>\n<h3 id=\"查看进程信息\"><a class=\"markdownIt-Anchor\" href=\"#查看进程信息\">#</a> <strong>查看进程信息</strong></h3>\n<p><strong>pslist 可以直接列出运行的进程，如果进程已经结束，会在 Exit 列显示日期和时间，表明进程已经结束</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 pslist</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102141316628.png\" alt=\"image-20201102141316628\"></strong></p>\n<h3 id=\"查看隐藏进程\"><a class=\"markdownIt-Anchor\" href=\"#查看隐藏进程\">#</a> <strong>查看隐藏进程</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 pstree</span><br><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 psxview</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102154603111.png\" alt=\"image-20201102154603111\"></strong></p>\n<h3 id=\"列举缓存在内存的注册表\"><a class=\"markdownIt-Anchor\" href=\"#列举缓存在内存的注册表\">#</a> <strong>列举缓存在内存的注册表</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 hivelist</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102150810232.png\" alt=\"image-20201102150810232\"></strong></p>\n<h3 id=\"提取主机名\"><a class=\"markdownIt-Anchor\" href=\"#提取主机名\">#</a> <strong>提取主机名</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 printkey -K &quot;ControlSet001\\Control\\ComputerName\\ComputerName&quot;</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201115091150119.png\" alt=\"image-20201115091150119\"></strong></p>\n<h3 id=\"提取自启动项\"><a class=\"markdownIt-Anchor\" href=\"#提取自启动项\">#</a> <strong>提取自启动项</strong></h3>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201115091434803.png\" alt=\"image-20201115091434803\"></strong></p>\n<p><strong>提取内存中保留的 cmd 命令使用情况</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f name --profile=WinXPSP2x86 cmdscan</span><br></pre></td></tr></table></figure>\n<p><strong>获取到当时的网络连接情况</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f name --profile=WinXPSP2x86 netscan</span><br></pre></td></tr></table></figure>\n<h3 id=\"提取ip地址和主机名\"><a class=\"markdownIt-Anchor\" href=\"#提取ip地址和主机名\">#</a> <strong>提取 ip 地址和主机名</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f name --profile=WinXPSP2x86 netscan | grep ESTABLISHED</span><br></pre></td></tr></table></figure>\n<p><strong>userassist 键值包含系统或桌面执行文件的信息，如名称、路径、执行次数、最后一次执行时间等</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f name --profile=WinXPSP2x86 userassist</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取sam表中的用户\"><a class=\"markdownIt-Anchor\" href=\"#获取sam表中的用户\">#</a> <strong>获取 SAM 表中的用户 ：</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 printkey -K &quot;SAM\\Domains\\Account\\Users\\Names&quot;</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102152225937.png\" alt=\"image-20201102152225937\"></strong></p>\n<p><strong>显示每个进程的加载 dll 列表</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Volatility -f name -profile = Win7SP0x86 dlllist&gt; dlllist.txt</span><br></pre></td></tr></table></figure>\n<h3 id=\"扫描内存中的文件\"><a class=\"markdownIt-Anchor\" href=\"#扫描内存中的文件\">#</a> <strong>扫描内存中的文件</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 filescan</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102151129039.png\" alt=\"image-20201102151129039\"></strong></p>\n<ul>\n<li><strong>filescan 也可以结合 grep 命令来进行筛选，比如</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 filescan | grep &quot;doc\\|docx&quot;</span><br><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 filescan | grep &quot;flag&quot;</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102151359619.png\" alt=\"image-20201102151359619\"></strong></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201203173328344.png\" alt=\"image-20201203173328344\"></p>\n<h2 id=\"提取flag值\"><a class=\"markdownIt-Anchor\" href=\"#提取flag值\">#</a> 提取 flag 值</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 dumpfiles -Q 0x07f1b6c10 --dump-dir=./</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201203174024646.png\" alt=\"image-20201203174024646\"></p>\n<p><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201203174048410.png\" alt=\"image-20201203174048410\"></p>\n<h3 id=\"提取内存中保留的cmd命令使用情况\"><a class=\"markdownIt-Anchor\" href=\"#提取内存中保留的cmd命令使用情况\">#</a> <strong>提取内存中保留的 cmd 命令使用情况</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 cmdline</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102151626278.png\" alt=\"image-20201102151626278\"></strong></p>\n<h3 id=\"提取出内存中记录的-当时正在运行的程序\"><a class=\"markdownIt-Anchor\" href=\"#提取出内存中记录的-当时正在运行的程序\">#</a> <strong>提取出内存中记录的 当时正在运行的程序</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.vmem --profile=Win7SP1x64 userassist</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102152650474.png\" alt=\"image-20201102152650474\"></strong></p>\n<h2 id=\"提取网络连接情况\"><a class=\"markdownIt-Anchor\" href=\"#提取网络连接情况\">#</a> <strong>提取网络连接情况</strong></h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 netscan</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102153001736.png\" alt=\"image-20201102153001736\"></strong></p>\n<h3 id=\"提取ie浏览器历史\"><a class=\"markdownIt-Anchor\" href=\"#提取ie浏览器历史\">#</a> <strong>提取 IE 浏览器历史</strong></h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 iehistory</span><br></pre></td></tr></table></figure>\n<h3 id=\"提取系统密码hashdump\"><a class=\"markdownIt-Anchor\" href=\"#提取系统密码hashdump\">#</a> <strong>提取系统密码</strong>（hashdump）</h3>\n<p><strong>直接 hashdump</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 hashdump</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102154219862.png\" alt=\"image-20201102154219862\"></strong></p>\n<ul>\n<li><strong>注册表 system 的 virtual 地址</strong></li>\n<li><strong>SAM 的 virtual 地址</strong></li>\n</ul>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102153454213.png\" alt=\"image-20201102153454213\"></strong></p>\n<ul>\n<li><strong>dump 出来密码</strong></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.vmem --profile=Win7SP1x64 hashdump -y （注册表 system 的 virtual 地址 ）-s （SAM 的 virtual 地址）</span><br><span class=\"line\">volatility -f mem.vmen --profile=Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000867010</span><br></pre></td></tr></table></figure>\n<p><strong><img data-src=\"https://gitee.com/chungod/picture/raw/master/image/image-20201102153714379.png\" alt=\"image-20201102153714379\"></strong></p>\n<h3 id=\"提取迁移后的进程编号\"><a class=\"markdownIt-Anchor\" href=\"#提取迁移后的进程编号\">#</a> 提取迁移后的进程编号</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 malfind -p</span><br></pre></td></tr></table></figure>\n<h3 id=\"提取开机自启项的virtual地址\"><a class=\"markdownIt-Anchor\" href=\"#提取开机自启项的virtual地址\">#</a> 提取开机自启项的 Virtual 地址</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 printkey -K &quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce&quot;</span><br><span class=\"line\">volatility -f mem.raw --profile=Win7SP1x64 printkey -K &quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run&quot;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "内存取证"
            ]
        }
    ]
}